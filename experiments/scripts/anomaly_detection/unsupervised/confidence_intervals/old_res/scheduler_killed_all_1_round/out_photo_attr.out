

/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003220081329345703 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4730420353101467
 first_prior_anomaly_auc= 0.41255024384846817
 first_prior_star_anomaly_auc= 0.46971350476695783


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5452636777889396; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41229669340890396; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5192266669684127 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5529253015259545; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.41226368994259704; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5258602589231942 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5459202896090839; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4122765770103931; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5172423728465501 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5544864178687263; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4122596037991495; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5238245213030566 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5634167367597428 at iter 490
0.41255024384846817 at iter 0
0.5301145628895195 at iter 490
last anomaly aucs:
0.5634167367597428
0.41222324759975737
0.5301145628895195




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 54.0006799697876 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5641748735286216,first_prior_anomaly_auc= 0.41221643736067826, first_prior_star_anomaly_auc= 0.5306261690037312


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5641746639828038 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41245626254917517 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5304574846203847 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5641748735286217 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4127324439370642 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5303045161733748 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5641748735286216 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41301271146840074 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5301136199333393 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5641746639828038 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4133301733824005 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5299555176137928 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5641746639828038 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.413697507201042 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.529738952011074 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5641746639828038 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4141046547250695 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5295599998826543 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5641748735286216 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41455716891865557 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5293414435946663 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5641746639828038 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4151001021326316 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5291201632110466 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5641746639828038 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41573314004827094 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5288990923732447 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5641746639828038 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4164765038369934 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5286455419336804 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5641746639828038 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4174179931964664 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5283956585459281 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5641746639828038 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4185366535449076 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5281302687676569 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5641749783015306 at iter 126
max_prior_anomaly= 0.4197663731767942 at iter 129
max_prior_star_anomaly= 0.5306261690037312 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5641748735286217
accuracies_anomaly['prior'][-1]= 0.4197663731767942
accuracies_anomaly['prior_star'][-1]= 0.5278989301847816



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 119.16796398162842 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5641746639828038
 first_prior_anomaly_auc= 0.4198949295360278
 first_prior_star_anomaly_auc= 0.5278755658260945


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5641949899271326; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4198952438547546; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 100 
last prior star auc 0.5278920151727936 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5642157349630968; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41989461521730115; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 110 
last prior star auc 0.5279087788382193 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5642339654492474; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4198944056714833; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 110 
last prior star auc 0.5279261711410985 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5642486336564949; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4198952438547546; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 110 
last prior star auc 0.5279400011650748 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5642690643737325 at iter 490
0.41989566294639025 at iter 490
0.527956136193047 at iter 490
last anomaly aucs:
0.5642690643737325
0.41989566294639025
0.527956136193047




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.82195353507996 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5642712646048197,first_prior_anomaly_auc= 0.41989566294639025, first_prior_star_anomaly_auc= 0.5279564505117738


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5642712646048196 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4206548474443582 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5278178359532847 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5642712646048197 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42147406681913224 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.527672935020261 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5642712646048197 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4224352534854804 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5275460550275699 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5642712646048196 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4235341117541374 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.527399163409277 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5642712646048196 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4246810607879845 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5272698736396809 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5642712646048197 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42583984916053846 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5271192101966672 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5642712646048196 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42687081458422127 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5269792335903621 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5642712646048197 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.427673794158114 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5268321324262514 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5642712646048197 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42850380514250586 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5266658578198099 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5642712646048197 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42932962521054113 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5264966495719189 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5642712646048196 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43016508438619633 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5263380233878279 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5642712646048197 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43097246442226333 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5261699676419348 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5642712646048197 at iter 0
max_prior_anomaly= 0.43151833127768885 at iter 129
max_prior_star_anomaly= 0.5279564505117738 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5642712646048197
accuracies_anomaly['prior'][-1]= 0.43151833127768885
accuracies_anomaly['prior_star'][-1]= 0.5260176278323785



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 122.72144913673401 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5642712646048197
 first_prior_anomaly_auc= 0.43156149771616015
 first_prior_star_anomaly_auc= 0.5260025405334953


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5642959910113226; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.43155971657670866; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5260165801032893 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5643217651469146; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4315565733894413; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.526035858318529 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5643429292745147; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.43155363974799177; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5260492692508695 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5643707988682849; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4315519633814493; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5260605847250319 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5643903914022512 at iter 490
0.43156149771616015 at iter 0
0.526071062015923 at iter 480
last anomaly aucs:
0.5643903914022512
0.4315503917878156
0.5260708524701052




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.80422782897949 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5643940584540632,first_prior_anomaly_auc= 0.4315492392858176, first_prior_star_anomaly_auc= 0.5260729479282834


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5643940584540632 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4320326614875322 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5258960912580418 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5643940584540631 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43229522239726287 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5257122148029033 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5643940584540631 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4325162932350647 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5255109460448856 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5643940584540632 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43258890086093993 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5253361848328223 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5643940584540632 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43257129901224295 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5251405738118856 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5643940584540632 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4323439417999064 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.524961516910557 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5643940584540631 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4319663402361917 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5247647533876224 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5643940584540632 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4315314278913027 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5245816103428463 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5643940584540632 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43092007796780785 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5244027629873356 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5643940584540632 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4302343392789864 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5242222392652821 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5643940584540631 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4294358649401767 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5240478971448544 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5643940584540632 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42850191923014547 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5238859182276783 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5643940584540632 at iter 0
max_prior_anomaly= 0.43261016976144884 at iter 38
max_prior_star_anomaly= 0.5260729479282834 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5643940584540632
accuracies_anomaly['prior'][-1]= 0.4276830141740982
accuracies_anomaly['prior_star'][-1]= 0.5237448938922842



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 122.71333503723145 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.47304203531014666
accuracies_anomaly["prior"][-1]= 0.41255024384846817
accuracies_anomaly["prior_star"][-1]= 0.4697135047669578


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam photoGGAD 
took 556.6598737239838 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003632783889770508 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46132842409391345
 first_prior_anomaly_auc= 0.41207918485000505
 first_prior_star_anomaly_auc= 0.45772004511102365


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5443254363896429; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41194497075369024; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5182260856883141 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.563780717845299; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4118790685939853; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5364301690657567 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5553385359368982; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41187665881708035; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.524898024527757 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5577447505629448; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41186649584491597; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5262102004389566 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5680479088794202 at iter 490
0.41207918485000505 at iter 0
0.5366856054176814 at iter 190
last anomaly aucs:
0.5680479088794202
0.41182846327898137
0.5347591459415375




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.81316757202148 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5688764530430872,first_prior_anomaly_auc= 0.41182783464152795, first_prior_star_anomaly_auc= 0.5353810779288324


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5688764530430872 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4120500579813278 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5351930105573374 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5688764530430872 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4123080088830663 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5350098675125612 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5688764530430872 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4126040971236484 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5347995882843771 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5688764530430872 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41295906773903834 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5346003102116287 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5688764530430872 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41338978916757085 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5343944314456188 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5688762434972694 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4139206734970221 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5341572255798448 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5688764530430872 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41459425852841 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5339517659054704 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5688764530430872 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41543401339333047 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5337465157769141 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5688764530430872 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4164681220042806 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5335126626442253 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5688764530430872 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41781791138977914 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5332689608580985 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5688764530430872 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4196341497657487 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5330443277413937 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5688764530430872 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42203355415271615 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5327704513575007 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5688764530430872 at iter 0
max_prior_anomaly= 0.4248078360077666 at iter 129
max_prior_star_anomaly= 0.5353810779288324 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5688764530430872
accuracies_anomaly['prior'][-1]= 0.4248078360077666
accuracies_anomaly['prior_star'][-1]= 0.5325445609658889



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.59478545188904 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5688764530430872
 first_prior_anomaly_auc= 0.4251267647424912
 first_prior_star_anomaly_auc= 0.5325213013801107


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.568896674214507; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4251265551966735; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.532536179133176 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5689165810672001; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4251263456508556; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.5325523141611482 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5689439267964258; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4251273933799447; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 290 
last prior star auc 0.5325774596592869 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5689645670594812; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.42512718383412684; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 290 
last prior star auc 0.5325908705916275 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5689879314181684 at iter 490
0.42512739337994476 at iter 290
0.5326049101614215 at iter 490
last anomaly aucs:
0.5689879314181684
0.42512645042376446
0.5326049101614215




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.80386090278625 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5689910746054356,first_prior_anomaly_auc= 0.4251263456508556, first_prior_star_anomaly_auc= 0.5326063769821463


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5689908650596178 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42702126848141725 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5324700674276532 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5689910746054356 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4290192878543472 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5323272619528077 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5689910746054356 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4311615795228474 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5321923144461306 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5689908650596178 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.43336987812396144 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5320525473856436 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5689908650596178 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.43553721051769134 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5319165521498772 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5689910746054357 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.43767132989929647 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5317744800853941 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5689910746054356 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.43969669500145214 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5316225593674734 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5689909698325268 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.44159245601528513 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.531470324330826 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5689910746054356 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.443342582685732 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5313124315570972 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.568990760286709 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4449101949488562 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5311464712693824 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5689908650596178 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4463671670201705 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5309920360016479 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5689910746054356 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4477698667246689 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5308368673235508 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5689912841512536 at iter 26
max_prior_anomaly= 0.4489240450892309 at iter 129
max_prior_star_anomaly= 0.5326063769821463 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5689906555138
accuracies_anomaly['prior'][-1]= 0.4489240450892309
accuracies_anomaly['prior_star'][-1]= 0.5306963668527014



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 122.98612475395203 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5689909698325268
 first_prior_anomaly_auc= 0.4490342661894051
 first_prior_star_anomaly_auc= 0.5306812795538183


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5690114005497644; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4490351043726764; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 100 
last prior star auc 0.5307021293626915 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5690298405817327; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.449034370962314; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 100 
last prior star auc 0.5307113493786757 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5690547765340535; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4490323802770447; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 100 
last prior star auc 0.5307311514584598 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5690769883907425; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.44902997050013976; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 100 
last prior star auc 0.5307460292115251 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5690987811557962 at iter 490
0.4490351043726764 at iter 100
0.5307621642394975 at iter 490
last anomaly aucs:
0.5690987811557962
0.4490274559503259
0.5307621642394975




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.8109815120697 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5691027625263347,first_prior_anomaly_auc= 0.449027351177417, first_prior_star_anomaly_auc= 0.5307637358331312


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5691027625263347 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45025895672166405 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5305964134976004 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5691027625263347 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.451310876727129 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5304505696083965 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5691027625263347 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4521955791699722 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5302946675199371 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5691027625263347 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4529791757557165 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5301494522681869 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5691027625263347 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.45368167810996374 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5299981601877195 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5691027625263347 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.45420072310070814 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5298254944338345 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5691027625263347 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4546891744020506 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5296943187518781 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5691027625263347 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4549183127538386 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.529558113970294 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5691027625263347 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.45501428473840094 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5294273573799733 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5691027625263347 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.45493926733562073 iter_best_prior_anomaly= 910
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.529308963992904 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5691027625263347 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4548013861874941 iter_best_prior_anomaly= 910
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5291821887731218 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5691027625263347 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4545548555328268 iter_best_prior_anomaly= 910
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.529074901314397 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5691028672992435 at iter 14
max_prior_anomaly= 0.45502842908110386 at iter 91
max_prior_star_anomaly= 0.5307637358331312 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5691027625263347
accuracies_anomaly['prior'][-1]= 0.4543458335795497
accuracies_anomaly['prior_star'][-1]= 0.528963422939316



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.06513738632202 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4613284240939134
accuracies_anomaly["prior"][-1]= 0.41207918485000505
accuracies_anomaly["prior_star"][-1]= 0.4577199403381148


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam photoGGAD 
took 576.2729609012604 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003907680511474609 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46683057340536677
 first_prior_anomaly_auc= 0.4123984279034564
 first_prior_star_anomaly_auc= 0.46342136772231657


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5454647370011395; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41211690309721283; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5198181100392144 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5301123626584323; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4120829566747257; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5052715441389406 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.530739218972446; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4120932244197991; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5026859582928387 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5469666566503766; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.412079184850005; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5168158423343739 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5638781566505862 at iter 490
0.4123984279034564 at iter 0
0.5307986252117984 at iter 490
last anomaly aucs:
0.5638781566505862
0.4120335038617199
0.5307986252117984




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.79565334320068 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5653888772241716,first_prior_anomaly_auc= 0.4120300463557258, first_prior_star_anomaly_auc= 0.5319742820226872


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5653889819970805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41229878886708216 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5318201610736792 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5653889819970805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41258775254985824 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5316678212641228 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5653889819970805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4128832121529869 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5314735722910022 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5653889819970805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41326332826651546 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5313036306327488 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5653889819970807 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41371709973500836 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5311201732692459 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5653889819970805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41426474772988536 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5309205808777706 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5653891915428985 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4149610684825069 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5306988814025153 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5653889819970807 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41577609694092443 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5305084042541154 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5653891915428985 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41678694596609633 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5302893241015828 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5653889819970805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41801373195653346 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5300578807457987 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5653891915428985 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4195194234304913 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5298331428561849 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5653889819970805 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.42138804826091636 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5295889172055137 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5653891915428985 at iter 3
max_prior_anomaly= 0.42343028180140674 at iter 129
max_prior_star_anomaly= 0.5319742820226872 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5653889819970805
accuracies_anomaly['prior'][-1]= 0.42343028180140674
accuracies_anomaly['prior_star'][-1]= 0.529351187475195



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.58940529823303 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5653889819970805
 first_prior_anomaly_auc= 0.42364087534831757
 first_prior_star_anomaly_auc= 0.529327823116508


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5654361298060905; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4236402467108641; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5293531781604643 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5654694475911242; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4236394085275928; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5293850291247733 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5655112519817795; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4236385703443215; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5294162514516286 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5655499131851678; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4236377321610502; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5294519790135672 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5655951750818171 at iter 490
0.42364087534831757 at iter 0
0.5294772292846148 at iter 490
last anomaly aucs:
0.5655951750818171
0.42363815125268584
0.5294772292846148




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.80758142471313 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5655993659981735,first_prior_anomaly_auc= 0.4236381512526859, first_prior_star_anomaly_auc= 0.5294810011093356


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5655995755439913 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42496289991295466 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5293621886306307 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5655995755439914 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4263730384939858 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.529212572916706 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5655995755439914 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42782361941785657 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.529079825641116 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5655995755439914 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4293311968041748 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5289485451862506 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5655995755439913 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.43091703955344945 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5288110831297596 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5655993659981735 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4325761185660528 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5286762403959914 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5655993659981736 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4342261871084898 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5285569040527418 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5655994707710825 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4356861975941626 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5284083360679063 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5655995755439914 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.43707601023086506 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.528259348991435 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5655995755439914 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4383776040782645 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.528110152369146 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5655995755439914 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.43968611293765214 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.527952678687053 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5655993659981736 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44096738084072296 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5277790699769878 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5655995755439914 at iter 1
max_prior_anomaly= 0.44197351508499394 at iter 129
max_prior_star_anomaly= 0.5294810011093356 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5655995755439914
accuracies_anomaly['prior'][-1]= 0.44197351508499394
accuracies_anomaly['prior_star'][-1]= 0.5276397220081362



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.6990418434143 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5655994707710825
 first_prior_anomaly_auc= 0.4420613147826612
 first_prior_star_anomaly_auc= 0.5276297685817897


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5656414847075557; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.44205890500575623; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5276580572671956 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5656792029547637; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.44205450454358197; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.5276900130044135 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.565716502110336; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.442050942264679; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.5277250071559897 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5657447907957418; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.44204758953159384; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.5277553912995738 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.565779994493136 at iter 490
0.4420616291013879 at iter 10
0.5277857754431581 at iter 490
last anomaly aucs:
0.565779994493136
0.44204507498178003
0.5277857754431581




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.82623243331909 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5657831376804032,first_prior_anomaly_auc= 0.44204465589014436, first_prior_star_anomaly_auc= 0.5277862993077025


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.565783347226221 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44318563286818347 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5276443320161284 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5657831376804032 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44416651684140696 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.527473133082968 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.565783347226221 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44520083499817487 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5273059155203463 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5657831376804032 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44605117192689536 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5271389075035424 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5657831376804032 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44690611886360787 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5269599553751226 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5657831376804032 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.447665198588667 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5268060439719326 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5657831376804032 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4483612050225618 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5266301302578713 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5657831376804032 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4488108903476072 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5264365099222039 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5657831376804032 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4492423451865021 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5262799791962911 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5657830329074943 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4495393763832643 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5261370689485367 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5657831376804032 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4497108896351514 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5259723659357289 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.565783347226221 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4497473506074523 iter_best_prior_anomaly= 1180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5258082915603746 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.565783347226221 at iter 1
max_prior_anomaly= 0.44974986515726617 at iter 118
max_prior_star_anomaly= 0.5277862993077025 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5657831376804032
accuracies_anomaly['prior'][-1]= 0.4495709130288465
accuracies_anomaly['prior_star'][-1]= 0.5256813067947745



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.19000554084778 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.466830363859549
accuracies_anomaly["prior"][-1]= 0.4123984279034564
accuracies_anomaly["prior_star"][-1]= 0.46342136772231657


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam photoGGAD 
took 577.10622215271 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003717660903930664 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46303863228606523
 first_prior_anomaly_auc= 0.41286728667083245
 first_prior_star_anomaly_auc= 0.4597456197589972


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5434493253253303; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4126332239923256; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5174332690865856 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.535019506620181; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4125783229880563; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5095783393326301 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5437611295022491; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41259424847021076; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5147029918532777 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5475448983346556; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.4125906861913078; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5170947478178947 ; count_not_improved_prior_star_anomaly= 33 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5482936055417325 at iter 490
0.41286728667083245 at iter 0
0.5186828955711653 at iter 80
last anomaly aucs:
0.5482936055417325
0.412598648932385
0.5170095674429501




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 67.54671335220337 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.548363593844885,first_prior_anomaly_auc= 0.4125999062072919, first_prior_star_anomaly_auc= 0.5170138631322154


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5483631747532494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41274616918813145 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5168225478005442 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5483629652074316 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4129443995317908 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.516623060181978 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.548363593844885 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41318349130992543 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5164394980455662 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5483631747532494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41344353766984215 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5162762618534831 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5483633842990672 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4137616282212955 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5161134447530356 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5483634890719761 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41415924141061217 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5159030607519426 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5483630699803403 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4146320815485268 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5157255754442476 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5483631747532494 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41522761076277614 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5155308026065824 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.548363593844885 iter_best_vanilla_star_anomaly= 880 
last prior auc 0.4159288558421164 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5153071124460576 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.548363593844885 iter_best_vanilla_star_anomaly= 880 
last prior auc 0.4167315210972825 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.515084574787531 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5483632795261582 iter_best_vanilla_star_anomaly= 880 
last prior auc 0.41779727112672366 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5148605703082796 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5483634890719761 iter_best_vanilla_star_anomaly= 880 
last prior auc 0.41910714203392707 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5146357276457569 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5483638033907028 at iter 88
max_prior_anomaly= 0.42060256576281174 at iter 129
max_prior_star_anomaly= 0.5170138631322154 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5483633842990672
accuracies_anomaly['prior'][-1]= 0.42060256576281174
accuracies_anomaly['prior_star'][-1]= 0.5144320491108343



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 119.13359069824219 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5483633842990672
 first_prior_anomaly_auc= 0.42078214652868495
 first_prior_star_anomaly_auc= 0.5144180095410402


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5483657940759721; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.42078340380359186; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 100 
last prior star auc 0.5144226195490322 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5483734424983226; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42078308948486515; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 130 
last prior star auc 0.5144183238597668 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5483797288728572; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.42078287993904734; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 130 
last prior star auc 0.5144142377163193 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5483841293350314; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4207828799390473; count_not_improved_prior_anomaly= 32; iter_best_prior_anomaly= 330 
last prior star auc 0.5144171713577689 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5483909395741107 at iter 470
0.42078371812231863 at iter 330
0.5144234577323036 at iter 60
last anomaly aucs:
0.5483898918450216
0.4207828799390473
0.5144127708955946




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 67.33915996551514 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5483910443470196,first_prior_anomaly_auc= 0.4207829847119562, first_prior_star_anomaly_auc= 0.5144125613497768


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5483909395741107 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42170634835818754 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5142811761220026 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5483908348012018 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42274789584567035 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5141611063683907 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5483910443470196 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42383774364416105 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.514041036614779 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5483908348012018 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4249241339366577 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5139136327575433 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5483908348012018 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4260612343170671 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5137732370596029 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5483910443470196 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42716155940644884 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5136399659194681 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5483908348012018 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4282410346869574 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5134953793051712 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5483910443470196 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42927723875608575 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5133438776788861 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5483910443470196 iter_best_vanilla_star_anomaly= 870 
last prior auc 0.4302981459805131 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5132066251682129 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5483908348012018 iter_best_vanilla_star_anomaly= 870 
last prior auc 0.43128971679044537 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5130681153826328 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5483908348012018 iter_best_vanilla_star_anomaly= 870 
last prior auc 0.43215629352004703 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5129383017484922 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5483908348012018 iter_best_vanilla_star_anomaly= 870 
last prior auc 0.4328551288224824 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5127801994289458 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5483911491199285 at iter 87
max_prior_anomaly= 0.43341597820388217 at iter 129
max_prior_star_anomaly= 0.5144125613497768 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5483910443470196
accuracies_anomaly['prior'][-1]= 0.43341597820388217
accuracies_anomaly['prior_star'][-1]= 0.5126523764800744



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 118.95228004455566 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5483910443470196
 first_prior_anomaly_auc= 0.4334781085388663
 first_prior_star_anomaly_auc= 0.5126350889501042


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5483990070880969; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.43347978490540895; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 50 
last prior star auc 0.5126418991891833 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5484038266419067; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.43348240422813167; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 190 
last prior star auc 0.512645880559722 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5484101130164414; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.43348229945522276; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 270 
last prior star auc 0.512648395109536 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.54841409438698; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4334838710488564; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 390 
last prior star auc 0.5126525860258924 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5484220571280572 at iter 490
0.4334853378695811 at iter 490
0.5126533194362547 at iter 390
last anomaly aucs:
0.5484220571280572
0.4334853378695811
0.5126523764800744




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 67.31154227256775 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5484201712156969,first_prior_anomaly_auc= 0.43348533786958116, first_prior_star_anomaly_auc= 0.5126523764800746


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5484203807615147 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4340513211235176 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5125103044155914 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5484202759886057 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.43455339290301837 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5123678132594727 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5484203807615147 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4349685031681232 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5122186166371836 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5484203807615147 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4352260349782261 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5120690009232589 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5484203807615147 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.435381308429232 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5119048217749955 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5484202759886057 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4354290848756953 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5117383376227362 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5484204855344236 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.43533101743295477 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5115598045859522 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5484203807615147 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.43525076138472907 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5113995020353186 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5484200664427878 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.43505651241160836 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5112576395166533 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5484203807615147 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.43485765343049554 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5110994324241979 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5484201712156969 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.43453945810613326 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5109537980808118 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5484201712156969 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4341832302158364 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5108113069246929 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5484205903073325 at iter 12
max_prior_anomaly= 0.4354567449236478 at iter 57
max_prior_star_anomaly= 0.5126523764800746 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5484203807615147
accuracies_anomaly['prior'][-1]= 0.4339519964058701
accuracies_anomaly['prior_star'][-1]= 0.5106941708125307



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 119.36181092262268 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46303863228606523
accuracies_anomaly["prior"][-1]= 0.41286728667083245
accuracies_anomaly["prior_star"][-1]= 0.4597456197589972


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam photoGGAD 
took 559.8428113460541 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0036149024963378906 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46855964072112255
 first_prior_anomaly_auc= 0.4123082184288841
 first_prior_star_anomaly_auc= 0.46511617429685853


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.543217043786275; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41214938269897533; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5168233859838156 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.541906649014527; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41211836991793765; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5163611279097009 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5577472651127587; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41209091941580306; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5283706178206984 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5651095526490154; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4120655643718466; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5332748281409976 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5776908930968483 at iter 490
0.4123082184288841 at iter 0
0.5423258454230793 at iter 490
last anomaly aucs:
0.5776908930968483
0.4120207215668328
0.5423258454230793




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.8304386138916 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5788265266565331,first_prior_anomaly_auc= 0.41200856790939905, first_prior_star_anomaly_auc= 0.543128824996972


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5788265266565331 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.412160279081502 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5429550067410889 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5788263171107152 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4123522230506267 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5427653677759603 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5788264218836241 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4125521297608286 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5425786624522811 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.578826526656533 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41273694917214737 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5423793843795328 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5788263171107153 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41295885819322053 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5421704671991645 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5788263171107153 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4132117799953313 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5419366140664754 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5788263171107153 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41349120934339656 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5416857877225429 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5788263171107153 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41379295532105986 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5414737273549073 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5788265266565331 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.414121837482131 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5412247869233351 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5788265266565331 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41442819346778637 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5409655787466897 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5788265266565331 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4147010221225902 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5407011319245987 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5788263171107153 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41491266339859006 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5404261030387076 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.578826631429442 at iter 9
max_prior_anomaly= 0.41494912437089104 at iter 125
max_prior_star_anomaly= 0.543128824996972 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5788263171107153
accuracies_anomaly['prior'][-1]= 0.41492942706401587
accuracies_anomaly['prior_star'][-1]= 0.5401470927822781



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.54829359054565 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5788263171107152
 first_prior_anomaly_auc= 0.41492586478511284
 first_prior_star_anomaly_auc= 0.5401156609096048


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.578857120345935; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41492607433093065; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.5401382918579296 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5788860376687944; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4149263886496575; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 200 
last prior star auc 0.5401592464397118 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5789130690792934; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41492617910383955; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 210 
last prior star auc 0.540183763300397 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5789434532228775; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4149271220600198; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 380 
last prior star auc 0.5402030415156365 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5789700655417409 at iter 490
0.4149280650162 at iter 490
0.5402246247348721 at iter 490
last anomaly aucs:
0.5789700655417409
0.4149280650162
0.5402246247348721




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.74529910087585 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5789705894062854,first_prior_anomaly_auc= 0.41492816978910896, first_prior_star_anomaly_auc= 0.5402264058743236


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5789704846333765 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.414824654155105 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.540067255825688 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5789704846333765 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41469201165242386 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5399153351077673 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5789705894062854 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4145455391257664 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5397657193938427 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5789704846333765 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4142622331800715 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5396133795842862 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5789707989521033 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4139567153776874 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5394725647947101 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5789704846333765 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4136567505394757 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5393211679413339 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5789703798604676 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.41326741440996295 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.539180038833031 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5789704846333765 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.41284758936395727 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5390110401309578 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5789705894062854 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.41237548263640494 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5388460227994232 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5789704846333765 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.41203465636371783 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.53868278660734 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5789702750875587 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4118357973826051 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5385092826701837 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5789704846333765 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4115553203054508 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5383301209959461 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5789709037250123 at iter 47
max_prior_anomaly= 0.41492816978910896 at iter 0
max_prior_star_anomaly= 0.5402264058743236 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5789704846333765
accuracies_anomaly['prior'][-1]= 0.411411676647334
accuracies_anomaly['prior_star'][-1]= 0.5381842771067422



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.55212116241455 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5789709037250123
 first_prior_anomaly_auc= 0.4113876836511934
 first_prior_star_anomaly_auc= 0.5381673038954986


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5790025451435032; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41138705501373996; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 30 
last prior star auc 0.53818930620637 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5790312529205448; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41138632160337757; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 30 
last prior star auc 0.5382068032821581 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5790666661637567; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4113863216033775; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 30 
last prior star auc 0.5382270244535778 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5790968407615229; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4113844356910171; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 30 
last prior star auc 0.5382431594815501 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5791217767138438 at iter 490
0.411388102742829 at iter 30
0.5382628567884253 at iter 490
last anomaly aucs:
0.5791217767138438
0.4113838070535637
0.5382628567884253




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.84588503837585 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5791245008094755,first_prior_anomaly_auc= 0.41138370228065474, first_prior_star_anomaly_auc= 0.5382653713382392


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5791245008094754 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41117331827956183 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5380708080463917 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5791243960365666 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41091714851727473 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5378860934079819 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5791245008094755 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.41062525119304905 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5376784335025206 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5791245008094754 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.41018824338998194 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5375187595893405 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5791245008094755 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4095668352672317 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5373420076920079 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5791243960365666 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.40886831428352305 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5371497494041565 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5791245008094754 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4080810506459669 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5369550813394002 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5791245008094754 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4072851956298801 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5367501455295705 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5791245008094755 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.40632610442171013 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5365602970186241 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5791245008094755 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4053751855004353 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5363799828423884 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5791245008094755 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.40449299760740587 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5361741040763786 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5791245008094755 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.40367011118081997 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5359678062187332 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5791247103552933 at iter 33
max_prior_anomaly= 0.41138370228065474 at iter 0
max_prior_star_anomaly= 0.5382653713382392 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5791245008094755
accuracies_anomaly['prior'][-1]= 0.40302408142447566
accuracies_anomaly['prior_star'][-1]= 0.5357944070544858



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.60171365737915 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4685597454940315
accuracies_anomaly["prior"][-1]= 0.4123082184288841
accuracies_anomaly["prior_star"][-1]= 0.4651161742968586


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam photoGGAD 
took 577.3244745731354 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004054069519042969 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4701354252711419
 first_prior_anomaly_auc= 0.4122914547634584
 first_prior_star_anomaly_auc= 0.4668510041226044


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5433100821293879; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4119130150164724; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5171493345034373 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5428388135851068; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41187781131907836; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5178437693436984 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.548756073161665; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41185748537474964; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5201872249973074 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5437944472872827; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4118860883788823; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5140202915788146 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.548756073161665 at iter 300
0.4122914547634584 at iter 0
0.5255913068660203 at iter 50
last anomaly aucs:
0.5431283011324275
0.411894679757413
0.5129650188402645




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.79906725883484 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5429436912669267,first_prior_anomaly_auc= 0.4118949940761397, first_prior_star_anomaly_auc= 0.5128095358434408


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5429436912669267 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41192579731135953 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5126193730137676 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5429435864940176 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41198614650689214 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.512451945905328 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5429440055856534 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4120785562125515 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5122713174103657 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5429441103585623 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41221989486667227 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5120785352579698 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5429435864940177 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4123984279034564 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5119120511057105 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5429436912669265 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4126464253788483 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5117272316943917 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5429436912669265 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41290102354750174 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5115316206734551 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5429436912669267 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41320360770843634 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5113265800907166 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5429435864940177 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41355365399710736 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5111269876992415 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5429441103585623 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41396184925022406 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5108831811402058 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5429440055856534 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41432017259869924 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5106581289318654 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5429434817211087 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.41452929932488525 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5103781757192556 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5429441103585623 at iter 3
max_prior_anomaly= 0.41460714559620604 at iter 125
max_prior_star_anomaly= 0.5128095358434408 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5429436912669267
accuracies_anomaly['prior'][-1]= 0.4146003353571268
accuracies_anomaly['prior_star'][-1]= 0.5101318546104061



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.53823661804199 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5429439008127444
 first_prior_anomaly_auc= 0.41458000941279816
 first_prior_star_anomaly_auc= 0.5101068138851764


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5429419101274751; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41457906645661796; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.510107337749721 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5429336330676711; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4145794855482535; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.5100960222755586 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5429233653225979; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41458011418570706; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.5100903645384774 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5429202221353305; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4145792760024357; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.5100790490643151 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5429439008127444 at iter 0
0.4145804285044338 at iter 20
0.5101101666182616 at iter 60
last anomaly aucs:
0.5429130975775246
0.4145784378191645
0.5100693051837863




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.80559635162354 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5429112116651642,first_prior_anomaly_auc= 0.4145784378191645, first_prior_star_anomaly_auc= 0.5100678383630616


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5429112116651642 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41444286167503386 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5099324717647488 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5429112116651642 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4141665755142359 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5098023438118815 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5429112116651642 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41378436394252915 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.509656080831042 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5429112116651642 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4134122105700777 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5095165233163726 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5429112116651642 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4131164366482224 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.509373927387345 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5429112116651642 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41285680937994135 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5092363605579451 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5429112116651642 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41267691429534137 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5090806680153035 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5429112116651642 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41233273528956926 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5089147077275888 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5429112116651642 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41197724080963477 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5087516810813235 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5429112116651642 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.41164678705492985 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5085943121721394 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5429112116651642 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4112090458415003 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5084437535020345 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5429112116651642 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4108097562856411 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5082732879792365 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.542911421210982 at iter 5
max_prior_anomaly= 0.4145784378191645 at iter 0
max_prior_star_anomaly= 0.5100678383630616 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5429112116651642
accuracies_anomaly['prior'][-1]= 0.41057936065894607
accuracies_anomaly['prior_star'][-1]= 0.5081268154525791



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.2092924118042 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5429112116651642
 first_prior_anomaly_auc= 0.4105622826747936
 first_prior_star_anomaly_auc= 0.508111728153696


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5429026202866336; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4105624922206115; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 90 
last prior star auc 0.5081076420102485 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5428952861830099; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4105651115433343; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 200 
last prior star auc 0.5080980029026286 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5428921429957425; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41056584495369663; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 270 
last prior star auc 0.5080866874284663 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5428883711710217; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.410566683136968; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 370 
last prior star auc 0.5080782008228444 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5429116307567998 at iter 10
0.4105679404118749 at iter 410
0.5081121472453316 at iter 40
last anomaly aucs:
0.5428848088921187
0.41056657836405897
0.5080719144483099




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.81564807891846 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.54288564707539,first_prior_anomaly_auc= 0.410566683136968, first_prior_star_anomaly_auc= 0.5080735908148524


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5428858566212078 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41034728866570863 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5079236607822011 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.54288564707539 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4101490583220493 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5077527761677674 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5428858566212078 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.40990629949210283 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5075944643024031 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.54288564707539 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4096996873157306 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5074382478952171 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5428858566212078 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.40937248152120204 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5072532189380805 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5428858566212078 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4089311780288695 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5070820200049202 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.54288564707539 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.40833742995407174 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5068982483226905 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5428858566212078 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.40745167978213936 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5067104952699223 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.54288564707539 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4063924256730507 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.506539191563853 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5428858566212078 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4052475720973818 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5063882138021125 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5428858566212078 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.4041409606334654 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5062147098649561 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5428858566212078 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.40314635140917465 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5060738950753799 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5428860661670256 at iter 23
max_prior_anomaly= 0.410566683136968 at iter 0
max_prior_star_anomaly= 0.5080735908148524 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5428858566212078
accuracies_anomaly['prior'][-1]= 0.4024696231905195
accuracies_anomaly['prior_star'][-1]= 0.5059402048436097



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.46493458747864 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4701354252711419
accuracies_anomaly["prior"][-1]= 0.4122914547634584
accuracies_anomaly["prior_star"][-1]= 0.4668508993496954


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam photoGGAD 
took 576.8316946029663 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003543853759765625 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.47020206084120914
 first_prior_anomaly_auc= 0.4126651797295434
 first_prior_star_anomaly_auc= 0.46687971189964594


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.544237112827431; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41252646039814544; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5184538619922863 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5420190703457883; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41248193191185833; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5163825015831186 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5413280930115212; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4125012101270979; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5126390703206428 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5539663251488927; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.412486961011486; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5233100863203042 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5697399913583305 at iter 490
0.4126651797295434 at iter 0
0.5360060483304856 at iter 490
last anomaly aucs:
0.5697399913583305
0.41244756639773555
0.5360060483304856




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.8115463256836 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5713680575898963,first_prior_anomaly_auc= 0.4124370891068445, first_prior_star_anomaly_auc= 0.5373335210863861


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5713675337253517 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4125639690995355 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5371327761929129 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5713675337253517 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.412730243705977 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5369125435383824 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5713680575898962 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41294817135651163 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5366887486049488 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5713680575898962 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41324855528635895 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5365045578310834 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5713679528169873 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41359304861085794 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5363110422683252 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5713676384982606 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.414065469657137 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5360921716616104 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5713677432711695 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4146313481381645 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5358708912779906 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5713679528169873 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4152836642690434 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5356552686314521 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5713676384982606 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41604892559572826 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5354327309729254 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5713677432711695 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4169701937837814 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5351938487406087 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5713679528169873 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4180321719885018 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5349257348667058 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5713678480440784 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4193876191110815 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5346797280765831 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5713681623628052 at iter 16
max_prior_anomaly= 0.42073028393877404 at iter 129
max_prior_star_anomaly= 0.5373335210863861 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5713681623628052
accuracies_anomaly['prior'][-1]= 0.42073028393877404
accuracies_anomaly['prior_star'][-1]= 0.5344155955732188



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.54122853279114 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5713681623628052
 first_prior_anomaly_auc= 0.42087570873634234
 first_prior_star_anomaly_auc= 0.5343914978041694


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5714239015503457; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4208753944176156; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5344346642426406 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5714702111760843; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4208743466885265; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5344711252149417 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.571517568530912; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.420873822823982; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5345096816454208 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.571558639511205; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4208724607761661; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5345404848806407 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5715992913998624 at iter 490
0.42087570873634234 at iter 0
0.5345761076696702 at iter 490
last anomaly aucs:
0.5715992913998624
0.42087099395544136
0.5345761076696702




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.85260009765625 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5716028536787655,first_prior_anomaly_auc= 0.42087109872835027, first_prior_star_anomaly_auc= 0.5345796699485732


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5716028536787654 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4217281411232411 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5344143382983119 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5716026441329476 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42255668528690804 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5342588553014882 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5716028536787654 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4233303284463058 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5341112302728328 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5716028536787654 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4240400601312678 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5339849789175952 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5716028536787654 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.424772108445828 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5338334772913101 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5716026441329476 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4254892790073228 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.533679880206847 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5716028536787654 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4261881143097582 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.533511614915136 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5716028536787654 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.426765308264948 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5333462832648748 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5716028536787654 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42732385264235184 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5331580063475619 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5716028536787654 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4279788928688625 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5329806258127758 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5716028536787654 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4286207317088503 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328060741465304 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5716028536787654 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42921468932946594 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.53263005565956 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5716028536787655 at iter 0
max_prior_anomaly= 0.42973237227239447 at iter 129
max_prior_star_anomaly= 0.5345796699485732 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5716028536787655
accuracies_anomaly['prior'][-1]= 0.42973237227239447
accuracies_anomaly['prior_star'][-1]= 0.5324534085351365



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.01016783714294 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5716028536787654
 first_prior_anomaly_auc= 0.429785806455939
 first_prior_star_anomaly_auc= 0.532436435323893


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5716579642288525; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4297841300893965; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5324711151567424 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5717022831693218; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42978182508540036; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.532505585443774 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5717527837114169; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.42977847235231526; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.5325397414120789 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5717974169706128; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4297759578025014; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.5325727448783859 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5718373354489079 at iter 490
0.4297860160017568 at iter 10
0.5326030242490611 at iter 490
last anomaly aucs:
0.5718373354489079
0.4297728146152341
0.5326030242490611




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.83084487915039 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5718421550027177,first_prior_anomaly_auc= 0.42977239552359847, first_prior_star_anomaly_auc= 0.5326081581215978


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5718421550027178 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.43030359417177644 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5324276343995443 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5718420502298089 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.43074563107447134 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5322442818089503 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5718421550027177 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4311170510365603 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5320500328358296 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5718420502298089 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.43127494381028897 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5318505452172634 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5718421550027177 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.43132953049583145 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5316397421245348 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5718422597756267 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.43126729538793845 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5314438167848715 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5718419454568999 iter_best_vanilla_star_anomaly= 610 
last prior auc 0.4310464340959544 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5312417098435824 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5718419454568999 iter_best_vanilla_star_anomaly= 610 
last prior auc 0.4306820339187624 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5310580429342617 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5718420502298089 iter_best_vanilla_star_anomaly= 610 
last prior auc 0.43022794813154286 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5308487066622578 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5718421550027178 iter_best_vanilla_star_anomaly= 610 
last prior auc 0.42957311745085 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5306397894818895 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5718419454568999 iter_best_vanilla_star_anomaly= 610 
last prior auc 0.42901394443599283 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5304362157198758 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5718419454568999 iter_best_vanilla_star_anomaly= 610 
last prior auc 0.4283527226078564 iter_best_prior_anomaly= 530
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5302280319498699 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5718423645485357 at iter 61
max_prior_anomaly= 0.4313475514361642 at iter 53
max_prior_star_anomaly= 0.5326081581215978 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5718420502298089
accuracies_anomaly['prior'][-1]= 0.42768678599881904
accuracies_anomaly['prior_star'][-1]= 0.5300379738931056



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.09897422790527 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.47020206084120914
accuracies_anomaly["prior"][-1]= 0.4126651797295434
accuracies_anomaly["prior_star"][-1]= 0.46687971189964594


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam photoGGAD 
took 576.3454747200012 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0038607120513916016 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46536480040970396
 first_prior_anomaly_auc= 0.4120633641407595
 first_prior_star_anomaly_auc= 0.4619095994196419


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5434977304092472; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41216551772694754; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 80 
last prior star auc 0.5177194039008212 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5402774302809632; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41213869586226637; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 80 
last prior star auc 0.5134574515121455 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5404676978835453; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41216237453968024; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 80 
last prior star auc 0.512162877449643 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5463493346710738; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.41216457477076734; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 80 
last prior star auc 0.5168538749003087 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.552149143816743 at iter 490
0.412175575926203 at iter 80
0.5216140224708553 at iter 70
last anomaly aucs:
0.552149143816743
0.4121593361253218
0.5212072940384633




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.82464933395386 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5527389105210021,first_prior_anomaly_auc= 0.4121565072567812, first_prior_star_anomaly_auc= 0.5216567698176909


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5527389105210021 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41226526153623066 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5214748840478217 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5527387009751843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4123815594651217 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5213001228357583 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5527387009751843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4125549586293692 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5211204372969763 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5527387009751843 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41275182692521273 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5209217878616814 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5527389105210021 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4129848418746304 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5206955831513428 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5527384914293665 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.4132657380434204 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.520508458736028 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5527388057480933 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.4136315002684282 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5203011131492934 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5527389105210021 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.41410528336252306 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5200803566302182 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5527389105210021 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.4146817439073506 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5198430459915353 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5527389105210021 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.4154418713614988 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5196072021735768 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5527389105210021 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.416439519000148 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5193593094710938 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5527388057480933 iter_best_vanilla_star_anomaly= 520 
last prior auc 0.4178714503462325 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5190799848959374 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5527389105210022 at iter 52
max_prior_anomaly= 0.4195317866337428 at iter 129
max_prior_star_anomaly= 0.5216567698176909 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5527389105210021
accuracies_anomaly['prior'][-1]= 0.4195317866337428
accuracies_anomaly['prior_star'][-1]= 0.5188540945043256



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.43767404556274 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5527389105210021
 first_prior_anomaly_auc= 0.419706652618715
 first_prior_star_anomaly_auc= 0.5188329303767256


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.552754312138612; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41970591920835265; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5188469699465197 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5527690851187685; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41970644307289723; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.5188547231417792 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5527818674136555; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4197072812561685; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 280 
last prior star auc 0.5188679245283019 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.552795487891814; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.41970686216453285; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 280 
last prior star auc 0.5188773540901039 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5528091083699724 at iter 480
0.4197073860290774 at iter 280
0.5188945368471652 at iter 490
last anomaly aucs:
0.5528088988241546
0.41970654784580613
0.5188945368471652




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.84192442893982 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5528086892783368,first_prior_anomaly_auc= 0.419706652618715, first_prior_star_anomaly_auc= 0.5188936986638939


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5528087940512456 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.42077386946888096 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5187633611652088 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5528086892783367 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.421920818502728 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5186312425270723 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5528086892783367 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.42308013073982664 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5184726163429813 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5528088988241546 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4241755315024896 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5183288679119555 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5528088988241545 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4252686272611565 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5181845956163853 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5528087940512456 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4263350059280512 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5180477621973478 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5528086892783367 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.42739488867459335 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5178942698857933 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5528086892783367 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4284053186081296 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.517744130307324 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5528088988241546 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4294292642469154 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5175961909599419 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5528086892783368 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.43033261626754477 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5174465752460172 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5528086892783367 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.43117048522010476 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5172944449822787 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5528086892783368 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4317464219003877 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5171347710690986 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5528091083699724 at iter 14
max_prior_anomaly= 0.4320933250017916 at iter 129
max_prior_star_anomaly= 0.5188936986638939 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5528088988241546
accuracies_anomaly['prior'][-1]= 0.4320933250017916
accuracies_anomaly['prior_star'][-1]= 0.5169884033153501



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.2147843837738 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5528086892783367
 first_prior_anomaly_auc= 0.4321249664202827
 first_prior_star_anomaly_auc= 0.5169738398810115


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5528174902026853; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4321234995995579; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.516989765363166 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5528335204577486; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.43212161368719754; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5170031762955065 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5528545798124398; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.432118680045748; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5170113485824015 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5528728102985903; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4321181561812035; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5170235022398353 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5528881071432912 at iter 490
0.4321249664202827 at iter 0
0.5170365988534491 at iter 470
last anomaly aucs:
0.5528881071432912
0.43211585117720747
0.5170353415785421




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.81397843360901 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5528897835098339,first_prior_anomaly_auc= 0.4321155368584807, first_prior_star_anomaly_auc= 0.5170364940805402


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5528897835098339 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43237390685185484 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5168761915299066 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5528897835098339 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43239842371254 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5167316049156097 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5528897835098339 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4323075856005143 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5165792651060532 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5528897835098339 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43216760899420936 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5164145620932454 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5528897835098338 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43190944854665303 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5162630604669602 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5528897835098339 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43161147439371056 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5160954238127029 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5528897835098338 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43112448991309293 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5159397312700614 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5528897835098339 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43048956608509314 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.515789696464501 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5528897835098338 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42972975294967175 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.515665226248715 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5528897835098338 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42886893873006016 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5155037711960834 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5528897835098338 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42789161703573964 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.515387787585919 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5528897835098339 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42687416731730643 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5152457155214359 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5528897835098339 at iter 0
max_prior_anomaly= 0.43240638645361723 at iter 12
max_prior_star_anomaly= 0.5170364940805402 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5528897835098339
accuracies_anomaly['prior'][-1]= 0.4259701866592236
accuracies_anomaly['prior_star'][-1]= 0.515133922827628



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.27772235870361 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4653646956367951
accuracies_anomaly["prior"][-1]= 0.4120633641407595
accuracies_anomaly["prior_star"][-1]= 0.4619095994196419


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam photoGGAD 
took 576.6110570430756 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0037970542907714844 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46703624262555876
 first_prior_anomaly_auc= 0.41252027879651965
 first_prior_star_anomaly_auc= 0.46384538368467876


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5433311414840789; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4122239810101198; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5174063424489954 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.537280715540295; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4121959018705317; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5122520391951262 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5450733054134486; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.412183748213098; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5169390552752531 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5615287289411692; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4121680322767614; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5314537702112181 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5816553951971261 at iter 490
0.41252027879651965 at iter 0
0.5489628948838551 at iter 490
last anomaly aucs:
0.5816553951971261
0.41211260740794764
0.5489628948838551




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 67.79370355606079 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5837837520687411,first_prior_anomaly_auc= 0.4121047494397792, first_prior_star_anomaly_auc= 0.5507976780647019


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5837836472958322 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4123578807877079 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5505967236254108 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5837837520687411 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4126671704148127 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5504104373933674 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5837835425229233 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4129813843686363 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5502289707151338 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5837836472958322 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4133980662273748 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.550022987176215 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5837836472958322 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4138943754968855 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5497955251909696 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5837837520687411 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4144557487428299 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.549576549811346 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5837837520687411 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4151820345473999 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5493746524158747 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5837836472958322 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41607417586677586 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5491282265341164 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.58378385684165 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4171887500717694 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5488782383734551 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.58378385684165 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.41862822506729563 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5486525575276612 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5837837520687411 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4204819721446553 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.548418704394972 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5837835425229233 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4229396302689772 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5481580293976018 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5837839616145589 at iter 14
max_prior_anomaly= 0.42574754422778804 at iter 129
max_prior_star_anomaly= 0.5507976780647019 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.58378385684165
accuracies_anomaly['prior'][-1]= 0.42574754422778804
accuracies_anomaly['prior_star'][-1]= 0.5479187280736495



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 120.59063482284546 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5837837520687411
 first_prior_anomaly_auc= 0.42605819590270866
 first_prior_star_anomaly_auc= 0.5478931634838753


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5838482921806302; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42605620521743937; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5479470167590554 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5839044504598063; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42605400498635226; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5479992984406019 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.583960189647347; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.42605390021344336; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5480515801221484 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5840228438468756; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4260546336238057; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5480992517957028 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.584078792580234 at iter 490
0.42605819590270866 at iter 0
0.5481377034532732 at iter 490
last anomaly aucs:
0.584078792580234
0.42605316680308103
0.5481377034532732




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 67.98180556297302 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.584084764636042,first_prior_anomaly_auc= 0.4260529572572632, first_prior_star_anomaly_auc= 0.5481418943696297


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5840844503173153 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4278774726930368 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.548006318225499 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5840845550902241 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4297445259298281 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5478608934279308 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5840844503173153 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.43181075246645906 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5477190309092654 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5840849741818598 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.43390118154504836 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.547565433824802 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5840849741818597 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.43607972464003164 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5474188565252358 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.584084764636042 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4381789546429695 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5472649451220458 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5840848694089509 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.44028530920371334 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5470897648183468 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5840846598631331 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.44227987107064926 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5469391013753331 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5840846598631331 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.44427013724831976 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5467693692628974 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.584084764636042 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4461696700868736 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5466061330708143 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5840845550902242 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4480174451084253 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5464358770938342 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5840846598631331 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4497255578423989 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5462572392841413 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5840852885005865 at iter 11
max_prior_anomaly= 0.45119395016078456 at iter 129
max_prior_star_anomaly= 0.5481418943696297 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5840848694089509
accuracies_anomaly['prior'][-1]= 0.45119395016078456
accuracies_anomaly['prior_star'][-1]= 0.5460940030920581



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 120.46568632125854 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5840846598631331
 first_prior_anomaly_auc= 0.45133895586671713
 first_prior_star_anomaly_auc= 0.546077553745359


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5841462663335726; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.45133696518144784; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5461239681440067 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5841989671067548; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4513334029025448; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5461802311960917 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5842598401668321; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4513310978985488; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5462291601445531 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5843170461750973; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.45132544016146764; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5462800797782837 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5843700612670062 at iter 490
0.45133895586671713 at iter 0
0.5463230366709373 at iter 490
last anomaly aucs:
0.5843700612670062
0.45132166833674686
0.5463230366709373




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.0735297203064 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5843751951395428,first_prior_anomaly_auc= 0.4513219826554735, first_prior_star_anomaly_auc= 0.5463274371331115


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5843751951395428 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.45279236565912845 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5461430368134284 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5843752999124517 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.45405676512386467 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5459916399600522 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5843754046853606 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4552613392576127 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5458081825965493 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5843751951395428 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.45626799736642815 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5456327927470325 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5843751951395428 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4571032469962655 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5454483924273494 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5843754046853606 iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4578430485060849 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5452655637013 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5843751951395428 iter_best_vanilla_star_anomaly= 620 
last prior auc 0.45834962552066894 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5450620947121951 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.584374985593725 iter_best_vanilla_star_anomaly= 620 
last prior auc 0.45862098735474804 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5448852380419535 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5843757190040875 iter_best_vanilla_star_anomaly= 620 
last prior auc 0.4587923958337262 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5447053429573536 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5843751951395428 iter_best_vanilla_star_anomaly= 620 
last prior auc 0.45878443309264894 iter_best_prior_anomaly= 960
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5445421067652706 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5843752999124517 iter_best_vanilla_star_anomaly= 620 
last prior auc 0.45847786756117587 iter_best_prior_anomaly= 960
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5443866237684469 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5843755094582695 iter_best_vanilla_star_anomaly= 620 
last prior auc 0.45802964905685517 iter_best_prior_anomaly= 960
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5442216064369122 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5843758237769963 at iter 62
max_prior_anomaly= 0.4588288568060272 at iter 96
max_prior_star_anomaly= 0.5463274371331115 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5843754046853606
accuracies_anomaly['prior'][-1]= 0.4575443409427802
accuracies_anomaly['prior_star'][-1]= 0.5440934691693142



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 120.48408460617065 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4670362426255589
accuracies_anomaly["prior"][-1]= 0.41252027879651965
accuracies_anomaly["prior_star"][-1]= 0.46384538368467887


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam photoGGAD 
took 565.5813663005829 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003468036651611328 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46791497301259416
 first_prior_anomaly_auc= 0.4123709774013217
 first_prior_star_anomaly_auc= 0.4645201212180647


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5432894418663324; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4122901974885515; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5171553065592451 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5301693591208798; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.41228977839691583; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5049315560495249 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5336180641905894; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4123065420623416; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5063833942483026 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.55242647770663; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4122962743172683; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5220333236523165 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5660363738012408 at iter 490
0.4123709774013217 at iter 0
0.532235271338784 at iter 490
last anomaly aucs:
0.5660363738012408
0.41225457469952176
0.532235271338784




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 67.7035346031189 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5670107618541117,first_prior_anomaly_auc= 0.4122466119584446, first_prior_star_anomaly_auc= 0.532891149748566


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5670106570812028 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41252488880451177 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5327205794528591 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5670108666270206 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4128614193879334 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5325239207028334 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5670106570812028 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.41321879978022835 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.532317622845188 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5670106570812028 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4136295095831589 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5320980188281109 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5670106570812028 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4141170179283211 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5318964357513664 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5670106570812028 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4147228148876436 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5316766221884713 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5670106570812028 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.41546209253291866 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5314550274861249 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5670108666270206 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.41636565409936577 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5312448530308498 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5670106570812028 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.41746262645566246 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5310228392368677 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5670108666270206 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.41889581507665397 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5307889861041786 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5670108666270206 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4207392944089404 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5305397313538798 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5670107618541117 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.423147814038983 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5302709888425234 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5670109713999295 at iter 35
max_prior_anomaly= 0.4259393834240038 at iter 129
max_prior_star_anomaly= 0.532891149748566 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5670106570812028
accuracies_anomaly['prior'][-1]= 0.4259393834240038
accuracies_anomaly['prior_star'][-1]= 0.5300123045304225



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 120.4962546825409 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5670108666270206
 first_prior_anomaly_auc= 0.4262512923738314
 first_prior_star_anomaly_auc= 0.5299829681159275


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.567035173941888; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42625055896346903; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 30 
last prior star auc 0.5300031892873472 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5670572810256681; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42625055896346903; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 30 
last prior star auc 0.5300184861320483 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5670825312967156; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.42624867305110864; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 30 
last prior star auc 0.530032944793478 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5671092483884879; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4262473110032928; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 30 
last prior star auc 0.530052851646171 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5671284218308186 at iter 490
0.4262516066925581 at iter 30
0.5300666816701473 at iter 490
last anomaly aucs:
0.5671284218308186
0.42624741577620173
0.5300666816701473




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 67.94721698760986 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5671292600140899,first_prior_anomaly_auc= 0.42624710145747496, first_prior_star_anomaly_auc= 0.530068043717963


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.567129155241181 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.42810671581773363 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.529918847095674 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5671294695599076 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.43013532888006567 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5297720602502899 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5671293647869987 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4322823353294668 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5296140627036523 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.567129050468272 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4343965478583789 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5294669615395415 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5671292600140898 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4366216101249186 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5293137835467138 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5671292600140898 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.43886720788160494 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.529164377378607 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5671293647869988 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4410373691438754 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5289845870669159 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5671291552411809 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4431502196249717 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5288423054566149 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.567129155241181 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4450834893401947 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5286633533281953 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5671292600140898 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.44691198614650696 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5285043080524686 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5671292600140898 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4485489580753301 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5283472534620113 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5671289456953631 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4499684214452543 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5281707111104963 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5671294695599077 at iter 31
max_prior_anomaly= 0.4509811563827866 at iter 129
max_prior_star_anomaly= 0.530068043717963 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5671292600140898
accuracies_anomaly['prior'][-1]= 0.4509811563827866
accuracies_anomaly['prior_star'][-1]= 0.528010199014045



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 120.27529549598694 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5671292600140898
 first_prior_anomaly_auc= 0.4510961970367707
 first_prior_star_anomaly_auc= 0.5279951117151619


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5671518909624146; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4510951493076816; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5280116658347698 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5671720073609254; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.45108865338732906; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5280289533647401 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5671923333052542; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4510855102000618; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5280485458987064 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5672192599428443; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4510826813315212; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5280659382015855 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5672396906600818 at iter 490
0.4510961970367707 at iter 0
0.5280837495961005 at iter 490
last anomaly aucs:
0.5672396906600818
0.45108016678170737
0.5280837495961005




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 67.92693209648132 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5672406336162621,first_prior_anomaly_auc= 0.45108006200879835, first_prior_star_anomaly_auc= 0.5280871023291855


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5672405288433533 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45189414751103574 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5279238661371025 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.567240738389171 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.45262001422397014 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5277497335624926 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5672403192975354 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.45309987414678177 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.52759990830275 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5672405288433532 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.45349863983809646 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5274148793456135 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5672406336162621 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.45367120081907275 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5272424231375463 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5672405288433532 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4536293964284173 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5270687096545721 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5672404240704443 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4535311194398589 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5268900718448791 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5672405288433532 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.45316933858538977 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5267053572064693 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5672403192975354 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.4526493506384652 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5265287100820456 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5672402145246265 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.45198970040396236 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5263373947503743 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5672403192975354 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.45123805955543594 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5261672435463032 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.567240738389171 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.4504122394874006 iter_best_prior_anomaly= 550
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.52600882690803 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5672408431620799 at iter 71
max_prior_anomaly= 0.45372390159225484 at iter 55
max_prior_star_anomaly= 0.5280871023291855 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5672404240704443
accuracies_anomaly['prior'][-1]= 0.44966782796958904
accuracies_anomaly['prior_star'][-1]= 0.5258690598475428



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 120.37073874473572 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4679149730125941
accuracies_anomaly["prior"][-1]= 0.4123709774013217
accuracies_anomaly["prior_star"][-1]= 0.46452012121806463


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam photoGGAD 
took 564.9116797447205 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return
