

/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0036590099334716797 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4110760982227314
 first_prior_anomaly_auc= 0.5411687494274595
 first_prior_star_anomaly_auc= 0.41107841411686724


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5523448685447025; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5956596798713805; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5524326152002939 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6116266119909793; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5912697738760965; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.6116610930814463 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40489973722321204; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 240 
last prior auc 0.5820383625290387; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.4048989652585001 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.404405422485994; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 240 
last prior auc 0.5688910315198338; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.4044041358781408 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6147211611996126 at iter 240
0.6047779983881376 at iter 10
0.614750624519452 at iter 240
last anomaly aucs:
0.4027743897104309
0.5602100310123956
0.4027714305123684




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 97.95680904388428 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4026661859899727,first_prior_anomaly_auc= 0.5596265543509475, first_prior_star_anomaly_auc= 0.40266502804290477


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4026660573291874 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.558532423032545 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026648993821194 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40266605732918737 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5570472915875402 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026647707213341 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40266592866840206 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5558840694274183 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40266451339976345 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4026661859899727 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5540078091950261 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40266489938211947 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40266644331154333 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5519892501340645 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40266464206054875 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4026665719723287 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5503102268855754 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026636127742662 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40266631465075803 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.547563833762031 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40266438473897814 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4026661859899727 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.5415921720719635 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026645133997635 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40266618598997267 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.5292391927513543 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026645133997635 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4026660573291874 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.5040306850826568 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026641274174074 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40266644331154333 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.47396639071501434 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40266502804290477 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40266631465075803 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.4489475290438857 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026639987566222 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40266670063311405 at iter 73
max_prior_anomaly= 0.5596265543509475 at iter 0
max_prior_star_anomaly= 0.4026651567036901 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40266618598997267
accuracies_anomaly['prior'][-1]= 0.435538887979686
accuracies_anomaly['prior_star'][-1]= 0.4026643847389782



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 129.1537697315216 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.402666314650758
 first_prior_anomaly_auc= 0.43790418785709806
 first_prior_star_anomaly_auc= 0.4026645133997635


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4026628408095542; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4379175685787718; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 80 
last prior star auc 0.40266168286248627 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40266258348798356; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.43793082063966027; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 190 
last prior star auc 0.4026629694703395 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4026584663428532; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4379333938553667; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 260 
last prior star auc 0.40265769437814125 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4026575657173559; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.43793493778479065; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 380 
last prior star auc 0.40265653643107335 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.40266644331154333 at iter 20
0.4379436867181928 at iter 480
0.4026647707213341 at iter 10
last anomaly aucs:
0.40265537848400534
0.43794124216327157
0.40265447785850816




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.31351470947266 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40265563580557606,first_prior_anomaly_auc= 0.4379403415377743, first_prior_star_anomaly_auc= 0.4026543491977228


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40265563580557606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4394832416753899 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026543491977228 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40265563580557606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4369261085670585 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026543491977228 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40265563580557606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43593053141021487 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40265434919772286 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40265563580557606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43621023995751107 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40265499250164943 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40265563580557606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43690861070025433 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40265499250164943 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40265563580557606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4370392013973591 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026552498232201 iter_best_prior_star_anomaly= 530
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40265563580557606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4375481834641041 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026562791095027 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40265563580557606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43798614477734993 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40265537848400546 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40265563580557606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43816742782387263 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026557644663614 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40265563580557606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4381243264607888 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026562791095027 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40265563580557606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4378679055156364 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40265666509185866 iter_best_prior_star_anomaly= 1010
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40265563580557606 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4375438089974032 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026558931271467 iter_best_prior_star_anomaly= 1180
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40265563580557606 at iter 0
max_prior_anomaly= 0.4408550229685234 at iter 7
max_prior_star_anomaly= 0.402657179735 at iter 118
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40265563580557606
accuracies_anomaly['prior'][-1]= 0.4370783142760978
accuracies_anomaly['prior_star'][-1]= 0.40265602178793203



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.38626861572266 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40265563580557606
 first_prior_anomaly_auc= 0.43703585621694063
 first_prior_star_anomaly_auc= 0.40265627910950264


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4026522906251576; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4370518101543209; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 100 
last prior star auc 0.4026525479467283 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40264817348002724; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43706403292892676; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 200 
last prior star auc 0.4026476588368859 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40264572892510603; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4370815307957309; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 300 
last prior star auc 0.40264482829960874 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40264379901332614; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43709439687426344; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 400 
last prior star auc 0.40264161177997565 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.40265563580557606 at iter 0
0.4371136959920621 at iter 490
0.40265627910950264 at iter 0
last anomaly aucs:
0.4026412257976197
0.4371136959920621
0.40263981052898107




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.1832845211029 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40263955320741046,first_prior_anomaly_auc= 0.4371138246528475, first_prior_star_anomaly_auc= 0.40263852392112787


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40263955320741046 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4370923383016982 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026372373132746 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40263955320741046 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43675228784608466 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40263685133091864 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40263955320741046 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43610242221940887 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026367226701333 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40263955320741046 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.435645033127579 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40263659400934804 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40263955320741046 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4355185595756047 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40263800927798654 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4026395532074105 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43623468550672273 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40263775195641593 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4026395532074104 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43660509990767304 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40263762329563063 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40263955320741046 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4369806607400363 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026383952603425 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4026395532074105 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43786365970972063 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026392958858398 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4026395532074105 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4401306627471445 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4026377519564159 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4026395532074105 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4407083496732531 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40263685133091864 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4026395532074105 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4408732928000395 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40263595070542135 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4026395532074105 at iter 4
max_prior_anomaly= 0.4415828570311061 at iter 129
max_prior_star_anomaly= 0.4026394245466251 at iter 87
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4026395532074105
accuracies_anomaly['prior'][-1]= 0.4415828570311061
accuracies_anomaly['prior_star'][-1]= 0.4026337634720708



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.53338384628296 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4110760982227314
accuracies_anomaly["prior"][-1]= 0.5411687494274595
accuracies_anomaly["prior_star"][-1]= 0.41107841411686724


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 697.1975965499878 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004603385925292969 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40270298297457563
 first_prior_anomaly_auc= 0.4906612855579813
 first_prior_star_anomaly_auc= 0.40270311163536093


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5587860134404203; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5967092945580604; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 100 
last prior star auc 0.558867069735175 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40479179082432454; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.5859807863129627; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 120 
last prior star auc 0.4047912761811832 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4052729821614394; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.57290164551998; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 120 
last prior star auc 0.4052727248398688 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40495403207461916; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.5575135582735575; count_not_improved_prior_anomaly= 31; iter_best_prior_anomaly= 120 
last prior star auc 0.40495390341383386 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5916574288222805 at iter 130
0.5973641779553641 at iter 120
0.591768977723157 at iter 130
last anomaly aucs:
0.4048819820348373
0.5512334966810664
0.4048819820348372




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.17844152450562 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4048804381054133,first_prior_anomaly_auc= 0.5507806107167229, first_prior_star_anomaly_auc= 0.4048801807838427


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4048804381054133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5491736375080156 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40488018078384264 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4048804381054133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5474943569379557 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40488018078384264 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4048804381054133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5462603713459051 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.404880309444628 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4048804381054133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5449181820333963 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048801807838427 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4048804381054133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5433826155605442 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048804381054133 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4048804381054133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5411026177838025 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.404880309444628 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4048804381054133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5377619404928429 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40488030944462805 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4048804381054133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5311868597196018 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048804381054133 iter_best_prior_star_anomaly= 720
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4048804381054133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5200685092949698 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048805667661987 iter_best_prior_star_anomaly= 720
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4048804381054133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.496482542790004 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.404880309444628 iter_best_prior_star_anomaly= 720
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4048804381054133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47237743001625243 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048801807838427 iter_best_prior_star_anomaly= 720
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4048804381054133 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44138639201191504 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40488005212305733 iter_best_prior_star_anomaly= 720
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4048804381054133 at iter 0
max_prior_anomaly= 0.5507806107167229 at iter 0
max_prior_star_anomaly= 0.40488069542698396 at iter 127
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4048804381054133
accuracies_anomaly['prior'][-1]= 0.4247824603441728
accuracies_anomaly['prior_star'][-1]= 0.4048801807838427



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.4595980644226 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4048804381054133
 first_prior_anomaly_auc= 0.4252532301576764
 first_prior_star_anomaly_auc= 0.4048797948014867


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4048822393564078; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4252331590751657; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4048818533740519 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4048839119466171; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4252118013848018; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.40488352596426114 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4048813387309106; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.42518684119244876; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4048812100701253 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4048809527485547; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4251571205510387; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.40487966614070137 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.40488429792897307 at iter 110
0.4252532301576764 at iter 0
0.40488352596426114 at iter 130
last anomaly aucs:
0.40487863685441877
0.42513692080774274
0.4048786368544187




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.33112001419067 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40487992346227203,first_prior_anomaly_auc= 0.42513331830575357, first_prior_star_anomaly_auc= 0.40487940881913065


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40487992346227203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4395559350190984 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048794088191307 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40487992346227203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4387222131301934 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048794088191307 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40487992346227203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4369901816381503 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487992346227203 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40487992346227203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43660239803118117 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048796661407014 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40487992346227203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43702980916003037 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.404879537479916 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40487992346227203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4371803422788605 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487979480148667 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40487992346227203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43633169573885766 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487889417598943 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40487992346227203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4361941573593454 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048787655152042 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40487992346227203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4355754276427183 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048783795328481 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40487992346227203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43526947229521584 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487850819363347 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40487992346227203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43506503030733457 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048785081936334 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40487992346227203 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43464816936288203 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048787655152041 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40487992346227203 at iter 0
max_prior_anomaly= 0.441138462678594 at iter 15
max_prior_star_anomaly= 0.4048809527485546 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40487992346227203
accuracies_anomaly['prior'][-1]= 0.4343225289152248
accuracies_anomaly['prior_star'][-1]= 0.40487850819363347



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.57391715049744 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40487992346227203
 first_prior_anomaly_auc= 0.4342929369346002
 first_prior_star_anomaly_auc= 0.40487850819363347


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4048790228367748; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4342822580894182; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4048776075681362 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40487979480148667; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43428071415999425; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.40487850819363347 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4048787655152041; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43427608237172266; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.40487683560342425 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4048772215857802; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43426952067167107; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4048760636387123 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.40487992346227203 at iter 0
0.4342929369346002 at iter 0
0.4048792801583454 at iter 130
last anomaly aucs:
0.4048767069426389
0.4342696493324564
0.4048749056916443




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.35280632972717 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40487760756813623,first_prior_anomaly_auc= 0.43426939201088577, first_prior_star_anomaly_auc= 0.40487554899557093


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40487760756813623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4337452279714723 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048763209602829 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40487760756813623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4332864236110039 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.404874777030859 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40487760756813623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43298600067727044 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048746483700737 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40487760756813623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.432274506534424 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487490569164436 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40487760756813623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4313855891686146 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048736190837911 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40487760756813623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4303492265428229 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048752916740003 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40487760756813623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4299479335533947 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048746483700737 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40487760756813623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42956478173469737 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048746483700737 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40487760756813623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42839036608625214 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487439104850304 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40487760756813623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4282341718928678 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048725897975085 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40487760756813623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42856380082487 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487503435242966 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40487760756813623 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4275069811342117 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.404875163013215 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40487760756813623 at iter 0
max_prior_anomaly= 0.43426939201088577 at iter 0
max_prior_star_anomaly= 0.4048763209602829 at iter 10
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40487760756813623
accuracies_anomaly['prior'][-1]= 0.42676229250875153
accuracies_anomaly['prior_star'][-1]= 0.4048746483700737



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.04676842689514 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40270298297457563
accuracies_anomaly["prior"][-1]= 0.4906612855579813
accuracies_anomaly["prior_star"][-1]= 0.40270298297457563


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 704.2681360244751 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004741668701171875 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40813645659962927
 first_prior_anomaly_auc= 0.5121598594818366
 first_prior_star_anomaly_auc= 0.40813671392119993


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5577378140223788; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5945920526747548; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 60 
last prior star auc 0.5578307071093833 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.61138331444593; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5856290277258845; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 60 
last prior star auc 0.6114211407168155 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6244537063055107; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.576121638994305; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 60 
last prior star auc 0.62444354210347 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6356935125114894; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5591911662534083; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 60 
last prior star auc 0.6357210459195489 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6361604225014332 at iter 450
0.5979580761404235 at iter 60
0.6361687854524795 at iter 450
last anomaly aucs:
0.6358081492712138
0.5500988372152866
0.6358488060793765




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.17905521392822 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6358048040907953,first_prior_anomaly_auc= 0.5494644108828497, first_prior_star_anomaly_auc= 0.6358439169695341


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6358008156064503 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5482713394205324 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358455895597434 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6358049327515807 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5475868640426043 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358394138420478 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6358057047162926 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5469806144221536 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358368406263413 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6358036461437275 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5460406187245702 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358378699126239 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6358067340025753 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5441046598877872 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358350393753467 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6358048040907953 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5416576604116939 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358340100890641 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6358059620378633 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5392338198769591 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358325948204255 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6358055760555072 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.5358584041739617 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358244891909501 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6358059620378633 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.531142986391806 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358199860634638 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6358032601613715 iter_best_vanilla_star_anomaly= 940 
last prior auc 0.5188518929089381 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358144536496948 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6358041607868687 iter_best_vanilla_star_anomaly= 940 
last prior auc 0.5050781125359864 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358111084692764 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6358063480202193 iter_best_vanilla_star_anomaly= 940 
last prior auc 0.480707315240539 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358045467692247 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6358072486457165 at iter 94
max_prior_anomaly= 0.5494644108828497 at iter 0
max_prior_star_anomaly= 0.635845846881314 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6358033888221568
accuracies_anomaly['prior'][-1]= 0.45899220521498185
accuracies_anomaly['prior_star'][-1]= 0.6358006869456649



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.96181225776672 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6358059620378633
 first_prior_anomaly_auc= 0.456660614463325
 first_prior_star_anomaly_auc= 0.6358012015888064


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6357901367612684; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.456705388416618; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6358008156064503 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6357981137299584; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45673060593054166; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 190 
last prior star auc 0.6358084065927845 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6358041607868687; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4567569813915333; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 300 
last prior star auc 0.6358125237379149 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6358021022143036; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.45679480766241876; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 400 
last prior star auc 0.635815740257548 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6358175415085425 at iter 280
0.4568247856253995 at iter 490
0.6358251324948767 at iter 440
last anomaly aucs:
0.6358104651653497
0.4568247856253995
0.6358183134732545




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.37205743789673 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.635801072928021,first_prior_anomaly_auc= 0.456825814911682, first_prior_star_anomaly_auc= 0.6358167695438306


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6358042894476541 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4514984864345214 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358123950771296 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6358059620378633 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.44295708287916075 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358103365045644 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6358041607868687 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4467507747952493 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635814968292836 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6358030028398008 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.45032149757036977 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.63581458231048 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6358036461437275 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4510413546642623 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358114944516322 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6358032601613715 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.45091513843385855 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358163835614745 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6358032601613715 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.45213510000030877 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358171555261867 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6358075059672872 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.452582324890098 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358202433850344 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6358024881966595 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.45355770230364567 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358196000811078 iter_best_prior_star_anomaly= 810
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6358021022143037 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.45415957745739527 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635820114724249 iter_best_prior_star_anomaly= 950
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6358046754300102 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.4549601048636865 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358232025830968 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6358024881966596 iter_best_vanilla_star_anomaly= 800 
last prior auc 0.45648074668544086 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358242318693794 iter_best_prior_star_anomaly= 1180
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6358075059672872 at iter 80
max_prior_anomaly= 0.45768205243801896 at iter 129
max_prior_star_anomaly= 0.6358306649086457 at iter 127
last values
accuracies_anomaly['vanilla_star'][-1]= 0.63580660534179
accuracies_anomaly['prior'][-1]= 0.45768205243801896
accuracies_anomaly['prior_star'][-1]= 0.6358283490145098



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.828444480896 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6358044181084395
 first_prior_anomaly_auc= 0.4577692844504692
 first_prior_star_anomaly_auc= 0.6358288636576511


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6357975990868172; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.45780389420172163; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6358291209792218 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.635801844892733; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4578203627822432; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 200 
last prior star auc 0.6358215299928875 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6358120090947736; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4578403052039685; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 300 
last prior star auc 0.6358310508910017 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6358068626633606; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4578593470001966; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 400 
last prior star auc 0.6358328521419963 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6358125237379149 at iter 210
0.4578813479944871 at iter 490
0.6358349107145614 at iter 490
last anomaly aucs:
0.6358076346280725
0.4578813479944871
0.6358349107145614




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.47329354286194 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6358073773065018,first_prior_anomaly_auc= 0.45788404987097897, first_prior_star_anomaly_auc= 0.6358302789262897


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.635806991324146 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4592879963604437 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358382558949799 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6358062193594339 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4607024930343051 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358403144675451 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.63580467543001 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4627988918703882 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635841086432257 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6358080206104285 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.46337593549257006 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358454608989581 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6358063480202193 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.4634355054361755 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358551104578574 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6358051900731514 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.46384606200214706 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635860128228485 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.635806991324146 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.4649822653973509 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358723510030909 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6358087925751404 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.4662085313422819 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358816145796344 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6358072486457166 iter_best_vanilla_star_anomaly= 710 
last prior auc 0.46889393925358214 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635897311195444 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6358072486457166 iter_best_vanilla_star_anomaly= 980 
last prior auc 0.47221982055422956 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6359162243308867 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6358075059672872 iter_best_vanilla_star_anomaly= 980 
last prior auc 0.4750116309349933 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6359251019250742 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6358087925751406 iter_best_vanilla_star_anomaly= 980 
last prior auc 0.47566805826172076 iter_best_prior_anomaly= 1160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6359270318368541 iter_best_prior_star_anomaly= 1150
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.635810593826135 at iter 98
max_prior_anomaly= 0.47598289120341064 at iter 129
max_prior_star_anomaly= 0.6359380966643919 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6358094358790671
accuracies_anomaly['prior'][-1]= 0.47598289120341064
accuracies_anomaly['prior_star'][-1]= 0.6359380966643919



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.67759156227112 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4081361992780586
accuracies_anomaly["prior"][-1]= 0.5121598594818366
accuracies_anomaly["prior_star"][-1]= 0.40813684258198524


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 705.8239395618439 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004681587219238281 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4033101332205235
 first_prior_anomaly_auc= 0.4867310845486631
 first_prior_star_anomaly_auc= 0.40330961857738223


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5608038005366699; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5981061647043323; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.5608825409372887 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6135431430491782; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5837208596187318; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 100 
last prior star auc 0.6135706764572377 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6325189362943842; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5691681668514236; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 100 
last prior star auc 0.6325419665749572 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4051068810875851; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 350 
last prior auc 0.5515045849557458; count_not_improved_prior_anomaly= 32; iter_best_prior_anomaly= 100 
last prior star auc 0.4051061091228731 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6368246981360655 at iter 350
0.5981061647043323 at iter 100
0.6368558340461141 at iter 350
last anomaly aucs:
0.40501334469665384
0.543052986628542
0.40501308737508324




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.29831552505493 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40492135223514664,first_prior_anomaly_auc= 0.5423508847230243, first_prior_star_anomaly_auc= 0.40491517651745107


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40492135223514664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.540195044604121 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049160771429483 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40492135223514664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.538034444036161 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40491620580373366 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40492135223514664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5363811529447365 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049169777684456 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40492135223514664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5334081881782353 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40491672044687493 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40492135223514664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5283020275910482 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049172350900162 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40492135223514664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.522668357784029 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40491774973315753 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40492135223514664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5131174817070095 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40491826437629885 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40492135223514664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49958468298497133 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049187790194401 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40492135223514664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4768943242066518 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049190363410108 iter_best_prior_star_anomaly= 830
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40492135223514664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4521438489337109 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049190363410108 iter_best_prior_star_anomaly= 830
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40492135223514664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4326647346963142 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40491916500179603 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40492135223514664 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41640291205675073 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40491942232336675 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40492135223514664 at iter 0
max_prior_anomaly= 0.5423508847230243 at iter 0
max_prior_star_anomaly= 0.4049199369665081 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40492135223514664
accuracies_anomaly['prior'][-1]= 0.40743576996275016
accuracies_anomaly['prior_star'][-1]= 0.4049199369665081



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.61238527297974 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40492135223514664
 first_prior_anomaly_auc= 0.4060624447401927
 first_prior_star_anomaly_auc= 0.4049198083057227


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40491916500179614; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4060755681402959; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 100 
last prior star auc 0.404915562499807 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4049153051782364; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.40609448127573855; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 200 
last prior star auc 0.40491105937232064 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4049096441036821; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4061145523582493; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 300 
last prior star auc 0.4049047549938397 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40489909391928547; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.40614684621536584; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 400 
last prior star auc 0.404896134721223 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.40492173821750266 at iter 10
0.40616305747431675 at iter 490
0.4049201942880787 at iter 10
last anomaly aucs:
0.40489562007808166
0.40616305747431675
0.40489201757609256




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.62352752685547 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40489600606043763,first_prior_anomaly_auc= 0.4061630574743168, first_prior_star_anomaly_auc= 0.40489201757609256


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40489600606043763 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.39251292011606237 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048926608800192 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40489600606043763 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.38440510340724643 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048931755231605 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40489600606043763 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.37840770956011394 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048940761486578 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40489600606043763 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3778040331553697 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048940761486578 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40489600606043763 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.39357861740090805 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40489446213101377 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40489600606043763 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4002341111649771 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40489664936436426 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40489600606043763 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4025888608579925 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40489716400750553 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40489600606043763 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40388640487799354 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048978073114322 iter_best_prior_star_anomaly= 750
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40489600606043763 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40486255425625317 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40489870793692945 iter_best_prior_star_anomaly= 750
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40489600606043763 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4050042097808958 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40490038052713867 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40489600606043763 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4051661937096198 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049006378487093 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40489600606043763 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40590432063502846 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049007665094947 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40489600606043763 at iter 0
max_prior_anomaly= 0.4069879017690343 at iter 129
max_prior_star_anomaly= 0.40490205311734784 at iter 124
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40489600606043763
accuracies_anomaly['prior'][-1]= 0.4069879017690343
accuracies_anomaly['prior_star'][-1]= 0.40490128115263596



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.84213066101074 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40489600606043763
 first_prior_anomaly_auc= 0.4071105154974489
 first_prior_star_anomaly_auc= 0.4049021817781332


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40488867239567417; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4071036964758267; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 30 
last prior star auc 0.40489587739965227 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40488172471326656; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40709867870519906; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 30 
last prior star auc 0.4048879004309621 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40487786488970684; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40709391825614205; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 30 
last prior star auc 0.40488262533876385 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4048746483700737; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40708285342860406; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 30 
last prior star auc 0.4048776075681362 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.40489600606043763 at iter 0
0.40711283139158483 at iter 30
0.4049021817781332 at iter 0
last anomaly aucs:
0.4048706598857286
0.40708401137567196
0.4048760636387123




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.67241597175598 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40486808667002216,first_prior_anomaly_auc= 0.407084011375672, first_prior_star_anomaly_auc= 0.40487387640536177


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40486808667002216 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40825842702411724 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048741337269325 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40486808667002216 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40844241194713177 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048749056916443 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40486808667002216 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.408778345257615 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048754203347857 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40486808667002216 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40873305666118054 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487606363871226 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40486808667002216 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40846724347869945 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487580631714165 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40486808667002216 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4086831362764745 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048764496210683 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40486808667002216 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4085055843927262 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048763209602829 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40486808667002216 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4082759248909214 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487477703085906 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40486808667002216 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40722579556109995 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487400506614707 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40486808667002216 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4070576359146804 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487400506614707 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40486808667002216 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4072884533635532 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048723324759379 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40486808667002216 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40760727478958814 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048693732778754 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40486808667002216 at iter 0
max_prior_anomaly= 0.4087915973185034 at iter 29
max_prior_star_anomaly= 0.4048781222112775 at iter 56
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40486808667002216
accuracies_anomaly['prior'][-1]= 0.4069879017690343
accuracies_anomaly['prior_star'][-1]= 0.4048682153308074



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.23180532455444 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4033101332205235
accuracies_anomaly["prior"][-1]= 0.4867310845486631
accuracies_anomaly["prior_star"][-1]= 0.40330961857738223


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 705.6095476150513 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.005358219146728516 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40217238589589593
 first_prior_anomaly_auc= 0.4710661192922216
 first_prior_star_anomaly_auc= 0.4021703273233307


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5588288574819334; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5968560965141161; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.558896790376585 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6178676893655171; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5792483533992694; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 100 
last prior star auc 0.6178810700871908 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40478793100076477; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.559341570711453; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 100 
last prior star auc 0.40478870296547664 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4022598752299168; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5448158967090629; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 100 
last prior star auc 0.40225833130049293 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6178676893655171 at iter 200
0.5968560965141161 at iter 100
0.6178810700871908 at iter 200
last anomaly aucs:
0.40508758196978634
0.5385251562713899
0.4050879679521423




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.34088587760925 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4050833361638706,first_prior_anomaly_auc= 0.5377835555047774, first_prior_star_anomaly_auc= 0.4050850087540798


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4050833361638706 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5365300134733574 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050832075030853 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4050833361638706 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5354914636142153 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40508307884229994 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4050833361638706 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5346012596405526 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40508346482465596 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4050833361638706 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5333904329898604 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050832075030853 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4050833361638706 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5328742459191372 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050834648246559 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4050833361638706 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5314991194455853 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050833361638707 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4050833361638706 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5303328094266154 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40508256419915867 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4050833361638706 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5264651375589652 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40508333616387066 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4050833361638706 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5188134233341258 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050830788423 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4050833361638706 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5060268571669719 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050828215207293 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4050833361638706 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48918039991889223 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050820495560174 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4050833361638706 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46659541432375373 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050824355383733 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4050833361638706 at iter 0
max_prior_anomaly= 0.5377835555047774 at iter 0
max_prior_star_anomaly= 0.4050850087540798 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4050833361638706
accuracies_anomaly['prior'][-1]= 0.46607858394910384
accuracies_anomaly['prior_star'][-1]= 0.4050816635736614



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.86847281455994 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4050833361638706
 first_prior_anomaly_auc= 0.4654257591243656
 first_prior_star_anomaly_auc= 0.40508102026973475


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4050811489305201; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.465374423471021; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4050796050010962 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40508668134428905; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4653263043373095; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.40508578071879175 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40508307884229994; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4652970983390407; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.40508179223444674 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.405081920895232; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.465272652789829; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.40508127759130547 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.40508668134428905 at iter 200
0.4654257591243656 at iter 0
0.40508578071879175 at iter 200
last anomaly aucs:
0.4050847514325092
0.46524228884449237
0.4050844941109385




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.45924925804138 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.405081534912876,first_prior_anomaly_auc= 0.4652350838405142, first_prior_star_anomaly_auc= 0.4050803769658081


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.405081534912876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4589497471558247 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40508102026973475 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.405081534912876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4575315193191889 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40508140625209077 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.405081534912876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45709227139808983 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050801196442375 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.405081534912876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4561675863339602 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050801196442375 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.405081534912876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45633124285289334 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40507561651675117 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.405081534912876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4574342517654833 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050805056265935 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.405081534912876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4577961745546021 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40507831839324293 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.405081534912876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45770765593429863 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40507767508931636 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.405081534912876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45832535636464317 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050792190187402 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.405081534912876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45861471447083874 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050787043755989 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.405081534912876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4589723914540419 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050805056265935 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.405081534912876 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4598124177214278 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40508179223444674 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.405081534912876 at iter 0
max_prior_anomaly= 0.4652350838405142 at iter 0
max_prior_star_anomaly= 0.40508204955601734 at iter 33
last values
accuracies_anomaly['vanilla_star'][-1]= 0.405081534912876
accuracies_anomaly['prior'][-1]= 0.46025333823273606
accuracies_anomaly['prior_star'][-1]= 0.40507883303638426



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 131.00805759429932 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.405081534912876
 first_prior_anomaly_auc= 0.46027443860152933
 first_prior_star_anomaly_auc= 0.40507999098345215


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4050833361638706; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4602561687700132; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.40508153491287613 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40507896169716956; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.46024356001305133; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.40507857571481365 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40508192089523204; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 250 
last prior auc 0.46022130169719017; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4050815349128761 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40507716044617503; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4601949262361985; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4050754878559658 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4050860380403625 at iter 320
0.46027443860152933 at iter 0
0.40508475143250916 at iter 320
last anomaly aucs:
0.4050770317853897
0.46017832899489164
0.4050754878559658




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.55672192573547 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4050784470540283,first_prior_anomaly_auc= 0.4601779430125356, first_prior_star_anomaly_auc= 0.40507651714224846


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4050784470540283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46047540674820675 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40507510187360984 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4050784470540283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46099789819741094 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050726573186887 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4050784470540283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46122125332073494 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40507767508931636 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4050784470540283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46142582396940135 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050752305343952 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4050784470540283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4613796347474698 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050766458030337 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4050784470540283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4611589815006376 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40507304330104466 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4050784470540283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4613080993508291 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40507510187360984 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4050784470540283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4605129756975216 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050743299088979 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4050784470540283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4601604451457315 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050726573186887 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4050784470540283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46035742480806385 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40507870437559895 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4050784470540283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46085804392376273 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40507317196182996 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4050784470540283 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46144177790678165 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40507651714224835 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4050784470540283 at iter 0
max_prior_anomaly= 0.46210991336497365 at iter 129
max_prior_star_anomaly= 0.40507870437559895 at iter 100
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4050784470540283
accuracies_anomaly['prior'][-1]= 0.46210991336497365
accuracies_anomaly['prior_star'][-1]= 0.4050757451775364



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.89029788970947 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40217238589589593
accuracies_anomaly["prior"][-1]= 0.4710661192922216
accuracies_anomaly["prior_star"][-1]= 0.4021703273233307


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 706.5431077480316 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004799365997314453 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40630316906953545
 first_prior_anomaly_auc= 0.49112279179494145
 first_prior_star_anomaly_auc= 0.406305356302886


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5585205862402951; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5942482710563668; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 60 
last prior star auc 0.5585957241389248 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6124508129817703; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5831653023476991; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 60 
last prior star auc 0.6124820775526042 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6212368006900335; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5749292108359143; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 60 
last prior star auc 0.6212500527509219 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6380298637122033; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5631077292194819; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 60 
last prior star auc 0.6380674326615182 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.63937321097178 at iter 480
0.5979946158034557 at iter 60
0.6394179849250731 at iter 480
last anomaly aucs:
0.6392871369063977
0.5514010130235594
0.6393205887105822




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.43729400634766 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.639308623257547,first_prior_anomaly_auc= 0.5505132536048178, first_prior_star_anomaly_auc= 0.6393334547891146


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.639307851292835 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5500686019307353 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.639334355414612 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6393088805791176 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5497246916515618 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393338407714706 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6393084945967616 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5493434697446444 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393329401459734 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6393088805791177 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5488106854326141 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393334547891147 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6393084945967616 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.5477148815240025 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393324255028321 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6393084945967616 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.5466364468214095 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393308815734082 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.639309009239903 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.5447438466692811 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393301096086963 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6393087519183323 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.5428809671585626 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393313962165494 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6393088805791176 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.5393318593953766 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393293376439843 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6393083659359764 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.530749670371068 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393285656792723 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6393091379006882 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.5144218447486328 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393261211243513 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.639309009239903 iter_best_vanilla_star_anomaly= 420 
last prior auc 0.5367430757338554 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393307529126229 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6393096525438295 at iter 42
max_prior_anomaly= 0.5505132536048178 at iter 0
max_prior_star_anomaly= 0.6393450342597939 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6393088805791176
accuracies_anomaly['prior'][-1]= 0.53123562215724
accuracies_anomaly['prior_star'][-1]= 0.6393450342597939



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.99508094787598 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6393083659359764
 first_prior_anomaly_auc= 0.5303491493463518
 first_prior_star_anomaly_auc= 0.6393479934578563


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6393057927202699; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5303303648716943; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 20 
last prior star auc 0.6393522392637722 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6393120970987507; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5303145395950994; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 20 
last prior star auc 0.6393527539069135 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6393164715654518; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5303032174459908; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 20 
last prior star auc 0.6393590582853943 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6393171148693784; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 320 
last prior auc 0.5302918952968823; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 20 
last prior star auc 0.639358157659897 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.639320074067441 at iter 450
0.5303492780071372 at iter 20
0.6393604735540329 at iter 310
last anomaly aucs:
0.639317758173305
0.5302994862832163
0.6393568710520438




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.82699704170227 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.639318144155661,first_prior_anomaly_auc= 0.5302985856577191, first_prior_star_anomaly_auc= 0.6393573856951851


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6393187874595877 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.529633924040731 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393537831931959 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6393173721909491 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.525447559407831 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393506953343483 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6393184014772317 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.5169796211608908 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393528825676988 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.639318144155661 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.5089735751332669 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393559704265466 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6393184014772317 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.5041647496209654 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393609881971741 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6393186587988023 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.5000295919806248 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.639359315606965 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6393184014772317 iter_best_vanilla_star_anomaly= 680 
last prior auc 0.4975311281904015 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.639358157659897 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.639317758173305 iter_best_vanilla_star_anomaly= 680 
last prior auc 0.49559992980267553 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393580289991118 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6393187874595877 iter_best_vanilla_star_anomaly= 680 
last prior auc 0.4944046711070077 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393656199854458 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.639318144155661 iter_best_vanilla_star_anomaly= 920 
last prior auc 0.4935722358259559 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393665206109431 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6393180154948757 iter_best_vanilla_star_anomaly= 920 
last prior auc 0.4922376374997813 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393701231129323 iter_best_prior_star_anomaly= 1080
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6393176295125198 iter_best_vanilla_star_anomaly= 920 
last prior auc 0.4908802662146041 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393765561521985 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.639319302102729 at iter 92
max_prior_anomaly= 0.530608658150352 at iter 2
max_prior_star_anomaly= 0.6393824745483234 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6393180154948758
accuracies_anomaly['prior'][-1]= 0.4898890635244615
accuracies_anomaly['prior_star'][-1]= 0.6393824745483234



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.56712698936462 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.639318144155661
 first_prior_anomaly_auc= 0.48973042477615597
 first_prior_star_anomaly_auc= 0.6393826032091088


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6393168575478078; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4897305534369413; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 50 
last prior star auc 0.6393851764248153 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.639318144155661; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4897287521859467; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 50 
last prior star auc 0.6393963699131385 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6393265071067071; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4897310680800826; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 50 
last prior star auc 0.6393962412523532 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.639312997724248; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.489724120397675; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 50 
last prior star auc 0.6393948259837147 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6393265071067071 at iter 300
0.4897328693310771 at iter 50
0.639400487058269 at iter 230
last anomaly aucs:
0.6393164715654518
0.4897200032525447
0.639383889816962




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.37917590141296 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6393184014772316,first_prior_anomaly_auc= 0.489714985481917, first_prior_star_anomaly_auc= 0.6393867203542392


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.639318144155661 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48868531321696224 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6393958552699972 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.639318530138017 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48820630911319784 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6394017736661222 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6393186587988023 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48761974459290186 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6394134817975867 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6393180154948757 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4870634153571572 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6394411438664316 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.639316986208593 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48737220124193686 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6394590277155918 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6393175008517343 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48811405933011986 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6394695778999884 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6393177581733052 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4899540372210506 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6394881050530752 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.639318530138017 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.4904452640994208 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395048309551674 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6393175008517344 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.49009697935354646 iter_best_prior_anomaly= 820
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395279898965258 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6393186587988023 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.48988829155974956 iter_best_prior_anomaly= 820
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395562952692974 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.639318144155661 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.4904594167858065 iter_best_prior_anomaly= 820
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395768809949494 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6393187874595876 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.48978832212955214 iter_best_prior_anomaly= 820
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395905190381937 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6393190447811583 at iter 73
max_prior_anomaly= 0.49058074390636786 at iter 82
max_prior_star_anomaly= 0.6396038997598674 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6393187874595876
accuracies_anomaly['prior'][-1]= 0.4887964761354829
accuracies_anomaly['prior_star'][-1]= 0.6396038997598674



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 129.9934709072113 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4063032977303208
accuracies_anomaly["prior"][-1]= 0.49112279179494145
accuracies_anomaly["prior_star"][-1]= 0.40630535630288606


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 705.5313594341278 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.00476384162902832 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40990374114685135
 first_prior_anomaly_auc= 0.5360771275090139
 first_prior_star_anomaly_auc= 0.4099068290056992


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5552266128144083; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5948817967633063; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5553171900072771 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.610443447409132; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5867826003271073; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.6104774138564578 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6197979871277457; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5774917476972293; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.6198102099023516 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4048459570149463; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.565335619378167; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.4048462143365169 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6313182738457327 at iter 360
0.6005177824644613 at iter 10
0.6313441346635829 at iter 360
last anomaly aucs:
0.4050780610716723
0.551673387906092
0.40507818973245757




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.30234694480896 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4050568320420937,first_prior_anomaly_auc= 0.5507107479102915, first_prior_star_anomaly_auc= 0.40505644605973773


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4050568320420937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5498254330464712 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40505644605973773 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4050568320420937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5484414289787318 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050564460597377 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4050568320420937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.54658909965241 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050567033813084 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4050568320420937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5447087222748873 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40505657472052303 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4050568320420937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5429127463725378 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40505657472052303 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4050568320420937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5410306964048059 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40505657472052303 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4050568320420937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5364719874591759 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40505657472052303 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4050568320420937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.529010176553476 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40505670338130834 iter_best_prior_star_anomaly= 740
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4050568320420937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5134418355468134 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40505657472052303 iter_best_prior_star_anomaly= 740
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4050568320420937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49221036141329244 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40505657472052303 iter_best_prior_star_anomaly= 740
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4050568320420937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46928648330960826 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050567033813084 iter_best_prior_star_anomaly= 740
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4050568320420937 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4542718983229839 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40505721802444966 iter_best_prior_star_anomaly= 1160
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4050568320420937 at iter 0
max_prior_anomaly= 0.5507107479102915 at iter 0
max_prior_star_anomaly= 0.4050590192754442 at iter 121
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4050568320420937
accuracies_anomaly['prior'][-1]= 0.4503118480114704
accuracies_anomaly['prior_star'][-1]= 0.40505734668523496



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.06244087219238 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4050568320420937
 first_prior_anomaly_auc= 0.45062822488258414
 first_prior_star_anomaly_auc= 0.40505721802444966


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40505811864994695; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4506300261335787; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 80 
last prior star auc 0.40505798998916165 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40505361552246055; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4506266809531603; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 80 
last prior star auc 0.4050532295401046 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40505425882638724; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4506381317630542; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 290 
last prior star auc 0.4050543874871725 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4050532295401046; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.45063517256499175; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 320 
last prior star auc 0.4050532295401046 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.40505811864994695 at iter 100
0.4506450794454618 at iter 490
0.40505798998916165 at iter 100
last anomaly aucs:
0.40505091364596874
0.4506450794454618
0.40505091364596874




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.48460960388184 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40505451614795784,first_prior_anomaly_auc= 0.4506489392690215, first_prior_star_anomaly_auc= 0.40505477346952845


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40505451614795784 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44493833031237806 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050550307910991 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40505451614795784 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4417562917697239 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050549021303138 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40505451614795784 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44301060576585594 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40505477346952845 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40505451614795784 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4444516065614942 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40505477346952845 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40505451614795784 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44505348171524384 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050552881126698 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40505451614795784 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44571840065380264 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40505515945188447 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40505451614795784 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44682809992722944 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40505515945188447 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40505451614795784 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.447425986596634 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050532295401046 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40505451614795784 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4479897781579275 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40505477346952856 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40505451614795784 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44827025866993564 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050560600773817 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40505451614795784 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4485677224056067 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40505541677345513 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40505451614795784 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4487236592774205 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.405056188738167 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40505451614795784 at iter 0
max_prior_anomaly= 0.4506489392690215 at iter 0
max_prior_star_anomaly= 0.40505798998916165 at iter 85
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40505451614795784
accuracies_anomaly['prior'][-1]= 0.4487895335995068
accuracies_anomaly['prior_star'][-1]= 0.40505503079109917



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 129.99286651611328 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40505451614795784
 first_prior_anomaly_auc= 0.44880149905254196
 first_prior_star_anomaly_auc= 0.4050552881126698


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40505284355774857; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44880806075259355; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 100 
last prior star auc 0.4050534868616753 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4050523289146073; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4488141078095038; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 190 
last prior star auc 0.40505310087931923 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40504872641261824; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44881629504285436; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 300 
last prior star auc 0.40504988435968614 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40505142828911; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4488247866546858; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 400 
last prior star auc 0.40504885507340355 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.40505451614795784 at iter 0
0.4488393253234275 at iter 480
0.40505593141659646 at iter 40
last anomaly aucs:
0.4050501416812568
0.4488385533587156
0.40504666784005305




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.30984234809875 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4050491123949742,first_prior_anomaly_auc= 0.4488402259489248, first_prior_star_anomaly_auc= 0.4050453812321998


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4050491123949742 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4490180351542437 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050471824831943 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4050491123949742 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4499656218381612 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40504898373418885 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4050491123949742 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4512564754973254 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050491123949742 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4050491123949742 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4519163766652566 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40504962703811553 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4050491123949742 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4527234657715993 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40504975569890084 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4050491123949742 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4542520845620438 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40504885507340355 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4050491123949742 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4540680996390293 iter_best_prior_anomaly= 620
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050456385537704 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4050491123949742 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45491648885746133 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40504679650083836 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4050491123949742 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45478281030150886 iter_best_prior_anomaly= 840
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050485977518329 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4050491123949742 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4542289256206853 iter_best_prior_anomaly= 840
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050435799812052 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4050491123949742 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45359810179023763 iter_best_prior_anomaly= 840
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050452525714145 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4050491123949742 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4534644232342851 iter_best_prior_anomaly= 840
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050465391792677 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4050491123949742 at iter 0
max_prior_anomaly= 0.45492665305950203 at iter 84
max_prior_star_anomaly= 0.40505194293225133 at iter 19
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4050491123949742
accuracies_anomaly['prior'][-1]= 0.45282034734294885
accuracies_anomaly['prior_star'][-1]= 0.4050453812321998



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.54310703277588 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40990386980763666
accuracies_anomaly["prior"][-1]= 0.5360771275090139
accuracies_anomaly["prior_star"][-1]= 0.4099070863272698


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 704.0276322364807 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0047075748443603516 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40567852095678336
 first_prior_anomaly_auc= 0.4889021066402346
 first_prior_star_anomaly_auc= 0.40567633372343287


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5588789065274248; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5959413183304565; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 100 
last prior star auc 0.5589679397908696 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6136895590228779; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5821560871476109; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 100 
last prior star auc 0.6137105307308859 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6276118139420943; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5701934646496772; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 100 
last prior star auc 0.627617603677434 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.402782752661477; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 320 
last prior auc 0.5540726542308299; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 100 
last prior star auc 0.40271250387268964 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6455423669673213 at iter 430
0.5959413183304565 at iter 100
0.6455504725967967 at iter 430
last anomaly aucs:
0.6417457158531703
0.5437706564890838
0.6417320778099259




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 105.79851913452148 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6419601933823067,first_prior_anomaly_auc= 0.5429606081846786, first_prior_star_anomaly_auc= 0.6419559475763911


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6419601933823067 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5423413638249102 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419609653470187 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6419601933823067 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5402528132967319 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419617373117308 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6419600647215213 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5392540196202551 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.641967398386285 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6419600647215215 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5377413547671909 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419667550823583 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6419601933823067 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5356884432765476 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419689423157089 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6419601933823068 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5325281484066133 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419733167824099 iter_best_prior_star_anomaly= 530
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6419601933823067 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5257771883398333 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.641976147319687 iter_best_prior_star_anomaly= 530
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6419601933823067 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.512110067757916 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419791065177496 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6419604507038774 iter_best_vanilla_star_anomaly= 880 
last prior auc 0.49133006432009974 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419785918746083 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6419605793646627 iter_best_vanilla_star_anomaly= 880 
last prior auc 0.4601986573989729 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419780772314669 iter_best_prior_star_anomaly= 940
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6419604507038774 iter_best_vanilla_star_anomaly= 880 
last prior auc 0.4352151774438087 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419780772314669 iter_best_prior_star_anomaly= 940
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6419601933823067 iter_best_vanilla_star_anomaly= 880 
last prior auc 0.4303021366953941 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419800071432468 iter_best_prior_star_anomaly= 940
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6419630239195839 at iter 88
max_prior_anomaly= 0.5429606081846786 at iter 0
max_prior_star_anomaly= 0.6419846389315185 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6419601933823067
accuracies_anomaly['prior'][-1]= 0.44715554162588117
accuracies_anomaly['prior_star'][-1]= 0.6419798784824615



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 135.9699547290802 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6419599360607362
 first_prior_anomaly_auc= 0.44781428484674446
 first_prior_star_anomaly_auc= 0.6419802644648174


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6419740887471218; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4478433621842278; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 90 
last prior star auc 0.6419915866139261 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6419864401825129; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4478503098666354; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 150 
last prior star auc 0.6420012361728253 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.641987598129581; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4478757847021297; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 290 
last prior star auc 0.6420018794767521 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6419904286668581; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.44790421873568653; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 390 
last prior star auc 0.6420094704630862 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6419968617061242 at iter 480
0.44791592686715104 at iter 480
0.6420132016258606 at iter 480
last anomaly aucs:
0.6419959610806271
0.44791180972202066
0.6420125583219339




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.52546668052673 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6419913292923554,first_prior_anomaly_auc= 0.4479152835632244, first_prior_star_anomaly_auc= 0.6420098564454422


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.64199120063157 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.450554502252593 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6420085698375889 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6419919725962819 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.45188794263169973 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6420000782257573 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6419915866139261 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.45144239033211986 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419937738472765 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6419924872394233 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4520950864960728 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419879841119369 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6419918439354967 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.45226620534055484 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419879841119369 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6419932592041352 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4527211498774635 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419878554511516 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6419922299178527 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.45407286008808634 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.641981679733456 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.641992358578638 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4543613175687846 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419821943765973 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6419926159002087 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.45462069771199953 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419798784824615 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6419922299178527 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.45510317565696773 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419742174079072 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6419917152747114 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.45555451769188726 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419774339275403 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6419917152747113 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.456357618313885 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419793638393202 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6419932592041352 at iter 60
max_prior_anomaly= 0.45700040759736793 at iter 129
max_prior_star_anomaly= 0.6420098564454422 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.641991972596282
accuracies_anomaly['prior'][-1]= 0.45700040759736793
accuracies_anomaly['prior_star'][-1]= 0.6419791065177495



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 135.6604461669922 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6419913292923554
 first_prior_anomaly_auc= 0.45701211572883244
 first_prior_star_anomaly_auc= 0.6419807791079588


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6419882414335076; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.45701494626610967; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 100 
last prior star auc 0.6419809077687441 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6419824516981679; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.45703064288191925; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 200 
last prior star auc 0.6419802644648175 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6419730594608393; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.45704415226437833; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 300 
last prior star auc 0.6419806504471735 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.641966240439217; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4570469828016555; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 340 
last prior star auc 0.6419762759804724 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6419944171512032 at iter 10
0.4570593342370467 at iter 470
0.6419833523236652 at iter 10
last anomaly aucs:
0.641968170350997
0.45705688968212554
0.6419788491961789




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.59898781776428 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6419645678490078,first_prior_anomaly_auc= 0.45705907691547604, first_prior_star_anomaly_auc= 0.6419753753549752


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6419659831176464 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4571271384709129 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419860542001571 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6419650824921491 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.45735023627266613 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419905573276434 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6419645678490078 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4571666373320076 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419972476884803 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6419654684745051 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4573641316374813 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6420009788512547 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6419652111529345 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.45868702183219134 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6420183480572736 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6419650824921491 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.45988202320628857 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.642037132531931 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6419649538313638 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.45899078994634335 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6420538584340232 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6419644391882225 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4600907110000855 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6420710989792568 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6419654684745051 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.46201804956425163 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6420982464049603 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6419640532058666 iter_best_vanilla_star_anomaly= 910 
last prior auc 0.4637596019544088 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6421073813207184 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6419646965097932 iter_best_vanilla_star_anomaly= 1090 
last prior auc 0.4653255323725975 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6421302829405062 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6419653398137198 iter_best_vanilla_star_anomaly= 1090 
last prior auc 0.4666850908911252 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.642152412595582 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6419671410647143 at iter 109
max_prior_anomaly= 0.4678193643745491 at iter 129
max_prior_star_anomaly= 0.6421645067094026 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.641962637937228
accuracies_anomaly['prior'][-1]= 0.4678193643745491
accuracies_anomaly['prior_star'][-1]= 0.6421645067094026



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 135.57081484794617 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40567877827835397
accuracies_anomaly["prior"][-1]= 0.4889021066402346
accuracies_anomaly["prior_star"][-1]= 0.4056764623842182


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 726.45205950737 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004702329635620117 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4042076708589497
 first_prior_anomaly_auc= 0.4789589438287597
 first_prior_star_anomaly_auc= 0.404208571484447


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5628150259328679; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5908484098041576; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 40 
last prior star auc 0.5628860466863672 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6034183112088247; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5800577583997482; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 40 
last prior star auc 0.6035593234295408 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6308190699986722; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5658026580288962; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 40 
last prior star auc 0.630852264481286 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6320618045241249; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5512359412359875; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 40 
last prior star auc 0.6321014320460049 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6334940563863611 at iter 390
0.5935496429920529 at iter 40
0.6335302100670375 at iter 390
last anomaly aucs:
0.40204874288119874
0.5440631024541274
0.4020477135949162




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 105.87964010238647 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4013909002858328,first_prior_anomaly_auc= 0.543678406706006, first_prior_star_anomaly_auc= 0.40138845573091164


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4013909002858328 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5427963083618188 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40138845573091164 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4013909002858328 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5424996165908598 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4013883270701263 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4013907716250475 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5403140558305466 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40138845573091164 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4013909002858328 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5396491368919877 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4013881984093409 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4013909002858328 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5381395598977713 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4013880697485557 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4013907716250475 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.5356057143915838 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4013879410877703 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4013907716250475 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.5334758637513163 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.401388584391697 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4013907716250475 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.5314800776493571 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40138858439169695 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4013909002858328 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.5278006365106371 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4013888417132676 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4013907716250475 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.5208142272067127 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4013888417132676 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4013907716250475 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.5107924526554042 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4013887130524823 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4013909002858328 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.48648161128591827 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40138871305248225 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40139102894661816 at iter 59
max_prior_anomaly= 0.543678406706006 at iter 0
max_prior_star_anomaly= 0.4013898709995502 at iter 127
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4013907716250475
accuracies_anomaly['prior'][-1]= 0.4554201958320081
accuracies_anomaly['prior_star'][-1]= 0.40138948501719424



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 134.87598252296448 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4013907716250475
 first_prior_anomaly_auc= 0.4529627748323035
 first_prior_star_anomaly_auc= 0.40138961367797954


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40137108652489273; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45295698509696386; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 20 
last prior star auc 0.4013705718817515 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4013544892835859; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45299172350900163; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 200 
last prior star auc 0.4013532026757326 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40133673409521103; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4530089640542352; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 270 
last prior star auc 0.40133133034222734 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40128887228307014; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45301333852093617; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 350 
last prior star auc 0.4012807666535947 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4013907716250475 at iter 0
0.45303778407014794 at iter 490
0.40138961367797954 at iter 0
last anomaly aucs:
0.40120588607653573
0.45303778407014794
0.4011863296371663




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 105.79586029052734 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40119469258821244,first_prior_anomaly_auc= 0.45304704764669124, first_prior_star_anomaly_auc= 0.40117462150570177


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4011946925882124 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.443157150400341 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40117745204297883 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40119469258821244 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4321738938002999 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4011793819547588 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4011946925882124 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.423904479145116 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40118169784889457 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4011946925882124 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41661726092510193 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4011840137430305 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4011946925882124 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.411607853248479 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40118658695873693 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4011946925882124 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4080563009303719 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40118813088816085 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4011946925882124 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40776578487710835 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4011916047293646 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40119469258821244 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40882003135206013 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4011954645529243 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4011946925882124 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41388875165071787 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4011973944647042 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4011946925882124 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4206648005706363 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4012002250019814 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40119469258821244 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42543914499247076 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4012027982176879 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40119469258821244 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4285161963342998 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4012051141118237 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40119469258821244 at iter 0
max_prior_anomaly= 0.45304704764669124 at iter 0
max_prior_star_anomaly= 0.40120665804124767 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4011946925882124
accuracies_anomaly['prior'][-1]= 0.43032066384848083
accuracies_anomaly['prior_star'][-1]= 0.4012062720588916



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 134.76143312454224 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4011946925882124
 first_prior_anomaly_auc= 0.43043761650234114
 first_prior_star_anomaly_auc= 0.4012065293804623


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4010876468148221; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43043375667878137; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.401094337175659 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40105998474597726; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43043491462584926; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 180 
last prior star auc 0.4010620433185425 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40104711866744486; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4304364585552732; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 180 
last prior star auc 0.4010471186674448 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4010339952673417; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4304305401591482; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 310 
last prior star auc 0.4010330946418444 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4011946925882124 at iter 0
0.43043967507490627 at iter 310
0.4012065293804623 at iter 0
last anomaly aucs:
0.4010247316907983
0.43042951087286563
0.4010262756202222




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 105.80261945724487 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40102524633393954,first_prior_anomaly_auc= 0.4304306688199336, first_prior_star_anomaly_auc= 0.40102614695943684


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40102524633393954 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.431561983105295 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40102576097708087 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40102524633393954 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4322525055401334 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4010262756202222 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40102524633393954 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4324876974557072 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40102640428100755 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40102524633393954 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43246247994178355 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40102679026336346 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40102524633393954 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.4318084971699774 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40102872017514335 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40102524633393954 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.43120726532015435 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4010270475849341 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40102524633393954 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.4321946081867372 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4010273049065048 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40102524633393954 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.4318883955176641 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4010274335672901 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40102524633393954 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.43116647985120643 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40102691892414877 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40102524633393954 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.4330306459697781 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4010280768712167 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40102524633393954 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.43445929533002525 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40102884883592865 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40102524633393954 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.43626363418342085 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4010278195496461 iter_best_prior_star_anomaly= 1160
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4010252463339396 at iter 45
max_prior_anomaly= 0.4376578024532009 at iter 129
max_prior_star_anomaly= 0.4010294921398553 at iter 116
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40102524633393954
accuracies_anomaly['prior'][-1]= 0.4376578024532009
accuracies_anomaly['prior_star'][-1]= 0.40102846285357274



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 134.475266456604 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4042076708589496
accuracies_anomaly["prior"][-1]= 0.4789589438287597
accuracies_anomaly["prior_star"][-1]= 0.404208571484447


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 721.941992521286 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004579305648803711 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4022450792396045
 first_prior_anomaly_auc= 0.47624574518782936
 first_prior_star_anomaly_auc= 0.4022448219180338


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5638987357276591; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5905659993803696; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 50 
last prior star auc 0.5639742596086448 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4047009563098852; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5770157027915273; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 50 
last prior star auc 0.4047001843451732 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4052867488654691; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5625863957173456; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 50 
last prior star auc 0.4052857195791866 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40507445856968327; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5511479372588254; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 50 
last prior star auc 0.40507420124811255 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.61413395337539 at iter 160
0.5938800438887671 at iter 50
0.6141895348346502 at iter 160
last anomaly aucs:
0.4039441735706044
0.5444245106001048
0.40388447496621366




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 105.74046874046326 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.403808951085228,first_prior_anomaly_auc= 0.5447720233812672, first_prior_star_anomaly_auc= 0.40380805045973067


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.403808951085228 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5441963950277239 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40380779313816006 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.403808951085228 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5426184991564998 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4038084364420867 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.403808951085228 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5410467790029716 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4038080504597308 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.403808951085228 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5397726512458996 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40380817912051603 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.403808951085228 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5365803198404194 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40380805045973067 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.403808951085228 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5346500220781908 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40380727849501874 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.403808951085228 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5303615007817429 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4038074071558041 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.403808951085228 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5211420548877204 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40380766447737476 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.403808951085228 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5009689443742814 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.403808565102872 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.403808951085228 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47418575735399315 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40380624920873615 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.403808951085228 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44293225134759306 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4038076644773747 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.403808951085228 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4243165796405115 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.403808565102872 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.403808951085228 at iter 0
max_prior_anomaly= 0.5447720233812672 at iter 0
max_prior_star_anomaly= 0.4038095943891546 at iter 57
last values
accuracies_anomaly['vanilla_star'][-1]= 0.403808951085228
accuracies_anomaly['prior'][-1]= 0.40456251730487564
accuracies_anomaly['prior_star'][-1]= 0.4038053485832389



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 134.75463390350342 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.403808951085228
 first_prior_anomaly_auc= 0.4034722458100329
 first_prior_star_anomaly_auc= 0.40380367599302963


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40380766447737476; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4034889717121251; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.40380033081261124 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4038079217989454; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.40350582627500264; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 200 
last prior star auc 0.4038016174204645 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40380547724402427; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.40352924253793176; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 300 
last prior star auc 0.4038007167949672 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40380676385187747; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.403551500853793; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 400 
last prior star auc 0.40380136009889384 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.403813711534285 at iter 10
0.40358057819127635 at iter 490
0.403808565102872 at iter 10
last anomaly aucs:
0.4038092084067987
0.40358057819127635
0.4038059918871655




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 105.75322771072388 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4038056059048096,first_prior_anomaly_auc= 0.4035837947109095, first_prior_star_anomaly_auc= 0.40380174608124975


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4038056059048096 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.396950687923487 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.403803804653815 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4038056059048096 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3936627615545105 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4037999448302552 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4038056059048096 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.39798898046105846 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4037998161694699 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4038056059048096 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40249043535721896 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4037954417027688 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4038056059048096 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40992574214114186 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4037998161694699 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4038056059048096 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4158000076167185 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40379930152632865 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4038056059048096 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41907892773072225 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4037984009008313 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4038056059048096 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.420472581357361 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4037942837557009 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4038056059048096 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42137500810562944 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4037971142929781 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4038056059048096 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4217787456499788 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4037959563459102 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4038056059048096 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4223798488390166 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40379621366748086 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4038056059048096 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42338597618025686 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40379569902433954 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4038056059048096 at iter 0
max_prior_anomaly= 0.42504286977367023 at iter 129
max_prior_star_anomaly= 0.40380419063617096 at iter 9
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4038056059048096
accuracies_anomaly['prior'][-1]= 0.42504286977367023
accuracies_anomaly['prior_star'][-1]= 0.40379248250470634



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 134.36729192733765 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4038056059048096
 first_prior_anomaly_auc= 0.4251975200376307
 first_prior_star_anomaly_auc= 0.4037928684870624


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4038050912616682; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4252327730928097; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4037949270596276 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4038047052793123; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.42525181488903785; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.40379634232826617 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4038036759930297; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4252823074951597; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.4037958276851249 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4038074071558041; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.42533004064651525; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 400 
last prior star auc 0.4037949270596276 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4038110096577932 at iter 210
0.4253602759310666 at iter 490
0.40380200340282046 at iter 210
last anomaly aucs:
0.4038021320636058
0.4253602759310666
0.4037914532184238




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 105.81555128097534 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40380354733224433,first_prior_anomaly_auc= 0.42536284914677314, first_prior_star_anomaly_auc= 0.40379183920077977


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40380354733224433 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42687924516261183 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4037945410772716 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40380354733224433 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42831702943861694 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40379171053999446 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40380354733224433 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4301588085805422 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40378952330664397 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40380354733224433 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4316583500335033 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4037928684870624 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40380354733224433 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43207611160345305 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40379273982627706 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40380354733224433 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43302833007564223 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4037913245576385 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40380354733224433 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4344043571746915 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40379145321842386 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40380354733224433 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4360277989639204 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40378965196742933 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40380354733224433 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4375595056132127 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40378643544779613 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40380354733224433 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4398851779687447 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40378630678701083 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40380354733224433 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4416920900378469 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4037873360732934 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40380354733224433 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.443109674570556 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4037854061615136 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40380354733224433 at iter 0
max_prior_anomaly= 0.4440527581269872 at iter 129
max_prior_star_anomaly= 0.40379621366748086 at iter 13
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40380354733224433
accuracies_anomaly['prior'][-1]= 0.4440527581269872
accuracies_anomaly['prior_star'][-1]= 0.4037851488399429



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 134.6407721042633 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4022450792396045
accuracies_anomaly["prior"][-1]= 0.47624574518782936
accuracies_anomaly["prior_star"][-1]= 0.4022450792396044


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 721.4264998435974 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return
