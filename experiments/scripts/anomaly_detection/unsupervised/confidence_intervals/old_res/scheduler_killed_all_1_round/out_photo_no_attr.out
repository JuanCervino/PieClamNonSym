

/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0024967193603515625 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4666397819382402
 first_prior_anomaly_auc= 0.49416593011311705
 first_prior_star_anomaly_auc= 0.4666421917151451


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5446001509568072; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5357803674846916; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 40 
last prior star auc 0.5445928168531834 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5485310209533245; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5327610217956987; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 130 
last prior star auc 0.5485310209533245 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5386381533481441; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5539466278420175; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 300 
last prior star auc 0.5386670706710035 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5484709860765187; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5526958488554398; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 340 
last prior star auc 0.54850451340737 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5598068909561283 at iter 490
0.5554784077702942 at iter 340
0.5598200923426511 at iter 490
last anomaly aucs:
0.5598068909561283
0.5438185450563322
0.5598200923426511




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 54.70401310920715 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5607341311999893,first_prior_anomaly_auc= 0.5429561592430869, first_prior_star_anomaly_auc= 0.56073214051472


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5607337121083535 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5453592306818662 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5607322452876289 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5607339216541715 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5480335591818157 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5607309880127219 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5607341311999894 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5519662103177847 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5607320357418111 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5607340264270804 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5565598737360721 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5607359123394409 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5607337121083535 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5625704859744698 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5607395793912526 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5607338168812626 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5697126456291047 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5607406271203417 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5607338168812626 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5767294968846823 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5607431416701556 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5607340264270804 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5860777549093442 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5607479612239655 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5607340264270804 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5935981447651474 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5607504757737793 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5607338168812626 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5947998900303547 iter_best_prior_anomaly= 970
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5607504757737793 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5607341311999893 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.600312830951426 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5607523616861397 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5607339216541714 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6041913144934881 iter_best_prior_anomaly= 1160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5607613721563061 iter_best_prior_star_anomaly= 1180
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5607341311999894 at iter 30
max_prior_anomaly= 0.6066891006419227 at iter 116
max_prior_star_anomaly= 0.5607640962519378 at iter 127
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5607339216541715
accuracies_anomaly['prior'][-1]= 0.5894208488868716
accuracies_anomaly['prior_star'][-1]= 0.5607611626104883



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 116.23859691619873 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5607339216541715
 first_prior_anomaly_auc= 0.5879199769667237
 first_prior_star_anomaly_auc= 0.5607609530646704


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5607561335108604; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5879279397078009; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 90 
last prior star auc 0.5607823267380883 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5607758308177357; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5879455415564979; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 200 
last prior star auc 0.5608093581485873 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5608049576864129; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5879500467915811; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 270 
last prior star auc 0.5608361800132684 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5608296840929159; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5879565427119335; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 400 
last prior star auc 0.5608609064197714 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.560854410499419 at iter 490
0.5879661818195534 at iter 480
0.5608921287466269 at iter 490
last anomaly aucs:
0.560854410499419
0.5879656579550088
0.5608921287466269




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.96146273612976 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5608546200452368,first_prior_anomaly_auc= 0.5879683820506405, first_prior_star_anomaly_auc= 0.5608950623880763


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5608548295910545 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5802209493012276 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5608944337506229 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5608548295910546 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5711259273974033 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.560899043758615 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5608548295910546 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5599492773393381 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5608998819418862 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5608547248181457 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5494249434121519 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5609004058064307 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5608546200452368 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5390805045695657 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5608992533044328 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5608546200452368 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5283502918763696 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5608982055753438 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5608548295910546 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5179942232408943 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5608986246669794 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5608548295910546 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5081080611018841 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5608994628502506 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5608548295910546 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.49824557764028776 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5608946432964407 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5608548295910546 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.48973445515782354 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5608939098860783 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5608548295910546 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.48175526473389985 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5608912905633556 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5608548295910546 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4748739896224529 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5608908714717199 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5608548295910546 at iter 2
max_prior_anomaly= 0.5879683820506405 at iter 0
max_prior_star_anomaly= 0.5609015583084287 at iter 38
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5608548295910546
accuracies_anomaly['prior'][-1]= 0.47061193246086835
accuracies_anomaly['prior_star'][-1]= 0.5608841660055496



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 122.6734721660614 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5608548295910546
 first_prior_anomaly_auc= 0.470289127128514
 first_prior_star_anomaly_auc= 0.5608839564597318


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5608870996469991; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.47029279418032593; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 100 
last prior star auc 0.5609088924120526 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5609097305953239; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.47029258463450807; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 170 
last prior star auc 0.5609357142767337 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5609399051930901; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.47029415622814175; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 220 
last prior star auc 0.5609625361414149 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5609626409143238; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4702928989532348; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 350 
last prior star auc 0.5609889389144604 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5609912439184566 at iter 490
0.47029677555086447 at iter 350
0.5610096839504248 at iter 490
last anomaly aucs:
0.5609912439184566
0.47029394668232394
0.5610096839504248




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.96336722373962 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5609943871057238,first_prior_anomaly_auc= 0.4702948896385041, first_prior_star_anomaly_auc= 0.56101303668351


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.560994177559906 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4663441127892937 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5610103125878783 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5609939680140882 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4627050353440931 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5610076932651555 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5609943871057238 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4590679485841618 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5610063312173397 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.560994177559906 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4557818510690818 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5610061216715219 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5609943871057238 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4545788485289674 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5610013021177119 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5609943871057238 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45275936219282154 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5610006734802584 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5609937584682704 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45200656884229706 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5609952252889951 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5609938632411793 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.4492888643580585 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5609841193606505 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5609939680140882 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.4468795065447445 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5609801379901119 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5609939680140882 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.44473239532243436 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5609715466115812 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.560994177559906 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.44406530621139906 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5609647363725021 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5609943871057239 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.4422874147200908 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5609597072728744 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5609943871057239 at iter 73
max_prior_anomaly= 0.4702948896385041 at iter 0
max_prior_star_anomaly= 0.56101303668351 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.560994177559906
accuracies_anomaly['prior'][-1]= 0.44076977913451715
accuracies_anomaly['prior_star'][-1]= 0.5609547829461554



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.00946378707886 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4666398867111491
accuracies_anomaly["prior"][-1]= 0.49416593011311705
accuracies_anomaly["prior_star"][-1]= 0.4666421917151451


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 554.9636404514313 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003847360610961914 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46177706168986965
 first_prior_anomaly_auc= 0.504850461818028
 first_prior_star_anomaly_auc= 0.4617792619209568


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5448425954680269; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5374947665932; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 100 
last prior star auc 0.5448381950058526 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5321204402306177; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5491750600243995; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 200 
last prior star auc 0.5321554343821939 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5333165277587439; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5655539993286152; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 290 
last prior star auc 0.5333783437750015 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5432421892844136; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5601250862804905; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 290 
last prior star auc 0.5432854604957937 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5555973250219081 at iter 490
0.565588260069829 at iter 290
0.5556080118586169 at iter 490
last anomaly aucs:
0.5555973250219081
0.5514021129762086
0.5556080118586169




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.82206869125366 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5570035870053095,first_prior_anomaly_auc= 0.5504264676484307, first_prior_star_anomaly_auc= 0.5570312470532619


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5570035870053095 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5486378893204136 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.557029989778355 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5570035870053095 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.545759148875179 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5570272656827233 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5570035870053095 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5420778479476873 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5570226556747313 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5570035870053095 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5387678622093757 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.557020560216553 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5570035870053095 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5345711833429515 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5570164740731056 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5570035870053095 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5284890112077676 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5570117592922046 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5570035870053095 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5178604282362151 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5570086161049372 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5570035870053095 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.49894734658417267 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5570015963200401 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5570035870053095 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.470318568315918 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5569971958578659 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5570035870053095 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.41452793727706944 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5569880806147907 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5570035870053095 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.3593554664007949 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5569811656028025 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5570035870053095 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.3460210182837108 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5569748792282678 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5570037965511273 at iter 22
max_prior_anomaly= 0.5504264676484307 at iter 0
max_prior_star_anomaly= 0.5570320852365332 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5570035870053095
accuracies_anomaly['prior'][-1]= 0.3429996819094486
accuracies_anomaly['prior_star'][-1]= 0.556965449666466



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.33006381988525 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5570035870053095
 first_prior_anomaly_auc= 0.343593849075882
 first_prior_star_anomaly_auc= 0.5569669164871907


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5570467534437807; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.3436136511556661; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5570048442802165 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5570882435157094; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.3436307291398186; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.55704298161906 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5571263808545529; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.34364791189687993; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5570842621451708 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5571735286635628; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.3436583891877711; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 400 
last prior star auc 0.5571236567589213 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.557203912807147 at iter 490
0.34367389557828987 at iter 490
0.5571607463686757 at iter 490
last anomaly aucs:
0.557203912807147
0.34367389557828987
0.5571607463686757




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.998379945755 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5572091514525925,first_prior_anomaly_auc= 0.34367347648665425, first_prior_star_anomaly_auc= 0.5571649372850322


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5572091514525925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3472615295252153 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5571559268148658 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5572091514525925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3493697699983195 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5571527836275985 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5572091514525925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3509493263730594 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5571479640737886 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5572091514525925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3513850769012197 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5571420967908896 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5572089419067747 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3515495703682097 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5571351817789015 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5572090466796836 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3525340166203361 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5571247044880104 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5572091514525925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3534601043621991 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5571169512927511 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5572091514525925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3548344106083828 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5571077312767668 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5572091514525925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3564822789197326 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5570999780815075 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5572091514525925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3577190183365163 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5570870910137115 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5572091514525925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3588879696812347 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5570765089499115 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5572091514525925 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.36047245038269354 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5570633075633886 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5572091514525925 at iter 0
max_prior_anomaly= 0.3611080028481467 at iter 129
max_prior_star_anomaly= 0.5571649372850322 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5572091514525925
accuracies_anomaly['prior'][-1]= 0.3611080028481467
accuracies_anomaly['prior_star'][-1]= 0.5570509443601372



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.37057614326477 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5572091514525925
 first_prior_anomaly_auc= 0.3611332531191943
 first_prior_star_anomaly_auc= 0.5570490584477767


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.557248546066343; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.3611705522747665; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5570928535237015 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.557291922050632; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.3612085848407012; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5571303622250916 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5573381269034619; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.36124829377317846; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5571683947910262 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5573791978837549; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.3612824497414833; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.5572034937155114 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5574162874935092 at iter 490
0.36131461502451895 at iter 490
0.5572407928710836 at iter 490
last anomaly aucs:
0.5574162874935092
0.36131461502451895
0.5572407928710836




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.95058584213257 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.557417859087143,first_prior_anomaly_auc= 0.3613176534388774, first_prior_star_anomaly_auc= 0.5572451933332578


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.557417859087143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.36179929450114057 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.557233249221642 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.557417859087143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3627691773189283 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5572223528391154 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.557417859087143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.36297243676221536 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5572129232773133 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.557417859087143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3633398753537657 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5572011887115154 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.557417859087143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.36362894380945077 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.55718631095845 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.557417859087143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.36445549728784843 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5571743668468342 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.557417859087143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.36642061796738046 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5571632609184896 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.557417859087143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3650447401275631 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5571527836275985 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.557417859087143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3619883048288157 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5571441922490679 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.557417859087143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.36057208941906777 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5571414681534362 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.557417859087143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.35874945989565454 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5571319338187253 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.557417859087143 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.35566924114658444 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5571192562967471 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.557417859087143 at iter 0
max_prior_anomaly= 0.36642061796738046 at iter 70
max_prior_star_anomaly= 0.5572451933332578 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5574174399955074
accuracies_anomaly['prior'][-1]= 0.3540234682934128
accuracies_anomaly['prior_star'][-1]= 0.5571094076433094



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.07378196716309 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46177685214405184
accuracies_anomaly["prior"][-1]= 0.504850461818028
accuracies_anomaly["prior_star"][-1]= 0.46177926192095686


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 576.7369828224182 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0038127899169921875 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.47105229299702067
 first_prior_anomaly_auc= 0.5041976218226043
 first_prior_star_anomaly_auc= 0.47105187390538505


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5438357278133936; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5376201797651662; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 100 
last prior star auc 0.5438371946341183 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5557073365762644; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5307668790203984; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 110 
last prior star auc 0.5557136229507991 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5534540903972276; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 230 
last prior auc 0.5358944651824955; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 110 
last prior star auc 0.5534584908594019 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.55185986581524; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 230 
last prior auc 0.5435003497319699; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 400 
last prior star auc 0.5518686667395887 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5625301484045391 at iter 490
0.5437507569842669 at iter 420
0.5625305674961747 at iter 490
last anomaly aucs:
0.5625301484045391
0.5405852530873433
0.5625305674961747




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.94097328186035 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.563886538483299,first_prior_anomaly_auc= 0.5398848461912742, first_prior_star_anomaly_auc= 0.5638871671207525


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5638862241645723 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5411664284130718 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5638882148498415 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5638863289374811 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5430214327653384 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5638867480291169 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5638863289374811 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.545348962936793 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5638882148498416 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5638861193916633 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5484955029372037 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5638873766665702 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5638863289374811 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5526100398430418 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5638873766665703 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.563886538483299 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5586606753326435 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5638874814394792 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5638861193916633 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5650206004493501 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5638890530331129 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5638863289374811 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5713427025459398 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5638896816705663 iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5638863289374811 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5770064116829338 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5638972253200079 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.56388643371039 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5787779120267983 iter_best_prior_anomaly= 960
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5639014162363643 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5638863289374811 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5893958081616419 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5639039307861782 iter_best_prior_star_anomaly= 1080
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.563886538483299 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5916437109223243 iter_best_prior_anomaly= 1160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5639070739734455 iter_best_prior_star_anomaly= 1180
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.563886538483299 at iter 0
max_prior_anomaly= 0.5923364693960428 at iter 116
max_prior_star_anomaly= 0.5639127317105267 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5638861193916633
accuracies_anomaly['prior'][-1]= 0.5906808478894335
accuracies_anomaly['prior_star'][-1]= 0.5639127317105267



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.14651656150818 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5638861193916634
 first_prior_anomaly_auc= 0.5905869713630495
 first_prior_star_anomaly_auc= 0.5639125221647089


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5639263521886851; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5905978677455762; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.563948773591192 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5639584126988118; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5906198700564473; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 200 
last prior star auc 0.5639854441093108 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5639919400296634; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5906334905346058; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 300 
last prior star auc 0.5640177141652554 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5640353160139524; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5906423962318633; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 400 
last prior star auc 0.5640537560459208 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5640677956157149 at iter 490
0.5906675417300019 at iter 490
0.5640929411138533 at iter 490
last anomaly aucs:
0.5640677956157149
0.5906675417300019
0.5640929411138533




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.0059266090393 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5640734533527959,first_prior_anomaly_auc= 0.5906700562798157, first_prior_star_anomaly_auc= 0.5640952461178494


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5640734533527959 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.588195844035886 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641044661338335 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.564073453352796 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5847107827667843 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641055138629227 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5640734533527959 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5840032513129093 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641097047792791 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5640734533527959 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5835468605216936 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641124288749108 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5640734533527959 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5804630794937206 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641151529705424 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5640734533527959 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5772452939152505 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641201820701702 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5640734533527959 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5764451432098983 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641260493530692 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5640734533527959 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5771689144646545 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641304498152434 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5640734533527959 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5778528720140245 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641386221021385 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5640734533527959 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5788833135731627 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641511948512078 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.564073453352796 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5810334632098312 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641581098631959 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5640734533527959 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.583227931786969 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641700539748118 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.564073453352796 at iter 12
max_prior_anomaly= 0.5906700562798157 at iter 0
max_prior_star_anomaly= 0.5641790644449781 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5640734533527959
accuracies_anomaly['prior'][-1]= 0.58517293606799
accuracies_anomaly['prior_star'][-1]= 0.5641790644449781



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 122.98763608932495 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5640734533527959
 first_prior_anomaly_auc= 0.5853207706424634
 first_prior_star_anomaly_auc= 0.5641805312657029


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5641138956956355; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5853370104433445; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5642194020149087 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.564152242580297; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5853469638696911; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 200 
last prior star auc 0.5642545009393939 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5641916371940474; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.585355240929495; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 290 
last prior star auc 0.5642918000949662 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5642247454332632; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5853701186825603; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 390 
last prior star auc 0.5643280515214493 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5642593204932038 at iter 490
0.5853841582523543 at iter 480
0.5643592738483048 at iter 490
last anomaly aucs:
0.5642593204932038
0.5853841582523543
0.5643592738483048




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.11671566963196 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5642635114095602,first_prior_anomaly_auc= 0.5853845773439901, first_prior_star_anomaly_auc= 0.5643617883981186


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5642636161824691 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5874487084224427 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5643676556810177 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5642634066366514 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5894512330304558 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5643819047966295 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5642633018637424 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5920163881593201 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.564395525274788 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5642633018637424 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5936646755623057 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5644124984860315 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5642633018637424 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5952991329413151 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5644256998725543 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.564263720955378 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.597150260695952 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5644443494503404 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5642634066366513 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5989215514939988 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5644626847093998 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5642635114095602 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6003674176369685 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5644860490680869 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5642635114095602 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6005480461319308 iter_best_prior_anomaly= 860
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5645057463749621 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5642634066366514 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5998956252281431 iter_best_prior_anomaly= 860
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5645291107336492 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5642633018637424 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6008265325238159 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5645558278254215 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5642636161824692 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6018011301225047 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5645886217459106 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.564263825728287 at iter 1
max_prior_anomaly= 0.602743248119431 at iter 129
max_prior_star_anomaly= 0.5646080047340591 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5642635114095602
accuracies_anomaly['prior'][-1]= 0.602743248119431
accuracies_anomaly['prior_star'][-1]= 0.5646080047340591



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 122.86813187599182 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4710522929970207
accuracies_anomaly["prior"][-1]= 0.5041976218226043
accuracies_anomaly["prior_star"][-1]= 0.47105187390538505


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 576.2578790187836 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003607034683227539 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46887877900166497
 first_prior_anomaly_auc= 0.5134766249544762
 first_prior_star_anomaly_auc= 0.4688793028662096


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5435729573578452; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5364803552891251; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 100 
last prior star auc 0.5435764148638391 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5605291953901597; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5250549743453055; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 130 
last prior star auc 0.5605105458123735 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5605130603621873; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5320051900308157; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 130 
last prior star auc 0.560495877605126 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.564038249655402; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5363388070891865; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 130 
last prior star auc 0.5640168759819841 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.565233394227348 at iter 490
0.5385106447179995 at iter 490
0.5652121253268391 at iter 490
last anomaly aucs:
0.565233394227348
0.5385106447179995
0.5652121253268391




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.77210021018982 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5651301929120709,first_prior_anomaly_auc= 0.5387758249504528, first_prior_star_anomaly_auc= 0.565128726091346


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5651301929120708 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5357354199067689 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5651268401789857 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5651300881391619 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.5316707549055724 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5651291451829817 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5651300881391619 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5280960080264431 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5651293547287995 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.565129983366253 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.524403391624789 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5651297738204352 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5651304024578887 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5204453854448636 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5651280974538926 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.565129983366253 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5157842482732377 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5651268401789857 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5651301929120709 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.509225883267054 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5651227540355381 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5651301929120709 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.49757283079217124 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5651229635813559 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5651301929120708 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.47554076441476156 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5651213919877223 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5651301929120709 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.44741709634036614 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.565119401302453 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5651300881391619 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.4076468717114403 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5651175153900926 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5651300881391619 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.3883182607026574 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5651165724339124 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5651304024578887 at iter 25
max_prior_anomaly= 0.5387758249504528 at iter 0
max_prior_star_anomaly= 0.5651300881391619 at iter 27
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5651301929120708
accuracies_anomaly['prior'][-1]= 0.391365056893785
accuracies_anomaly['prior_star'][-1]= 0.5651163628880945



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.36597347259521 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5651300881391619
 first_prior_anomaly_auc= 0.3920975242999808
 first_prior_star_anomaly_auc= 0.5651167819797303


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5651310310953421; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.392059596506955; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5651151056131876 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5651263163144411; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.3920218782597471; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.565111124242649 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5651209728960866; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.39199715185324413; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5651060951430213 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5651138483382807; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.3919725302196502; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5651006469517579 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5651313454140688 at iter 90
0.3920975242999808 at iter 0
0.5651167819797303 at iter 0
last anomaly aucs:
0.5651096574219243
0.3919443463071531
0.5650926842106807




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.92146253585815 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5651086096928352,first_prior_anomaly_auc= 0.3919410983469768, first_prior_star_anomaly_auc= 0.5650922651190451


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.565108819238653 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.39301973544421404 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5650874455652352 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5651086096928353 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.38992453416916967 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.565080530553247 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5651088192386531 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.3887725560356949 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.565075920545255 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5651088192386531 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.3876137676631408 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5650696341707204 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5651087144657441 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.38711599157290544 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5650681673499957 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5651086096928352 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.385714339597496 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5650631382503679 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5651090287844708 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.3845489505316806 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5650591568798293 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5651088192386531 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.3846950039667023 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5650581091507402 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5651086096928352 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.3851224774350587 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5650555946009264 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5651086096928353 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.3857616969523237 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5650518227762055 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5651086096928353 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.3863393099991492 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5650465841307599 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5651086096928352 iter_best_vanilla_star_anomaly= 340 
last prior auc 0.38714826162884997 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5650443838996728 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5651090287844709 at iter 128
max_prior_anomaly= 0.39311214514987347 at iter 6
max_prior_star_anomaly= 0.5650922651190451 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5651086096928353
accuracies_anomaly['prior'][-1]= 0.38742035687329135
accuracies_anomaly['prior_star'][-1]= 0.5650427075331302



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 122.92676401138306 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5651086096928352
 first_prior_anomaly_auc= 0.3874069459409508
 first_prior_star_anomaly_auc= 0.5650423932144035


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5651043140035699; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.38739164909624985; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5650346400191442 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5650979228561263; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.38737205656228346; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5650258390947955 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5650880742026887; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3873484826577786; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5650193431744431 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5650819973739718; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.38732428011582015; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5650151522580866 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5651086096928352 at iter 0
0.3874069459409508 at iter 0
0.5650423932144035 at iter 0
last anomaly aucs:
0.5650764444097995
0.38730751645039446
0.5650061417879204




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.91633987426758 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5650778064576154,first_prior_anomaly_auc= 0.38730793554203, first_prior_star_anomaly_auc= 0.5650050940588311


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5650778064576154 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.3869017309741827 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5650041511026511 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5650778064576154 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.38688894867929563 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5650032081464709 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5650778064576154 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.3870801592380579 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5649969217719363 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5650778064576154 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.38748353493736465 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5649862349352273 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5650780160034332 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.38795427961710116 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5649866540268629 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5650779112305243 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.38799849378466156 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5649841394770491 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5650778064576154 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.38642428082827596 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5649772244650609 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5650778064576154 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.3850433738888309 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5649740812777937 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5650778064576154 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.3838964248549838 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.564977224465061 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5650778064576154 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.3844256328178925 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5649758624172451 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5650778064576154 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.3867529534435292 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5649747099152471 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5650778064576154 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.3879909501352199 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5649759671901541 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5650781207763422 at iter 126
max_prior_anomaly= 0.39220240198180056 at iter 129
max_prior_star_anomaly= 0.565006456106647 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5650779112305244
accuracies_anomaly['prior'][-1]= 0.39220240198180056
accuracies_anomaly['prior_star'][-1]= 0.5649815201543262



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 122.90970087051392 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4688787790016651
accuracies_anomaly["prior"][-1]= 0.5134766249544762
accuracies_anomaly["prior_star"][-1]= 0.4688793028662096


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 576.0044980049133 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0038170814514160156 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4622483302341507
 first_prior_anomaly_auc= 0.4974356830544069
 first_prior_star_anomaly_auc= 0.46225189251305365


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5427051233533365; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5352679231872087; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 70 
last prior star auc 0.5427132956402316 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5489962126688887; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5367339057286893; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 200 
last prior star auc 0.5490082615534134 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5477942578578634; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5498884587611735; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 300 
last prior star auc 0.5477994965033091 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5582051227246991; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5469838394074379; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 320 
last prior star auc 0.558212352055414 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5683419016618241 at iter 490
0.5504429169951297 at iter 320
0.5683377107454677 at iter 490
last anomaly aucs:
0.5683419016618241
0.5391973263630012
0.5683377107454677




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.97283482551575 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5690719592911149,first_prior_anomaly_auc= 0.5384543816659144, first_prior_star_anomaly_auc= 0.5690725879285683


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5690719592911149 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5404100727836444 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5690748929325644 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5690719592911149 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5422637150880951 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5690753120242 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5690719592911149 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5447035618179021 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5690746833867465 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5690717497452971 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.547668844685897 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5690749977054733 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5690717497452971 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5507666652836642 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5690767788449247 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.569071854518206 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5543214005371916 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5690807602154634 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5690719592911149 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5554935998420862 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5690795029405564 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5690718545182061 iter_best_vanilla_star_anomaly= 770 
last prior auc 0.549853778928324 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.569077617028196 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5690719592911149 iter_best_vanilla_star_anomaly= 770 
last prior auc 0.5392348350643913 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5690779313469227 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5690717497452971 iter_best_vanilla_star_anomaly= 770 
last prior auc 0.5348901120776761 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5690780361198318 iter_best_prior_star_anomaly= 610
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.569071854518206 iter_best_vanilla_star_anomaly= 770 
last prior auc 0.5440226426828905 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5690822270361882 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5690719592911149 iter_best_vanilla_star_anomaly= 770 
last prior auc 0.5389943812384409 iter_best_prior_anomaly= 660
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.569087046589998 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5690721688369327 at iter 77
max_prior_anomaly= 0.5558407124893079 at iter 66
max_prior_star_anomaly= 0.5690886181836317 at iter 122
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5690719592911149
accuracies_anomaly['prior'][-1]= 0.5330106956376334
accuracies_anomaly['prior_star'][-1]= 0.5690868370441802



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 122.8665943145752 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5690719592911149
 first_prior_anomaly_auc= 0.5320990665571999
 first_prior_star_anomaly_auc= 0.5690872561358158


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.569095428422711; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5320809408439583; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5691073725343267 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5691108300403207; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5320685776407068; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5691243457455704 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.569127069841202; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5320587289872694; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5691381757695465 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5691473957855308; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5320411271385722; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5691538917058832 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5691668835465882 at iter 490
0.5320990665571999 at iter 0
0.5691702362796733 at iter 490
last anomaly aucs:
0.5691668835465882
0.5320293925727742
0.5691702362796733




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.00312066078186 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5691679312756772,first_prior_anomaly_auc= 0.5320278209791405, first_prior_star_anomaly_auc= 0.5691740081043941


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.569168140821495 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5263725984477684 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5691772560645703 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5691677217298594 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5222927413747798 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.569178722885295 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5691679312756772 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5187845252928089 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5691806087976554 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5691677217298594 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5171062728378748 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5691859522160099 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.569168140821495 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5167780193142572 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5691900383594574 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5691679312756772 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.51728470110175 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.569191819498909 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5691679312756772 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5187355963443475 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5692018776981643 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5691677217298594 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5209524863239922 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5692113072599663 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5691679312756772 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5232402027900607 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5692144504472336 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5691679312756772 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.525808920197828 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5692242991006713 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5691679312756772 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5281308974051103 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5692301663835703 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5691677217298594 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5305163669951926 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5692425295868218 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.569168140821495 at iter 3
max_prior_anomaly= 0.5323347008293404 at iter 129
max_prior_star_anomaly= 0.5692481873239029 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.569168140821495
accuracies_anomaly['prior'][-1]= 0.5323347008293404
accuracies_anomaly['prior_star'][-1]= 0.5692481873239029



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.28737592697144 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5691677217298594
 first_prior_anomaly_auc= 0.5324942699696117
 first_prior_star_anomaly_auc= 0.5692481873239029


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5691861617618277; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.532478554033275; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5692676750849603 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5692031349730713; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5324603235471246; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.569283391021297 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5692245086464891; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5324412548777028; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5693047646947148 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5692419009493683; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5324216623437364; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5693267670055862 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5692641128060574 at iter 490
0.5324942699696117 at iter 0
0.5693431115793761 at iter 490
last anomaly aucs:
0.5692641128060574
0.5324087752759404
0.5693431115793761




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.92958307266235 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5692653700809643,first_prior_anomaly_auc= 0.5324075180010335, first_prior_star_anomaly_auc= 0.5693439497626475


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5692653700809643 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5341390998666031 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5693561034200811 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5692653700809643 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5355318461447551 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.569369095260786 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5692653700809643 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5370537774195941 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5693795725516771 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5692655796267821 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5387087702887499 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5693980125836454 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5692653700809643 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5412219580547946 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.569417500344703 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5692653700809643 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5429062873384454 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5694359403766712 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5692653700809643 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5440110128900014 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5694543804086395 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5692653700809643 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.545199766314504 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5694782686318711 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5692655796267821 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5466274019713233 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5694923082016652 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5692655796267821 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5482454100036336 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5695061382256414 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5692653700809643 iter_best_vanilla_star_anomaly= 1060 
last prior auc 0.5495187151656271 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.569517348926895 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5692653700809643 iter_best_vanilla_star_anomaly= 1060 
last prior auc 0.5509833356592919 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.569534846002683 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5692657891726 at iter 106
max_prior_anomaly= 0.5522903776979549 at iter 129
max_prior_star_anomaly= 0.5695453232935741 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5692653700809643
accuracies_anomaly['prior'][-1]= 0.5522903776979549
accuracies_anomaly['prior_star'][-1]= 0.5695444851103028



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.44687581062317 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4622482254612418
accuracies_anomaly["prior"][-1]= 0.4974356830544069
accuracies_anomaly["prior_star"][-1]= 0.46225189251305365


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 576.7006702423096 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003835916519165039 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46905710249263133
 first_prior_anomaly_auc= 0.5082820889035851
 first_prior_star_anomaly_auc= 0.4690569977197224


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.545137426433702; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5388095618271221; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 100 
last prior star auc 0.5451335498360723 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5367884924142319; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5500243492240309; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 200 
last prior star auc 0.536811856772919 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5365831375127665; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5598822226776352; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 290 
last prior star auc 0.5366231607639705 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5482415334060038; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5529020419401763; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 290 
last prior star auc 0.5482600782108811 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5594293941653224 at iter 490
0.559964574184039 at iter 290
0.5594450053287502 at iter 490
last anomaly aucs:
0.5594293941653224
0.543629639501566
0.5594450053287502




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.76527214050293 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.560384189684227,first_prior_anomaly_auc= 0.5427506995687128, first_prior_star_anomaly_auc= 0.5603923619711221


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.560384189684227 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5420003159950932 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5603937240189379 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5603843992300448 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5396314005246189 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5603940383376647 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.560384189684227 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5369134864945625 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5603875424173121 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5603841896842271 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5339416029333062 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5603839801384092 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.560384189684227 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5301466233996461 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5603860755965874 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5603843992300448 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5213929516330534 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5603860755965875 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5603842944571359 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5064528586869105 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5603831419551379 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.560384189684227 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.49088653806420735 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5603808369511418 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.560384189684227 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4692317589317857 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5603808369511418 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.560384189684227 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.43623007376431877 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5603797892220528 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5603843992300448 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.3992030134364969 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5603745505766072 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.560384294457136 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.3958783594909378 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5603743410307893 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5603843992300449 at iter 12
max_prior_anomaly= 0.5427506995687128 at iter 0
max_prior_star_anomaly= 0.5603950860667538 at iter 19
last values
accuracies_anomaly['vanilla_star'][-1]= 0.560384294457136
accuracies_anomaly['prior'][-1]= 0.3939046474328751
accuracies_anomaly['prior_star'][-1]= 0.5603705692060685



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.63537931442261 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.560384189684227
 first_prior_anomaly_auc= 0.39407584636603554
 first_prior_star_anomaly_auc= 0.560370045341524


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.560413526098722; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.39408045637402755; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 90 
last prior star auc 0.5603938287918468 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5604376238677715; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.39409229571273446; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 200 
last prior star auc 0.5604231652063418 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5604644457324528; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.39410591619089286; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 300 
last prior star auc 0.5604508252542943 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5604906389596804; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.3941093736968869; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 390 
last prior star auc 0.5604726180193478 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.560512222178916 at iter 490
0.3941217369001384 at iter 490
0.560492315326223 at iter 490
last anomaly aucs:
0.560512222178916
0.3941217369001384
0.560492315326223




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.93078279495239 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5605138985454587,first_prior_anomaly_auc= 0.39412467054158795, first_prior_star_anomaly_auc= 0.5604943060114923


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5605135842267319 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.39652648470546026 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5604937821469478 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5605136889996408 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3978859131985786 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.560493363055312 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5605138985454587 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.3996289153112196 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.560491267597134 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5605137937725497 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4008211262417161 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5604876005453221 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5605137937725497 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.40141581727269415 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5604851907684171 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5605138985454587 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4021917654360879 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.560481838035332 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5605138985454587 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.403365745880434 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5604774375731577 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5605138985454587 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.40455837590256616 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5604763898440686 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5605137937725497 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.40519130904529665 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5604765993898864 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5605138985454586 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4058405867618172 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5604694748320804 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5605136889996408 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.40655147094877736 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5604630836846369 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5605137937725497 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.40639116839814377 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5604560638997398 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5605141080912766 at iter 22
max_prior_anomaly= 0.40655147094877736 at iter 110
max_prior_star_anomaly= 0.5604950394218546 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5605138985454587
accuracies_anomaly['prior'][-1]= 0.4059446262603657
accuracies_anomaly['prior_star'][-1]= 0.56045124434593



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 122.92416477203369 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5605137937725497
 first_prior_anomaly_auc= 0.4059186425789558
 first_prior_star_anomaly_auc= 0.5604506157084765


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5605407204101398; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4059409592085538; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5604755516607973 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5605618845377398; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4059612851528825; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5605019544338428 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5605878682191496; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.405983077917936; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.5605281476610705 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5606113373507458; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4060008893124508; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 400 
last prior star auc 0.5605551790715695 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5606384735341536 at iter 490
0.40601995798187257 at iter 490
0.5605816866175239 at iter 490
last anomaly aucs:
0.5606384735341536
0.40601995798187257
0.5605816866175239




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.93944454193115 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5606392069445161,first_prior_anomaly_auc= 0.40602121525677953, first_prior_star_anomaly_auc= 0.5605849345777002


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5606392069445161 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.40490213581670276 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5605773909282585 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5606392069445161 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4052070249816333 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5605658659082784 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5606394164903339 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4057987823711618 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5605637704501003 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5606392069445161 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.40592639577421524 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5605539217966626 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5606392069445161 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4073936355906028 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5605478449679457 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5606392069445161 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4094364977685466 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5605438635974072 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5606393117174249 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.410728766827053 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5605407204101398 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5606392069445161 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.41034865071352444 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5605455399639497 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5606392069445161 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4108878121027797 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.560553502705027 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5606392069445161 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4124160297521534 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5605582174859279 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5606392069445161 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.41148606541266064 iter_best_prior_anomaly= 1010
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5605719427369953 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5606392069445161 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.40959124735500785 iter_best_prior_anomaly= 1010
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5605755050158983 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5606394164903339 at iter 17
max_prior_anomaly= 0.412465901656795 at iter 101
max_prior_star_anomaly= 0.5605866109442428 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5606392069445161
accuracies_anomaly['prior'][-1]= 0.408731899956121
accuracies_anomaly['prior_star'][-1]= 0.5605866109442428



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 122.95270156860352 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46905710249263133
accuracies_anomaly["prior"][-1]= 0.5082820889035851
accuracies_anomaly["prior_star"][-1]= 0.46905710249263133


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 576.3404865264893 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003765106201171875 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4632188416893919
 first_prior_anomaly_auc= 0.4877725824384679
 first_prior_star_anomaly_auc= 0.46321852737066516


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5437359840041105; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5385157785905361; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5437343076375679 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5362848490410973; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5479054219142179; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 200 
last prior star auc 0.5363128234077765 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5410506543487252; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5582919794661863; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 290 
last prior star auc 0.5410730757512322 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5549129483809023; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5512890630074938; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 290 
last prior star auc 0.5549218540781597 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5665542662899871 at iter 490
0.5583119910917882 at iter 290
0.5665305876125732 at iter 490
last anomaly aucs:
0.5665542662899871
0.5430585223750929
0.5665305876125732




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.97354650497437 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5675043470279908,first_prior_anomaly_auc= 0.5423205020047248, first_prior_star_anomaly_auc= 0.5675103190837987


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5675043470279907 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5444317808921875 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.567511052494161 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5675043470279907 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5468603121478322 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5675116811316145 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5675043470279907 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.550377957791605 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5675097952192542 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5675043470279907 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.554506743813055 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.567511052494161 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5675043470279907 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5590524212390612 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5675093761276184 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5675043470279908 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5632762362888933 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5675079093068938 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5675043470279907 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5657741272102369 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5675104238567076 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5675043470279907 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5624512544041291 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5675083283985294 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5675043470279907 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5550621450031914 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5675125193148858 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5675043470279907 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5577139473277251 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5675135670439748 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5675043470279907 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5609758423008466 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5675179675061491 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5675042422550818 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5626859457200896 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5675211106934165 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5675043470279908 at iter 0
max_prior_anomaly= 0.5662246507185535 at iter 129
max_prior_star_anomaly= 0.5675300163906739 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5675043470279907
accuracies_anomaly['prior'][-1]= 0.5662246507185535
accuracies_anomaly['prior_star'][-1]= 0.567529911617765



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.08821988105774 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5675043470279908
 first_prior_anomaly_auc= 0.5665617051665197
 first_prior_star_anomaly_auc= 0.567530959346854


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5675315879843075; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5665580381147078; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5675540093868144 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5675667916817017; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5665499706007218; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.5675865937614857 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5675899464945708; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5665401219472841; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.5676128917616223 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5676143585823471; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5665321592062069; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.5676353131641293 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.567635732255765 at iter 490
0.566563800624698 at iter 10
0.5676560582000937 at iter 490
last anomaly aucs:
0.567635732255765
0.5665326830707514
0.5676560582000937




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.90795350074768 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5676357322557649,first_prior_anomaly_auc= 0.5665339403456584, first_prior_star_anomaly_auc= 0.5676594109331787


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5676357322557649 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5673436253857215 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.567666116399349 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5676355227099471 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5684498177580022 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5676700977698877 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5676357322557649 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5699425173912551 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5676736600487906 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5676355227099471 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5727520029436997 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.567677955738056 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.567635627482856 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5761537697502171 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5676871757540402 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.567635627482856 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.5779275750980779 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5676916809891233 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5676359418015827 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.577436085382377 iter_best_prior_anomaly= 620
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5676929382640303 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5676355227099471 iter_best_vanilla_star_anomaly= 720 
last prior auc 0.5763786124127398 iter_best_prior_anomaly= 620
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5676975482720223 iter_best_prior_star_anomaly= 780
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5676358370286738 iter_best_vanilla_star_anomaly= 720 
last prior auc 0.5759878094625024 iter_best_prior_anomaly= 620
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5677044632840105 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5676357322557649 iter_best_vanilla_star_anomaly= 720 
last prior auc 0.5751080313463779 iter_best_prior_anomaly= 620
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5677057205589173 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5676358370286738 iter_best_vanilla_star_anomaly= 720 
last prior auc 0.5724933186315988 iter_best_prior_anomaly= 620
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5677159883039906 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5676357322557649 iter_best_vanilla_star_anomaly= 720 
last prior auc 0.5701930294164611 iter_best_prior_anomaly= 620
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5677249987741569 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5676359418015828 at iter 72
max_prior_anomaly= 0.5779617310663828 at iter 62
max_prior_star_anomaly= 0.5677375715232262 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5676355227099471
accuracies_anomaly['prior'][-1]= 0.5676363608932185
accuracies_anomaly['prior_star'][-1]= 0.5677375715232262



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.24430632591248 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5676357322557649
 first_prior_anomaly_auc= 0.5673574554096977
 first_prior_star_anomaly_auc= 0.567737781069044


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5676594109331787; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5673722283898541; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.5677562211010123 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5676822514273214; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5673878395532819; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 200 
last prior star auc 0.567782623874058 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5677105401127273; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5673992598003531; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.567804835730747 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5677302374196025; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5674032411708917; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 380 
last prior star auc 0.5678320766870638 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5677558020093767 at iter 490
0.5674119373223314 at iter 490
0.5678551267270242 at iter 490
last anomaly aucs:
0.5677558020093767
0.5674119373223314
0.5678551267270242




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.94609379768372 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5677581070133728,first_prior_anomaly_auc= 0.5674129850514205, first_prior_star_anomaly_auc= 0.5678574317310203


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5677581070133728 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5647727077468669 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5678651849262797 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5677581070133728 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5616166334117454 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5678731476673569 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5677581070133728 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5600967975950846 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5678846726873371 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5677581070133728 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5606166807691002 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5678972454364064 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5677581070133728 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5613665404781751 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5679149520580123 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5677581070133728 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5613052483264623 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5679355923210678 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.567757897467555 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.560515784457819 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5679570707673945 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.567757897467555 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5598886138250787 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5679749869348183 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5677580022404639 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5596119085726452 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5679988751580499 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.567757897467555 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5593371940054809 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5680196201940143 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.567757897467555 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5607797074153655 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5680378506801648 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.567757897467555 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5634977262183308 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5680653011822995 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5677581070133728 at iter 0
max_prior_anomaly= 0.5674129850514205 at iter 0
max_prior_star_anomaly= 0.5680814362102717 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5677581070133728
accuracies_anomaly['prior'][-1]= 0.5650541277802015
accuracies_anomaly['prior_star'][-1]= 0.5680814362102717



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.21169710159302 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4632188416893919
accuracies_anomaly["prior"][-1]= 0.4877725824384679
accuracies_anomaly["prior_star"][-1]= 0.46321852737066516


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 576.565179347992 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0037038326263427734 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4689369279661106
 first_prior_anomaly_auc= 0.5032188333075591
 first_prior_star_anomaly_auc= 0.46893975683465117


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5425294191850931; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.538947233429431; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.5425267998623703 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5594528632969185; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5291203727568644; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 120 
last prior star auc 0.5594483580618353 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5539318548618611; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5430237377693344; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 300 
last prior star auc 0.5539312262244076 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5646981094357224; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5406975696456957; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 330 
last prior star auc 0.5646907753320987 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5767643862633497 at iter 490
0.5438590921720807 at iter 330
0.5767446889564745 at iter 490
last anomaly aucs:
0.5767643862633497
0.5324274248537265
0.5767446889564745




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.9015371799469 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5777427556867593,first_prior_anomaly_auc= 0.5315487992396002, first_prior_star_anomaly_auc= 0.5777285065711473


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5777425461409413 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5322266799602533 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5777288208898741 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5777426509138502 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5324373782800731 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5777279827066027 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5777427556867591 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5318724427552258 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5777282970253295 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5777427556867593 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5302002671290086 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5777314402125968 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5777425461409413 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.5284038308328232 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.577732383168777 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5777427556867591 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.5263266031407565 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5777285065711473 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5777425461409413 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.5245413775458245 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5777270397504226 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5777427556867591 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.5216011354030593 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5777278779336938 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5777427556867591 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.5175824657088747 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5777272492962403 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5777427556867591 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.5089643700864125 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.577728925662783 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5777426509138502 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.5057251060616157 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.577732383168777 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5777427556867591 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.5114814344500869 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5777352120373176 iter_best_prior_star_anomaly= 1140
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.577742965232577 at iter 41
max_prior_anomaly= 0.5325060045354096 at iter 18
max_prior_star_anomaly= 0.5777439081887572 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5777427556867591
accuracies_anomaly['prior'][-1]= 0.5150064141974835
accuracies_anomaly['prior_star'][-1]= 0.5777439081887572



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.1110007762909 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5777426509138504
 first_prior_anomaly_auc= 0.5147876483636777
 first_prior_star_anomaly_auc= 0.5777446415991196


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5777731398303434; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5147927822362143; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 40 
last prior star auc 0.5777716730096186 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5778061432966501; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5148035738458321; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 180 
last prior star auc 0.5778006951053869 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5778280408346126; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5148110127223647; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 270 
last prior star auc 0.5778272026513414 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5778580058865612; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5148247379734321; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 400 
last prior star auc 0.5778571677032898 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5778919523090482 at iter 490
0.5148339579894162 at iter 490
0.5778831513846997 at iter 490
last anomaly aucs:
0.5778919523090482
0.5148339579894162
0.5778831513846997




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.86122679710388 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5778954098150424,first_prior_anomaly_auc= 0.5148333293519628, first_prior_star_anomaly_auc= 0.5778852468428779


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5778953050421334 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5165815701100492 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5778871327552383 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5778954098150423 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.518036761041912 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5778898568508699 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5778953050421334 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5239671172320841 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5778923714006838 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5778953050421334 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5313106504176457 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.577894466858862 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5778953050421334 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5401561032524445 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5778978195919473 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5778953050421334 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5489740008121996 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5779013818708502 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5778954098150424 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.5548437982610211 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5779078777912027 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5778953050421334 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.5604124783696329 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5779095541577453 iter_best_prior_star_anomaly= 780
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5778953050421334 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.5653673987778449 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5779156309864621 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5778953050421334 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.5698136467132948 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5779185646279116 iter_best_prior_star_anomaly= 970
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5778953050421334 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.5730000004190916 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5779267369148067 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5778953050421334 iter_best_vanilla_star_anomaly= 630 
last prior auc 0.5750676937764473 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.577933442380977 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5778955145879512 at iter 63
max_prior_anomaly= 0.5768026283751021 at iter 129
max_prior_star_anomaly= 0.5779378428431512 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5778953050421334
accuracies_anomaly['prior'][-1]= 0.5768026283751021
accuracies_anomaly['prior_star'][-1]= 0.5779370046598798



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.33242201805115 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5778954098150424
 first_prior_anomaly_auc= 0.5769850380095158
 first_prior_star_anomaly_auc= 0.5779364807953353


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5779177264446402; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5770010682645792; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 90 
last prior star auc 0.5779606833372938 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5779447578551393; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5770107073721991; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 200 
last prior star auc 0.577989810205971 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5779642456161966; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5770287283125317; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 300 
last prior star auc 0.5780166320706521 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5779916961183313; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.577040043786694; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 400 
last prior star auc 0.5780432443895156 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5780136984292026 at iter 490
0.5770506258504942 at iter 490
0.5780654562462045 at iter 490
last anomaly aucs:
0.5780136984292026
0.5770506258504942
0.5780654562462045




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 68.91894006729126 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5780153747957453,first_prior_anomaly_auc= 0.577050730623403, first_prior_star_anomaly_auc= 0.5780677612502007


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5780153747957453 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.578766701325545 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5780763526287314 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5780153747957453 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5805252098287047 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.578081381728359 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5780153747957453 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5824211803883554 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5780895540152541 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5780153747957452 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5845973137064339 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5780991931228739 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5780153747957452 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5869052513439221 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5781096704137649 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5780153747957453 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5881116066171216 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5781297868122759 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5780153747957453 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.588788230062868 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.578142569107163 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5780153747957452 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5894884274131191 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5781597518642244 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5780153747957452 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5904757025337861 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5781767250754679 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5780152700228363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5928763641956605 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5781974701114323 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5780153747957452 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5935747804064603 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5782188437848501 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5780153747957453 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.59447519878564 iter_best_prior_anomaly= 1170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5782349788128225 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5780153747957453 at iter 0
max_prior_anomaly= 0.5949068631703528 at iter 125
max_prior_star_anomaly= 0.578250694749159 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5780152700228363
accuracies_anomaly['prior'][-1]= 0.5945578646107708
accuracies_anomaly['prior_star'][-1]= 0.578250694749159



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.394602060318 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.46893692796611064
accuracies_anomaly["prior"][-1]= 0.5032188333075591
accuracies_anomaly["prior_star"][-1]= 0.4689396520617422


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 576.7125837802887 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0038077831268310547 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4625653730565149
 first_prior_anomaly_auc= 0.4930037890074778
 first_prior_star_anomaly_auc= 0.4625627537337922


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5435348200190016; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5362736383398439; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5435138654372195 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5276053564940135; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5574896285297469; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5276183483347184 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5286905942845121; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5693706668544196; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 290 
last prior star auc 0.5287353323166171 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5343665618518486; count_not_improved_vanilla_star_anomaly= 31 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5654823346589202; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 290 
last prior star auc 0.5343923359874407 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5443258554812785 at iter 90
0.5693906784800217 at iter 290
0.5443234457043735 at iter 90
last anomaly aucs:
0.5333144323005659
0.5638048156143486
0.5333573891932193




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.92748951911926 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5328435828479204,first_prior_anomaly_auc= 0.5639264569615939, first_prior_star_anomaly_auc= 0.5328832917803976


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5328435828479204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5680052663054935 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328844442823957 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5328435828479204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5728362403624639 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328822440513086 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5328435828479204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5787004848471133 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328838156449422 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5328433733021026 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5860790121842512 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328846538282135 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5328435828479204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5951011121434735 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.532881824959673 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5328435828479204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6066899388251938 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328811963222194 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5328435828479204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.619864713029098 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328806724576749 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5328435828479204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6327998715903229 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328783674536789 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5328434780750115 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6365139664383036 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328779483620432 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5328435828479204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6425802130913331 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328804629118571 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5328435828479204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6468997905799097 iter_best_prior_anomaly= 1090
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328806724576749 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5328435828479204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6297993850249339 iter_best_prior_anomaly= 1090
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328858063302115 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5328435828479204 at iter 0
max_prior_anomaly= 0.6473685445743768 at iter 109
max_prior_star_anomaly= 0.5328905211111125 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5328435828479204
accuracies_anomaly['prior'][-1]= 0.6227989831160553
accuracies_anomaly['prior_star'][-1]= 0.5328903115652946



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.90197968482971 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5328435828479204
 first_prior_anomaly_auc= 0.6221838613678397
 first_prior_star_anomaly_auc= 0.5328894733820233


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5328284955490372; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6221791465869386; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 30 
last prior star auc 0.5328762719955007 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5328169705290571; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6221866902363803; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 170 
last prior star auc 0.5328622324257065 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5328014641385383; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6222012536707189; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 300 
last prior star auc 0.532844211485374 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5327865863854729; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6222115214157921; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 400 
last prior star auc 0.5328281812303106 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5328435828479204 at iter 0
0.6222234655274079 at iter 490
0.5328894733820233 at iter 0
last anomaly aucs:
0.5327663652140531
0.6222234655274079
0.5328106841545224




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 70.03015947341919 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5327651079391462,first_prior_anomaly_auc= 0.6222252466668594, first_prior_star_anomaly_auc= 0.5328085886963442


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5327650031662373 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6178428054329362 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328139321146986 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5327651079391462 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6138772556035694 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328156084812412 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5327650031662373 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6104141966453391 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328196946246888 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5327650031662373 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.6075217309490373 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328245141784986 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5327651079391462 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.6056910339116379 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328301719155799 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5327650031662373 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.6049646433341589 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.532831219644669 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5327651079391462 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.6047591836597848 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.532837086927568 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5327650031662373 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.6048570415567076 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328410682981066 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5327651079391462 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.6046862617151828 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328469355810056 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5327651079391462 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.6045407321447056 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328554221866274 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5327650031662373 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.6039040271772544 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328647469755204 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5327651079391462 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.6031905236675715 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328733383540512 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5327652127120551 at iter 31
max_prior_anomaly= 0.6222252466668594 at iter 0
max_prior_star_anomaly= 0.5328783674536788 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5327651079391462
accuracies_anomaly['prior'][-1]= 0.6024490457912093
accuracies_anomaly['prior_star'][-1]= 0.5328783674536788



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.96083116531372 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5327651079391462
 first_prior_anomaly_auc= 0.6024120609543638
 first_prior_star_anomaly_auc= 0.5328789960911323


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5327472965446314; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6023998025240213; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 30 
last prior star auc 0.5328625467444332 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5327369240266492; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6023961354722094; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 30 
last prior star auc 0.5328486119475482 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5327306376521146; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6023764381653341; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 30 
last prior star auc 0.5328379251108393 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5327217319548572; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6023691040617104; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 30 
last prior star auc 0.5328236759952274 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5327651079391462 at iter 0
0.6024122705001816 at iter 30
0.5328789960911323 at iter 0
last anomaly aucs:
0.5327113594368749
0.6023584172250015
0.532801883230174




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 70.05061864852905 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5327109403452394,first_prior_anomaly_auc= 0.6023577885875481, first_prior_star_anomaly_auc= 0.5328012545927204


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5327111498910572 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6011437848919979 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328101602899779 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.532711359436875 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6002738554293111 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328185421226908 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5327112546639661 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6007991867945902 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328345723777541 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5327111498910572 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6015165669019028 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328450496686452 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.532711359436875 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6031459951812843 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328565746886254 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.532711359436875 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6048198471740441 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328759576767739 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5327111498910572 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6078737679229778 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5328950263461957 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5327111498910572 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6105656982716242 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5329217434379679 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.532711359436875 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6119476529401584 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5329445839321105 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5327111498910572 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6114576300451823 iter_best_prior_anomaly= 920
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.53296868170116 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5327109403452394 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6119425190676218 iter_best_prior_anomaly= 920
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5329950844742055 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.532711359436875 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6130863249142016 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5330189726974373 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.532711359436875 at iter 1
max_prior_anomaly= 0.6131074890418015 at iter 127
max_prior_star_anomaly= 0.5330447468330293 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.532711359436875
accuracies_anomaly['prior'][-1]= 0.6130981642529084
accuracies_anomaly['prior_star'][-1]= 0.5330445372872115



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.78421425819397 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4625653730565149
accuracies_anomaly["prior"][-1]= 0.4930037890074778
accuracies_anomaly["prior_star"][-1]= 0.46256296327961


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 590.8586802482605 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0038373470306396484 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4718225834233333
 first_prior_anomaly_auc= 0.5118707705795995
 first_prior_star_anomaly_auc= 0.47182457410860257


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5438591969449895; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5403006898667415; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.5438602446740788 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5515528811921313; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.530763945378949; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.5515468043634144 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5403532858670147; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5535961624617107; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 300 
last prior star auc 0.5403695256678959 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5481368652700018; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5527164891184952; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 340 
last prior star auc 0.5481641062263187 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5586900117471385 at iter 490
0.5552043218405834 at iter 340
0.5587042608627504 at iter 490
last anomaly aucs:
0.5586900117471385
0.544187869560243
0.5587042608627504




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.88436388969421 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5598697547014747,first_prior_anomaly_auc= 0.5432153674197324, first_prior_star_anomaly_auc= 0.5598891376896232


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5598697547014747 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5450694288158189 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5598884042792609 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5598697547014747 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5464446780181828 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5598848420003579 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5598695451556569 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5473449916244536 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5598828513150886 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5598693356098391 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.547429229043218 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5598827465421797 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5598695451556569 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.547225864827022 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.559882327450544 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5598695451556569 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5463766804002995 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5598825369963618 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5598695451556569 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5450954124972288 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5598797081278213 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5598697547014747 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5419722368555052 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5598808606298193 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5598695451556569 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5323960977539621 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5598783460800054 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5598693356098391 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5119864398710372 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5598743647094668 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5598697547014747 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.48486576285364524 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5598701737931104 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5598695451556569 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4522924941107148 iter_best_prior_anomaly= 330
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5598659828767539 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5598697547014748 at iter 6
max_prior_anomaly= 0.5474949216571051 at iter 33
max_prior_star_anomaly= 0.5598896615541678 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5598693356098391
accuracies_anomaly['prior'][-1]= 0.4193965248083389
accuracies_anomaly['prior_star'][-1]= 0.5598670306058431



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 127.27309489250183 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5598695451556569
 first_prior_anomaly_auc= 0.4179365143226662
 first_prior_star_anomaly_auc= 0.5598670306058431


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5598940620163421; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4179219508883275; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5598960527016114 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5599273798013757; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4179154549679751; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5599225602475657 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5599558780325995; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4179149311034306; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5599558780325995 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5599858430845479; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4179048729041751; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5599835380805519 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5600099408535975 at iter 490
0.4179365143226662 at iter 0
0.5600032353874271 at iter 490
last anomaly aucs:
0.5600099408535975
0.4179019392627256
0.5600032353874271




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.98526072502136 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5600120363117758,first_prior_anomaly_auc= 0.41790183448981677, first_prior_star_anomaly_auc= 0.5600059594830589


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.56001161722014 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4109012230351202 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5599990444710707 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5600118267659578 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.40588270547119937 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5599968442399835 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5600117219930489 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.40175706263701677 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5599905578654489 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5600116172201401 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.39744921971423813 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5599850049012767 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5600116172201401 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.39457383200208873 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5599816521681915 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5600118267659578 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.3928067321203983 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5599774612518351 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.56001161722014 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.3917362673100561 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5599743180645678 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5600118267659578 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.39071902713744067 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5599698128294845 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5600119315388667 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.3895320548523897 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5599650980485835 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5600118267659578 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.38842900566737615 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5599598594031381 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5600117219930489 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.3877826615923051 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5599558780325994 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5600116172201401 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.387374990203733 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.559944562558437 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5600122458575936 at iter 5
max_prior_anomaly= 0.41790183448981677 at iter 0
max_prior_star_anomaly= 0.5600059594830589 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.56001161722014
accuracies_anomaly['prior'][-1]= 0.3871906946569589
accuracies_anomaly['prior_star'][-1]= 0.5599345043591817



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.93929409980774 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.56001161722014
 first_prior_anomaly_auc= 0.3871921614776836
 first_prior_star_anomaly_auc= 0.5599330375384568


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5600429443199044; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.3872155258363707; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5599674030525796 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5600721759614905; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.38723459450579245; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5599971585587104 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5601002551010785; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.3872528249919429; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 290 
last prior star auc 0.5600282761126568 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5601318965195696; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.3872788086733529; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 400 
last prior star auc 0.5600631654913242 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5601576706551618 at iter 490
0.38730217303203995 at iter 490
0.5600897778101875 at iter 490
last anomaly aucs:
0.5601576706551618
0.38730217303203995
0.5600897778101875




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 69.23039674758911 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5601608138424291,first_prior_anomaly_auc= 0.3873030112153113, first_prior_star_anomaly_auc= 0.5600922923600014


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5601608138424291 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.38790178838973677 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.560088101443645 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5601608138424291 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.388419785651392 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5600784623360251 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.560160813842429 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3896964435464708 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5600646323120488 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5601608138424291 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3899197146153598 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5600537359295221 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5601608138424291 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3902918679878111 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5600451445509915 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.560160813842429 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3908024263729337 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5600346672601004 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.560160813842429 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.3914545329579948 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5600267045190231 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5601608138424291 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.3915126819224404 iter_best_prior_anomaly= 790
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5600130840408648 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.560160813842429 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.38992935372297954 iter_best_prior_anomaly= 790
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5599925485507182 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.560160813842429 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.38841810928484954 iter_best_prior_anomaly= 790
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5599766230685639 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.560160813842429 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.38838908718908116 iter_best_prior_anomaly= 790
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5599623739529519 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5601608138424291 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.38726015909556666 iter_best_prior_anomaly= 790
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5599489630206114 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5601610233882469 at iter 65
max_prior_anomaly= 0.39152808354005025 at iter 79
max_prior_star_anomaly= 0.5600922923600014 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5601608138424291
accuracies_anomaly['prior'][-1]= 0.38615145217347213
accuracies_anomaly['prior_star'][-1]= 0.5599254938890154



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.95517134666443 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4718225834233333
accuracies_anomaly["prior"][-1]= 0.5118707705795995
accuracies_anomaly["prior_star"][-1]= 0.47182478365442043


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 587.4690976142883 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return
