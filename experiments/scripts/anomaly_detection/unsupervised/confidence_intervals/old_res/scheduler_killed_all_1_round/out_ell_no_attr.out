

/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.011927604675292969 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5042956985202451
 first_prior_anomaly_auc= 0.502068602940219
 first_prior_star_anomaly_auc= 0.5042957949746301


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44718940361771464; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47549514255716974; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.44719293625956646 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43607020842345784; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4643134871202048; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4360697864355234 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4345696434418975; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45791478158627913; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4345691008859818 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4343688977530469; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45439839832670936; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4343694583941599 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5042956985202451 at iter 0
0.502068602940219 at iter 0
0.5042957949746301 at iter 0
last anomaly aucs:
0.43434891361014777
0.45205622060854034
0.43434968524522805




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.30932855606079 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43444136513820225,first_prior_anomaly_auc= 0.4517993444959993, first_prior_star_anomaly_auc= 0.43444037648075573


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43444136513820225 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4526227333822357 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.434440310168366 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43444137116660136 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4551207090458298 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344403403103613 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4344413711666013 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.458948597770264 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344409552070658 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43444136513820225 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.46671444172925347 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43444075024149764 iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43444136513820225 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4785089924423167 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344408466958827 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43444136513820225 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.48982610600626275 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344407200995023 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43444137116660125 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4958074715013462 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43444068392910795 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43444136513820225 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.49992963652611816 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344408286106855 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43444136513820225 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.5038441895155048 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43444035839555845 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43444137116660125 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.5064387160185173 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43444056336112663 iter_best_prior_star_anomaly= 950
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4344413711666013 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.5074678662216261 iter_best_prior_anomaly= 1050
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43444188358052177 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43444136513820225 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.5081158829506747 iter_best_prior_anomaly= 1180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344438006114243 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43444137719500037 at iter 47
max_prior_anomaly= 0.5082882891355227 at iter 122
max_prior_star_anomaly= 0.43444490983685224 at iter 122
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43444137116660136
accuracies_anomaly['prior'][-1]= 0.5069810066847712
accuracies_anomaly['prior_star'][-1]= 0.43444024385597624



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 120.50442600250244 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43444136513820225
 first_prior_anomaly_auc= 0.5066727987541951
 first_prior_star_anomaly_auc= 0.4344397434988539


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4344424201080385; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5066724008798569; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 70 
last prior star auc 0.43444169670015076 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43444856907508445; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5066765001912208; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 130 
last prior star auc 0.43444374635583277 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43445227654050916; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5066755959313611; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 130 
last prior star auc 0.43445331342514826 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4344532591695566; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.5066853920798411; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 380 
last prior star auc 0.4344494431929488 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4344619521210078 at iter 480
0.5066915109048916 at iter 450
0.4344592875686213 at iter 490
last anomaly aucs:
0.43446183155302653
0.506686875066011
0.4344592875686213




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 60.954933881759644 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.434457949264029,first_prior_anomaly_auc= 0.5066860009481466, first_prior_star_anomaly_auc= 0.43445420562820986


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4344579613208271 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5058237168311456 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344534159079323 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43445796132082704 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.505729498982165 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.434454314139393 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43445795529242803 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5072988781390477 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344557428699713 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43445796132082704 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5095194148208915 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43445413931582005 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4344579492640289 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5126150037689551 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344534641351249 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43445796132082704 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5157127448554848 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344534339931295 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4344579492640289 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5181355524111426 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344532410843595 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4344579492640289 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5204907816132864 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43445360881670236 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4344579432356299 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5213152857533498 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344528793804156 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4344579492640289 iter_best_vanilla_star_anomaly= 920 
last prior auc 0.5226001063891866 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43445085383832993 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4344579552924279 iter_best_vanilla_star_anomaly= 920 
last prior auc 0.5224702305597393 iter_best_prior_anomaly= 1040
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344506790147571 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.434457949264029 iter_best_vanilla_star_anomaly= 920 
last prior auc 0.5219864455064073 iter_best_prior_anomaly= 1040
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344515651894195 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43445796734922615 at iter 92
max_prior_anomaly= 0.5228373600627725 at iter 104
max_prior_star_anomaly= 0.43445579712556287 at iter 29
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43445795529242803
accuracies_anomaly['prior'][-1]= 0.5202816082225434
accuracies_anomaly['prior_star'][-1]= 0.4344486052454788



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 127.2491226196289 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4344579492640289
 first_prior_anomaly_auc= 0.5201835141129645
 first_prior_star_anomaly_auc= 0.43444857510348345


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43446435745223455; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5201852985190876; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 80 
last prior star auc 0.43445670138542253 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4344674861913491; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5201828751026636; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 160 
last prior star auc 0.4344615663034677 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4344730684888829; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5201890662685029; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 300 
last prior star auc 0.4344621028309844 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43447511814456485; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.5201831102102272; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 300 
last prior star auc 0.43446592483599134 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4344802121417744 at iter 440
0.5201890662685029 at iter 300
0.4344712599691636 at iter 440
last anomaly aucs:
0.43447900646196147
0.5201847137643784
0.4344707957824355




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 60.902178049087524 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4344757390696686,first_prior_anomaly_auc= 0.5201875531403378, first_prior_star_anomaly_auc= 0.4344681975424387


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4344757390696685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5185995160883503 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344646709289859 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4344757390696685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5176054391109992 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.434463085460032 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4344757390696685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5151511934542196 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43446479752536626 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4344757390696685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5113940299076112 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344612287131201 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4344757390696685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5069264737868329 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344593116822175 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4344757390696685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5033070893008456 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43445761167368135 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4344757390696685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5016844371814292 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344574368501084 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4344757390696686 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5007007411072675 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43445395846384816 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4344757390696685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4986453162474036 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344546336445434 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4344757390696685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49667021980507536 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43445740670811306 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4344757390696685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4935924809466419 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344580216048177 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4344757390696685 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49046811242144395 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43445834110996817 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4344757390696686 at iter 0
max_prior_anomaly= 0.5201875531403378 at iter 0
max_prior_star_anomaly= 0.4344681975424387 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4344757390696685
accuracies_anomaly['prior'][-1]= 0.4894815347725292
accuracies_anomaly['prior_star'][-1]= 0.434458889694283



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.85835409164429 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5042956985202451
accuracies_anomaly["prior"][-1]= 0.502068602940219
accuracies_anomaly["prior_star"][-1]= 0.5042957949746301


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 550.3607170581818 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.012885093688964844 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5075832859501167
 first_prior_anomaly_auc= 0.5044471560183437
 first_prior_star_anomaly_auc= 0.5075831714105344


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4440752230869358; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4799129704140642; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.44408061850409863 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4361500786826646; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4670731797007889; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4361517184072101 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.433743529719284; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4610043602204754; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43374632689644993 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43377364760101067; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45953003083164423; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43377497384880487 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5075832859501167 at iter 0
0.5044471560183437 at iter 0
0.5075831714105344 at iter 0
last anomaly aucs:
0.4336739197952852
0.45912292701441365
0.43367428149922904




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 60.59908151626587 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4336495228642709,first_prior_anomaly_auc= 0.45923120911841175, first_prior_star_anomaly_auc= 0.43365154237795744


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43364952286427083 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.46670183634680945 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43365100585044075 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4336495168358718 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.47358146344451146 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43365090939605566 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4336495168358718 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4808589709088752 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336511625888164 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43364952889266994 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4888818838891759 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336510902480276 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43364952286427083 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5010727114147495 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336513615259856 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4336495168358718 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5039412105700503 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336508671972622 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43364951080747266 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5072179770236009 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336511686172154 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4336495168358718 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5117793832610167 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43365197039429104 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4336495228642709 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.516609197938384 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336524406094181 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4336495168358718 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5224333970414546 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43365196436589204 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4336495168358718 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5407723174950411 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336523140130377 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43364952286427083 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5502784638095913 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43365274805777043 iter_best_prior_star_anomaly= 1150
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43364953492106895 at iter 2
max_prior_anomaly= 0.5554211222564153 at iter 128
max_prior_star_anomaly= 0.4336545384922925 at iter 125
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4336495168358718
accuracies_anomaly['prior'][-1]= 0.5550788779847207
accuracies_anomaly['prior_star'][-1]= 0.43365378494240947



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.90892457962036 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4336495168358718
 first_prior_anomaly_auc= 0.5546065348328132
 first_prior_star_anomaly_auc= 0.4336534232384657


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4336446519178267; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5546045153191266; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 60 
last prior star auc 0.4336499870509988 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4336498966250128; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5546006993425187; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 60 
last prior star auc 0.43365345338046096 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4336491852739232; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5545951893857737; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 60 
last prior star auc 0.4336529891937329 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4336502583289567; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.5545983784088788; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 60 
last prior star auc 0.433654206930344 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4336514820939668 at iter 360
0.5546098564806978 at iter 60
0.4336559431092746 at iter 490
last anomaly aucs:
0.43364790725332153
0.5545836269163678
0.4336559431092746




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 60.72250437736511 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4336459841940199,first_prior_anomaly_auc= 0.5545856162880591, first_prior_star_anomaly_auc= 0.43365472537266353


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4336459841940199 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5543922373028654 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336546892022692 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43364599022241895 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5550926769901795 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336561782168382 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4336459841940199 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.556313807589899 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43365599133646715 iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.433645990222419 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5555388930605409 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43365645552319515 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43364598419401995 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5559181818444875 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336568413407353 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43364599022241895 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5567783379366189 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43365873425804147 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4336459841940199 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5564620941500897 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336596927734928 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43364598419401995 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5567002581119342 iter_best_prior_anomaly= 590
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336603257553946 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4336459841940199 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5577394395710866 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336626406606353 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43364598419401995 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5579966532739753 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43366277931381386 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4336459841940199 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.558515782831023 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336670715339478 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.433645990222419 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5583405794690091 iter_best_prior_anomaly= 1130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43366933218359704 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.433645990222419 at iter 3
max_prior_anomaly= 0.5587175955465082 at iter 113
max_prior_star_anomaly= 0.4336705318350109 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43364598419401995
accuracies_anomaly['prior'][-1]= 0.5576711076676895
accuracies_anomaly['prior_star'][-1]= 0.4336705318350109



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 127.25112962722778 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43364598419401995
 first_prior_anomaly_auc= 0.5575549705597103
 first_prior_star_anomaly_auc= 0.43367036906823614


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4336442902138828; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5575499850736839; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 50 
last prior star auc 0.4336699470803016 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4336459721372218; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5575478088216217; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 50 
last prior star auc 0.4336713878676781 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4336475937765702; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5575475917992552; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 50 
last prior star auc 0.4336715325492556 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4336453210701228; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 310 
last prior auc 0.5575463198070527; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 50 
last prior star auc 0.43367031481264456 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.43364952889266994 at iter 310
0.5575594798022105 at iter 50
0.4336730456774209 at iter 190
last anomaly aucs:
0.4336426987165297
0.557548863791458
0.4336693683539914




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 60.89234113693237 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4336438320555539,first_prior_anomaly_auc= 0.5575483754911337, first_prior_star_anomaly_auc= 0.43366989885310914


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.433643844112352 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5557746396343607 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336705016930156 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4336438380839529 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5542919187140316 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43367109850452296 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43364383205555385 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5533880507002829 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336692839564045 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4336438380839529 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5527880742833801 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43367077899937256 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4336438380839529 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5523376443620724 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336693502687943 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.433643844112352 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5530747969996899 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336708332549642 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4336438320555539 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5531229096526243 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336747336291589 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4336438380839529 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5486064752722304 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336751857590888 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4336438380839529 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.538514603676166 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336757946273943 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43364385616915013 iter_best_vanilla_star_anomaly= 1000 
last prior auc 0.5365688534804842 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.433673907738487 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43364383205555385 iter_best_vanilla_star_anomaly= 1000 
last prior auc 0.5311936254261476 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336741307892525 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4336438320555539 iter_best_vanilla_star_anomaly= 1000 
last prior auc 0.5293394224986605 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4336718942531995 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43364385616915013 at iter 100
max_prior_anomaly= 0.5575483754911337 at iter 0
max_prior_star_anomaly= 0.4336764155524979 at iter 85
last values
accuracies_anomaly['vanilla_star'][-1]= 0.433643844112352
accuracies_anomaly['prior'][-1]= 0.526993187667921
accuracies_anomaly['prior_star'][-1]= 0.43367012793227355



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 127.50300908088684 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5075832859501167
accuracies_anomaly["prior"][-1]= 0.5044471560183437
accuracies_anomaly["prior_star"][-1]= 0.5075831714105344


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 564.0647141933441 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.012396574020385742 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5122489714345516
 first_prior_anomaly_auc= 0.5090652050933702
 first_prior_star_anomaly_auc= 0.5122486639861993


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44880793834056987; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4825628135068934; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4488144068127661 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.438247467228417; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47064753204576376; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.43825465910850103 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43641147006610503; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4651402699951146; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4364135679489795 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4365258167395621; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45752236897756904; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4365302717264708 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5122489714345516 at iter 0
0.5090652050933702 at iter 0
0.5122486639861993 at iter 0
last anomaly aucs:
0.43658338795062884
0.4535044711430183
0.436584611715639




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 60.72969174385071 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4365595818027228,first_prior_anomaly_auc= 0.45318137909515177, first_prior_star_anomaly_auc= 0.43656494104949123


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4365595938595209 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4575196200275956 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4365653087818342 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4365595938595209 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.46512921391123013 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43656665311482556 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.436559593859521 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.47088104811192955 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4365683651801599 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4365595938595209 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4767078755969923 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43656936589440465 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.436559593859521 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.4815899323806534 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43657138540809126 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43655958783112186 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.4857240396639722 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4365753942934692 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.436559593859521 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.4900807817531453 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4365769556488269 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4365595938595209 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.49828915240226884 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43657905353170146 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4365595878311219 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5038549200658398 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43658187482246363 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4365595938595209 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5086093013857119 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43658576916825936 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43655959385952087 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5111664337293268 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43658960925846346 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4365595938595209 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5150060597467397 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4365915142325679 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43655959385952103 at iter 45
max_prior_anomaly= 0.5209815776947306 at iter 129
max_prior_star_anomaly= 0.4365986277434641 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.436559593859521
accuracies_anomaly['prior'][-1]= 0.5209815776947306
accuracies_anomaly['prior_star'][-1]= 0.4365986277434641



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 127.36484956741333 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.436559593859521
 first_prior_anomaly_auc= 0.5211891415029233
 first_prior_star_anomaly_auc= 0.43659933306615467


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4365517448839389; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5211852109867332; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.4365923220380426 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43654344377842697; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5211802013871105; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.4365843645512773 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4365501594149849; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5211748963959336; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.43658798761911516 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4365458913084471; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5211724187239182; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.4365853471803249 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.436559593859521 at iter 0
0.5211894489512756 at iter 10
0.43659933306615467 at iter 0
last anomaly aucs:
0.4365473019538282
0.5211681988445729
0.4365856184582827




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 60.39454627037048 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4365501775001821,first_prior_anomaly_auc= 0.5211700314778885, first_prior_star_anomaly_auc= 0.4365896092584635


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4365501835285812 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.522425216503924 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43659101990384463 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43655017750018205 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5239726703734087 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43659271991238086 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43655018352858116 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5254669296495474 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43659600538987103 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4365501775001821 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5259286748758993 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4365994415773379 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4365501835285811 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5269668857628023 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.436604402949768 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43655017750018205 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5266869510238392 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366069770761686 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43655018352858116 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5263613029347693 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366100515596915 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4365501835285811 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5264739676848874 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366149104493376 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4365501835285811 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.526220232368259 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366225424025534 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43655018352858116 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5262876961821908 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366264789471425 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.436550171471783 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5262972089959147 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366305179745158 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43655017750018205 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5267096238327211 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366365765155757 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4365501835285812 at iter 10
max_prior_anomaly= 0.5269668857628023 at iter 50
max_prior_star_anomaly= 0.4366440818724111 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43655018352858116
accuracies_anomaly['prior'][-1]= 0.5265684568118257
accuracies_anomaly['prior_star'][-1]= 0.4366440818724111



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.46033644676208 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.436550171471783
 first_prior_anomaly_auc= 0.5265485389813163
 first_prior_star_anomaly_auc= 0.43664468471231754


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43654561400209013; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5265532351041876; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 90 
last prior star auc 0.43664060951454986 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4365444686062679; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5265513241016841; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 90 
last prior star auc 0.4366409290197003 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4365406285160638; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5265503716146319; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 90 
last prior star auc 0.43663655240197946 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43654384165276516; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5265514205560692; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 90 
last prior star auc 0.4366391084431829 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4365503221817596 at iter 160
0.5265547783743482 at iter 90
0.43664560705737443 at iter 20
last anomaly aucs:
0.4365409841916086
0.5265490212532414
0.43663455097349




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 59.80627417564392 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4365393263818658,first_prior_anomaly_auc= 0.5265498592007114, first_prior_star_anomaly_auc= 0.43663414707075265


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43653932035346676 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5265269934830595 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43664288824939634 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4365393263818658 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5266251840470234 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43664552265978757 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4365393263818658 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5272165277964658 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366543482360181 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4365393203534667 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5274127702712152 iter_best_prior_anomaly= 360
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366616305420881 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4365393263818658 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5270869292733754 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366708359074597 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43653932638186577 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5269216004290291 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366764965741814 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4365393203534667 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5262531956543441 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.436682253695288 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4365393263818658 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5237554550983136 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4366924477181063 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43653932638186577 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5187725793686964 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43669656511466737 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4365393263818658 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5179202119681565 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43670089350519575 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43653932638186577 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5171745110606655 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4367001399553127 iter_best_prior_star_anomaly= 1070
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43653932035346676 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5165501557979455 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43670013392691365 iter_best_prior_star_anomaly= 1070
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4365393263818659 at iter 12
max_prior_anomaly= 0.5275658132382679 at iter 43
max_prior_star_anomaly= 0.43670173145266566 at iter 107
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4365393203534667
accuracies_anomaly['prior'][-1]= 0.5138047143527501
accuracies_anomaly['prior_star'][-1]= 0.4366985183159643



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.52833700180054 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5122489714345516
accuracies_anomaly["prior"][-1]= 0.5090652050933702
accuracies_anomaly["prior_star"][-1]= 0.5122486639861993


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 557.4712023735046 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.012144088745117188 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5155170690502474
 first_prior_anomaly_auc= 0.5129421710145892
 first_prior_star_anomaly_auc= 0.5155169725958624


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4499146077272502; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4778211762226437; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4499204673311409 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43705826303014345; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4676477705292308; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.43706124708768046 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43534495584559385; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45855950078103935; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43534582393505916 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4344274998203537; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4542165275553298; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4344280725182649 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5155170690502474 at iter 0
0.5129421710145892 at iter 0
0.5155169725958624 at iter 0
last anomaly aucs:
0.43434450082203246
0.45122922673966337
0.4343450674915446




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 59.64418363571167 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4343857652136296,first_prior_anomaly_auc= 0.4508721043790773, first_prior_star_anomaly_auc= 0.4343865127351136


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4343857652136296 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4593648104984811 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43438674181427805 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4343857652136296 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4656703169828682 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43438674181427805 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4343857591852305 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4710826679186446 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4343866875586864 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43438577124202865 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4761858885787881 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43438627762755 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4343857652136296 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4792152555631272 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43438714571701537 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43438576521362954 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4874670969979055 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43438800174968256 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4343857652136296 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.49287369684097426 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4343893400542749 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4343857652136296 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.49443056706979777 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43439276418494355 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43438575918523054 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.49277721834234456 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43439722520025137 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4343857531568315 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4927952492839468 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4343994436511071 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43438577124202865 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4922082098114364 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43439908194716326 iter_best_prior_star_anomaly= 1050
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4343857652136296 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4957335090732229 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43439906989036514 iter_best_prior_star_anomaly= 1050
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43438577124202865 at iter 11
max_prior_anomaly= 0.4982487319865408 at iter 129
max_prior_star_anomaly= 0.43439965464507435 at iter 105
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43438575918523054
accuracies_anomaly['prior'][-1]= 0.4982487319865408
accuracies_anomaly['prior_star'][-1]= 0.4343986780444259



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.51974415779114 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43438576521362954
 first_prior_anomaly_auc= 0.49917151108815494
 first_prior_star_anomaly_auc= 0.4343978883241485


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4343923482254081; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.49916629049456496; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 30 
last prior star auc 0.43440291600896835 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43437555913401327; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.49915516206989186; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 30 
last prior star auc 0.43439301737770425 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43438953296304494; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.49914417832679614; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 30 
last prior star auc 0.4344006011037275 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43438847196480956; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.499130909820455; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 30 
last prior star auc 0.4343998656390417 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.43439505497658815 at iter 80
0.49917289761993977 at iter 30
0.43440740113787235 at iter 80
last anomaly aucs:
0.4343929450369155
0.49912266297053454
0.4344031149461374




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 59.82376790046692 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4343940844043387,first_prior_anomaly_auc= 0.4991191062150864, first_prior_star_anomaly_auc= 0.43440510431782875


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43439409043273775 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5050662424602813 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43440680432636497 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43439409646113686 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5098865322671265 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344061291456698 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43439409043273775 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5116892647234002 iter_best_prior_anomaly= 280
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344057915553221 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4343940844043387 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5127536268054452 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43440460396070646 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43439408440433874 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.5124149272324006 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4343995220202949 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4343940844043387 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.5117988549899952 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43439929896952956 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43439409043273775 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.5118137089652903 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4343999138662341 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43439407837593963 iter_best_vanilla_star_anomaly= 430 
last prior auc 0.5119242336337404 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43439943762270805 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43439407837593963 iter_best_vanilla_star_anomaly= 860 
last prior auc 0.5123424116200527 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43439851527765116 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4343940783759397 iter_best_vanilla_star_anomaly= 860 
last prior auc 0.5124679409737746 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344000223774173 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43439409043273775 iter_best_vanilla_star_anomaly= 860 
last prior auc 0.5130799862456047 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344013606820097 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43439407837593963 iter_best_vanilla_star_anomaly= 860 
last prior auc 0.5132879539565348 iter_best_prior_anomaly= 1190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344029401225646 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4343941024895359 at iter 86
max_prior_anomaly= 0.5134132904014865 at iter 123
max_prior_star_anomaly= 0.43440735893907895 at iter 27
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4343940783759397
accuracies_anomaly['prior'][-1]= 0.513101573942655
accuracies_anomaly['prior_star'][-1]= 0.43440289792377107



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.53011083602905 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43439410248953597
 first_prior_anomaly_auc= 0.513048276866525
 first_prior_star_anomaly_auc= 0.4344034284228888


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4343904914784962; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.513051351350048; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 70 
last prior star auc 0.43440309083254114 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43439211914624365; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5130461608984533; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 70 
last prior star auc 0.43440260253221696 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43439119077278776; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5130468903347402; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 70 
last prior star auc 0.43440337416729724 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4343930957468921; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5130417300251409; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 70 
last prior star auc 0.4344027472137945 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4343973337114345 at iter 70
0.5130543655495802 at iter 70
0.4344100837754561 at iter 140
last anomaly aucs:
0.43438906274791794
0.5130412477532157
0.43440015500219675




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 59.77013063430786 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43439187801028106,first_prior_anomaly_auc= 0.5130459378476878, first_prior_star_anomaly_auc= 0.43440503197704006


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4343918599250839 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5133289289849767 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344054238229792 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4343918599250839 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5135959147227491 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344032777129122 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43439187801028106 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.5126977013473231 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344049958066456 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43439186595348295 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.511899077124444 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344032957981094 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43439186595348295 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.5111463651888408 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43440154756238064 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.434391871981882 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.5042222665912393 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344043507679457 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4343918599250839 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.49786755028528795 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344075156774546 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4343918659534829 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4947718528260412 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344113075404663 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43439186595348295 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.49094107649845503 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43440983661109445 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43439185992508383 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48949723272369344 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344077326998209 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4343918599250839 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4879364741774731 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43440748553545927 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4343918599250839 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4860431770820523 iter_best_prior_anomaly= 140
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43440880575485447 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4343918780102811 at iter 21
max_prior_anomaly= 0.5136934180492196 at iter 14
max_prior_star_anomaly= 0.43441157279002507 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43439187198188206
accuracies_anomaly['prior'][-1]= 0.48594646950425824
accuracies_anomaly['prior_star'][-1]= 0.43441157279002507



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 127.60595512390137 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5155170690502474
accuracies_anomaly["prior"][-1]= 0.5129421710145892
accuracies_anomaly["prior_star"][-1]= 0.5155169725958624


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 556.0772061347961 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.012627124786376953 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49743591691226363
 first_prior_anomaly_auc= 0.4945536488934994
 first_prior_star_anomaly_auc= 0.4974357179750945


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4454921741734703; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47486427059506087; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4454984557652957 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43580297552132385; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4673150089292647; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4358057304996964 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43493004525157475; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45899148982960847; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4349317934873035 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43475859155377883; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45355272847753025; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4347575124703463 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.49743591691226363 at iter 0
0.4945536488934994 at iter 0
0.4974357179750945 at iter 0
last anomaly aucs:
0.43485148918336414
0.4512514715322116
0.43485287571514897




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.237224817276 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4348725463812967,first_prior_anomaly_auc= 0.4511581338294947, first_prior_star_anomaly_auc= 0.4348730889372125


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4348725282960995 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45600133758118444 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348730045396256 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43487253432449857 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45980349709841095 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43487349283994986 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4348725222677005 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46306527092348804 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348739148278844 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4348725403528977 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4663951536011968 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348737520611097 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4348725403528977 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4736902278204347 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43487301056802474 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4348725222677004 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47918331107648404 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43487316730640035 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4348725282960995 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4893744221779497 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43487381234510025 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4348725343244986 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49065417895857233 iter_best_prior_anomaly= 740
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348748492297394 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43487252829609957 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49156909099940727 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348763141307121 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4348725343244986 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4930439448589572 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348775559809194 iter_best_prior_star_anomaly= 980
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4348725282960995 iter_best_vanilla_star_anomaly= 1070 
last prior auc 0.5019913731198026 iter_best_prior_anomaly= 1090
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348810765659731 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4348725343244986 iter_best_vanilla_star_anomaly= 1070 
last prior auc 0.5066503610528768 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348840726803082 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43487254638129674 at iter 107
max_prior_anomaly= 0.5088878134224958 at iter 126
max_prior_star_anomaly= 0.4348885276672169 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4348725403528977
accuracies_anomaly['prior'][-1]= 0.508276738722915
accuracies_anomaly['prior_star'][-1]= 0.43488840107083654



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 128.7862274646759 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4348725343244986
 first_prior_anomaly_auc= 0.5082020167165096
 first_prior_star_anomaly_auc= 0.43488877483157856


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4348769953398064; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5082082440527432; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 100 
last prior star auc 0.4348932780456798 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43487421021943856; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5082103419356176; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 200 
last prior star auc 0.4348912886739885 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4348734807831517; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5082127291816472; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 270 
last prior star auc 0.4348927294613649 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4348721846773529; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5082217778086431; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 400 
last prior star auc 0.43488916064911876 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.434877140021384 at iter 270
0.508230723952855 at iter 490
0.4348963103304093 at iter 290
last anomaly aucs:
0.43487044247002316
0.508230723952855
0.43488565212086305




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.339728116989136 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43487369780551804,first_prior_anomaly_auc= 0.5082275228729517, first_prior_star_anomaly_auc= 0.43488922696150845


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4348737038339171 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5080538024971076 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348908184588615 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4348737038339171 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.507481755653071 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43489190357069313 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43487370986231616 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5070086107240879 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43489210250786225 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43487370383391716 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5058525566922705 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43489216882025195 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4348737038339171 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.504927510912608 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348934106704592 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43487370383391716 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5054971946242113 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43489386882878817 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4348737038339171 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5056327492055775 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348967624603392 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4348737038339171 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5050394884252327 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43489755218061665 iter_best_prior_star_anomaly= 750
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4348737038339171 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5048258540191819 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43490148872520584 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43487370383391716 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5046006571437253 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349032249041364 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4348737038339171 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.505057440997647 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349086444348954 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43487370383391716 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5048919433581269 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43491472708955164 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4348737098623162 at iter 12
max_prior_anomaly= 0.5082686124409759 at iter 13
max_prior_star_anomaly= 0.43491984520035754 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43487369780551804
accuracies_anomaly['prior'][-1]= 0.5049288190752049
accuracies_anomaly['prior_star'][-1]= 0.43491984520035754



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 128.6702001094818 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43487370383391716
 first_prior_anomaly_auc= 0.5049264921131661
 first_prior_star_anomaly_auc= 0.43492036967107606


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4348738244018984; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5049278726165518; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 30 
last prior star auc 0.434921388470518 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43486762720766003; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5049363847160311; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 200 
last prior star auc 0.4349166501488532 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4348676573496554; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.504936101381275; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 230 
last prior star auc 0.4349171685911728 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4348722148193482; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5049367946471675; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 350 
last prior star auc 0.43492129201613294 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4348785687519622 at iter 80
0.5049414606280433 at iter 470
0.43492560232146416 at iter 80
last anomaly aucs:
0.43486956835215884
0.5049408698449351
0.43491775334588206




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.36241102218628 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43486796479800766,first_prior_anomaly_auc= 0.5049445230547682, first_prior_star_anomaly_auc= 0.43491698773920084


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4348679587696086 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5047420954425785 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349196824335827 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4348679587696086 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5048346735670134 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43492345621139716 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4348679647980077 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5045232705849331 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349278026871227 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43486795274120954 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5044987169155432 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43492876120257395 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4348679587696086 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5037271360908677 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349305697222934 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43486796479800766 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5025060657751388 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43493435555690585 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4348679647980076 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.49634484902236253 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43493492222641794 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43486796479800766 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.49413764715924957 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.434933614063821 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43486796479800766 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4922404376328357 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349335055526378 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43486796479800766 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4886173034826302 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349324566112006 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43486797082640666 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4863075645798278 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43492851403821237 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4348679587696086 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.48668600335950624 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.434923625006571 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43486798288320483 at iter 28
max_prior_anomaly= 0.5049445230547682 at iter 0
max_prior_star_anomaly= 0.4349353261291553 at iter 68
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4348679587696086
accuracies_anomaly['prior'][-1]= 0.4856352473741499
accuracies_anomaly['prior_star'][-1]= 0.4349200260523294



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 128.80937004089355 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.49743591691226363
accuracies_anomaly["prior"][-1]= 0.4945536488934994
accuracies_anomaly["prior_star"][-1]= 0.49743571797509445


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 570.3946461677551 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.012414216995239258 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5063359318144661
 first_prior_anomaly_auc= 0.5054829133468273
 first_prior_star_anomaly_auc= 0.506335829331682


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45320946540639373; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49207894887869363; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.4532164643777077 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43708633728458723; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47237290808524063; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.437092860012375 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43453045884797775; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4628234115530169; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.4345334187919185 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43437171301541; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45753185164929766; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.43437367224510604 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5063359318144661 at iter 0
0.5132087106508307 at iter 20
0.506335829331682 at iter 0
last anomaly aucs:
0.4347840555114277
0.45430249252599086
0.43478388671625384




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.27608323097229 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4347633720742371,first_prior_anomaly_auc= 0.45400225413897827, first_prior_star_anomaly_auc= 0.4347639688857445


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4347633781026361 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.45721048372356365 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43476474654922376 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4347633901594342 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.45924287407060177 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43476457775405003 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4347633781026361 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4600487263439592 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43476414973771643 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43476339618783333 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4612132924752558 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43476414973771643 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4347633901594342 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.46373186115005455 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43476334193224175 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4347633781026361 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.46489013966112674 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43476306462588477 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4347633901594342 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4670422660703857 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347635107274155 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4347633841310352 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4656456548022951 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347622146216167 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43476339618783333 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.46312959394150716 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43476202171284656 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4347633781026361 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4622548069248461 iter_best_prior_anomaly= 720
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347609908566066 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43476339618783333 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.46820569283425906 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347622266784148 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4347633781026361 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.48188340087551645 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347618951164663 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4347633961878334 at iter 33
max_prior_anomaly= 0.4825693784334747 at iter 127
max_prior_star_anomaly= 0.4347649153443976 at iter 12
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4347633781026361
accuracies_anomaly['prior'][-1]= 0.4824725442593002
accuracies_anomaly['prior_star'][-1]= 0.4347586759513658



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 128.26268815994263 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4347633720742371
 first_prior_anomaly_auc= 0.4825794338031145
 first_prior_star_anomaly_auc= 0.4347586156673751


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43476974409204827; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4825927505366481; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 90 
last prior star auc 0.4347634263298287 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43477419305055803; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4826077069947273; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 200 
last prior star auc 0.43476941253009976 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43476881571859244; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4826222776352664; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 300 
last prior star auc 0.43476368555098843 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43476629584778337; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.48263021100843545; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 390 
last prior star auc 0.4347628295183213 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.43477419305055803 at iter 200
0.4826419061026207 at iter 490
0.43476941253009976 at iter 200
last anomaly aucs:
0.43477388560220565
0.4826419061026207
0.4347669408864834




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.497249126434326 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4347720710540873,first_prior_anomaly_auc= 0.4826448841317586, first_prior_star_anomaly_auc= 0.43476570506467505


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43477207708248633 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4840550653261436 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347636795225894 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4347720650256882 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4850234673518786 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347630585974857 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43477207708248633 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.4848779900256521 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43476233518959795 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4347720710540873 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.48566098863815577 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347607014934515 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43477207708248633 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.48659081493827644 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43476103305540004 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4347720650256882 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.48704700198069084 iter_best_prior_anomaly= 570
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347604603574889 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43477207105408733 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.4873224395339517 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347608582318272 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4347720710540872 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.48716793166592637 iter_best_prior_anomaly= 710
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43476015290913655 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4347720650256882 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.4877082631024842 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43475768729391917 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4347720710540872 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.487850870910756 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43475572203582413 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4347720710540872 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.48765517099192246 iter_best_prior_anomaly= 1030
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43475396777169634 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43477207105408733 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.4874258627483037 iter_best_prior_anomaly= 1030
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43475168300845085 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4347720770824864 at iter 24
max_prior_anomaly= 0.48830948739799346 at iter 128
max_prior_star_anomaly= 0.43476570506467505 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43477207708248633
accuracies_anomaly['prior'][-1]= 0.4882979249285876
accuracies_anomaly['prior_star'][-1]= 0.4347518156332303



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 128.75808024406433 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4347720710540872
 first_prior_anomaly_auc= 0.4883277052199666
 first_prior_star_anomaly_auc= 0.4347516890368499


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4347745004989103; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4883432223191589; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.43475219542237137 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.434773349074689; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4883582993452194; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 200 
last prior star auc 0.434748994342468 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43476931607571473; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48837229728784737; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 300 
last prior star auc 0.4347442801343996 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43477803314076213; count_not_improved_vanilla_star_anomaly= 32 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.48838054413776777; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 380 
last prior star auc 0.43475158052566676 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.43478172854938874 at iter 420
0.48839364987733414 at iter 490
0.43475792842988176 at iter 460
last anomaly aucs:
0.4347796186097161
0.48839364987733414
0.4347538170617197




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.48299717903137 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.434778853003035,first_prior_anomaly_auc= 0.4883949821535274, first_prior_star_anomaly_auc= 0.4347544621004197


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.434778859031434 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4881441223832528 iter_best_prior_anomaly= 30
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347554869282606 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.434778853003035 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4886056023600459 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347551734515092 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.434778859031434 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.48900526110443165 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43475082094738465 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4347788650598331 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.48963932208964567 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43474608262571984 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43477886505983304 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.48990899649340086 iter_best_prior_anomaly= 470
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43474547375741435 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4347788650598331 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.48990594612347416 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43474682411880483 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4347788650598331 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.49001598851999906 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43474311665338006 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43477886505983304 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.48763704962433424 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43474128402006446 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.434778859031434 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4762120096319349 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43474293580140816 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.434778859031434 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.47451971141812543 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347468060336076 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43477886505983304 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4733232610841762 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4347488195188952 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.434778859031434 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.47178991969690176 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43475373266413275 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4347788710882322 at iter 17
max_prior_anomaly= 0.49018957627106385 at iter 54
max_prior_star_anomaly= 0.43475607168296987 at iter 125
last values
accuracies_anomaly['vanilla_star'][-1]= 0.434778853003035
accuracies_anomaly['prior'][-1]= 0.4699260773593104
accuracies_anomaly['prior_star'][-1]= 0.4347549925995373



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 128.5728621482849 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5063359318144661
accuracies_anomaly["prior"][-1]= 0.5054829133468273
accuracies_anomaly["prior_star"][-1]= 0.506335829331682


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 570.0391280651093 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.011881589889526367 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5037373662840803
 first_prior_anomaly_auc= 0.5016623973544492
 first_prior_star_anomaly_auc= 0.5037371070629206


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45185709655903805; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48455705011625166; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.4518635891448306 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4372044637642578; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4711953628107579; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.43720688718068174 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43533915652569377; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46211773318691557; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.43533978347919644 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.435126733827855; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4561996357400149; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 20 
last prior star auc 0.4351285604327715 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5037373662840803 at iter 0
0.5026349408903416 at iter 20
0.5037371070629206 at iter 0
last anomaly aucs:
0.4351667382840476
0.4529845277520968
0.4351675159475269




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.395543336868286 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4351268604242353,first_prior_anomaly_auc= 0.4528126942651598, first_prior_star_anomaly_auc= 0.43512860865996406


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4351268604242353 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.45769485956000405 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351286508587575 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4351268724810335 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.46395479737586204 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43512909696028823 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4351268604242353 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4678835593018439 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435128795540335 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4351268604242353 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.47331325997012813 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351284097227949 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4351268664526344 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4789171512293835 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43512791539407164 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4351268664526344 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.48620643215712034 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351292416418658 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4351268604242353 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4898743331987795 iter_best_prior_anomaly= 690
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351290306478986 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4351268724810335 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.489997493391669 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351294405790349 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4351268664526344 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.4832368488063047 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43512810830284165 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43512686645263443 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.48706986166994365 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43512729446896803 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4351268724810335 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.49171523747793 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351277345420997 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4351268664526344 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.49538313851958915 iter_best_prior_anomaly= 1180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351281565300342 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4351268785094325 at iter 15
max_prior_anomaly= 0.4955102051150725 at iter 118
max_prior_star_anomaly= 0.4351299650497536 at iter 63
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4351268724810335
accuracies_anomaly['prior'][-1]= 0.49486893416457717
accuracies_anomaly['prior_star'][-1]= 0.43512487708094305



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 128.89517664909363 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43512686042423526
 first_prior_anomaly_auc= 0.4949983277220995
 first_prior_star_anomaly_auc= 0.43512502176252066


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4351227611128714; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49500667102640483; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 80 
last prior star auc 0.43512244160772096 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43512499764892437; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4950223207503765; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 190 
last prior star auc 0.4351236774295292 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4351140681614203; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4950358484778775; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 290 
last prior star auc 0.43511512915965567 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43511516533004996; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49504736272009087; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 390 
last prior star auc 0.4351143575245754 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.43512934412464993 at iter 10
0.49505404218625443 at iter 490
0.4351284278079921 at iter 190
last anomaly aucs:
0.43510846175029017
0.49505404218625443
0.43510750323483893




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.55710577964783 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4351107223999394,first_prior_anomaly_auc= 0.4950566343978521, first_prior_star_anomaly_auc= 0.43511001104884983


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4351107223999394 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.49599714904951436 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351088656530275 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4351107223999394 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4972078143484579 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351068943665334 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4351107284283385 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4989898693959399 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351063337254204 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4351107223999394 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.49998257792670336 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435107231956881 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4351107284283384 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5012548775776832 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351096433165069 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4351107223999395 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5018949669619618 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435111053961888 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4351107223999394 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.5028756247229951 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43511190396615607 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43511072842833853 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.5041026390402017 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351139717070352 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4351107223999394 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.5051776593317929 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43511644335065175 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4351107223999394 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.504876824133273 iter_best_prior_anomaly= 910
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43511920435742324 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43511072239993936 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.5047513852055371 iter_best_prior_anomaly= 910
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43512117564391745 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4351107223999394 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.5055421423676368 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435122815368463 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43511074048513665 at iter 64
max_prior_anomaly= 0.5056303438743508 at iter 122
max_prior_star_anomaly= 0.43512365934433206 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4351107284283385
accuracies_anomaly['prior'][-1]= 0.5053881288283348
accuracies_anomaly['prior_star'][-1]= 0.43512365934433206



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 128.59137749671936 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4351107223999394
 first_prior_anomaly_auc= 0.5054294173335282
 first_prior_star_anomaly_auc= 0.43512359906034137


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43510715961609225; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5054467007536463; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 100 
last prior star auc 0.43512161571704916 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4351018305113192; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5054637068674075; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 200 
last prior star auc 0.43511828201236646 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43510386208180396; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5054784643883177; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 290 
last prior star auc 0.4351183603815542 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43510556811873924; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5054978878901037; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 400 
last prior star auc 0.4351185291767281 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4351109333939067 at iter 60
0.5055155330141659 at iter 480
0.4351253894948635 at iter 60
last anomaly aucs:
0.4351031869011086
0.5055122776786709
0.4351172812981217




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.530388593673706 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4351048447108515,first_prior_anomaly_auc= 0.5055168411767629, first_prior_star_anomaly_auc= 0.43511697384976944


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4351048447108514 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5054679146899546 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43512165791584256 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4351048447108515 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5049110714683589 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351196263453578 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4351048447108515 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5044386740608598 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43511923449941864 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4351048447108515 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5041230994266269 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43512026535565873 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4351048447108514 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5030884211815758 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351188366250804 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4351048447108515 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5026388472929353 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43511701604856284 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4351048447108515 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5023268173573524 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43511717278693857 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4351048447108515 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5014927039491801 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43511651569144055 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4351048447108514 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5003798614818576 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351198011689307 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4351048447108514 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4970667799523419 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351202653556586 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4351048447108514 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49445865338103967 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351236714011302 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4351048447108514 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49121019026109725 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351238341679049 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4351048447108515 at iter 0
max_prior_anomaly= 0.5056759788552697 at iter 6
max_prior_star_anomaly= 0.4351274331221465 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4351048447108515
accuracies_anomaly['prior'][-1]= 0.48602983020652335
accuracies_anomaly['prior_star'][-1]= 0.43512683631063914



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 128.86185765266418 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5037373662840803
accuracies_anomaly["prior"][-1]= 0.5016623973544492
accuracies_anomaly["prior_star"][-1]= 0.5037371010345215


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 571.0213851928711 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.012381792068481445 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49205571542869875
 first_prior_anomaly_auc= 0.4891649895660469
 first_prior_star_anomaly_auc= 0.4920556189743137


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.444919783710687; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.475779761362206; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4449246245151358 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4365920748736809; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47205852707402246; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4365963248950215 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4360205705855601; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4644612130392825; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43602228867929355 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4362264223284185; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4573566121168892; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4362268804867474 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.49205571542869875 at iter 0
0.4891649895660469 at iter 0
0.4920556189743137 at iter 0
last anomaly aucs:
0.43584241330800444
0.45455538989514926
0.435844149486935




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.3140811920166 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43583617994337165,first_prior_anomaly_auc= 0.4543400795941585, first_prior_star_anomaly_auc= 0.435840140601557


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4358361678865735 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4543627222610451 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358397487556179 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4358361618581744 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4581902733951317 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358389831489367 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4358361618581744 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46419345566642983 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43583938705167397 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43583617391497254 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46878593227262455 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43583905548972546 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4358361618581744 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4681107334921937 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43583786186671064 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4358361618581744 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45992732041519757 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358365416473155 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4358361678865735 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4520677529359509 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358356916430474 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4358361678865735 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4503416655453844 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358344678780373 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4358361618581744 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45393789495056475 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43583239410875907 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43583616788657353 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46053123940508867 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435830887008993 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43583617391497254 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4651928798337513 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358288192681138 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4358361678865735 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4694386390961452 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358250575470975 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43583617994337165 at iter 0
max_prior_anomaly= 0.4713591061861502 at iter 129
max_prior_star_anomaly= 0.435840140601557 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43583617391497254
accuracies_anomaly['prior'][-1]= 0.4713591061861502
accuracies_anomaly['prior_star'][-1]= 0.4358239242080733



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 128.50012111663818 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43583617391497254
 first_prior_anomaly_auc= 0.4715067657928382
 first_prior_star_anomaly_auc= 0.4358235805893267


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4358349863203569; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4714994774583691; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4358216937004194 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4358360654037894; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4714860582420513; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4358209401505364 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43583442567924385; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.47147779330693373; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.435819601845944 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43583122459934054; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4714673702049511; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43581711211713037 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4358382235706545 at iter 140
0.4715067657928382 at iter 0
0.43582534088185354 at iter 290
last anomaly aucs:
0.4358328341818908
0.4714648141637477
0.4358192582271973




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.44328784942627 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4358313994229134,first_prior_anomaly_auc= 0.4714592499514111, first_prior_star_anomaly_auc= 0.43581823942775544


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43583140545131244 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.47238586311483044 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358170458047406 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4358313933945143 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.47360080857710973 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358157557273408 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4358313933945143 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.474583509965426 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358163284252519 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4358313933945143 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.47618520134129466 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358156170741623 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4358313933945144 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4776387508385503 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43581557487536887 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43583139942291343 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.4791872958482657 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43581744367907893 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43583139942291343 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.48046904200057966 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358172869407032 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4358313933945143 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.48183835667770586 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358181309165723 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4358313933945143 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.482627745393218 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43581782346822 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4358313933945143 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.48262761879683763 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358181429733704 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4358313933945143 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.4827260625535623 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43581235571026833 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43583139942291343 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.4825261668689797 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358108425821032 iter_best_prior_star_anomaly= 850
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43583141147971155 at iter 57
max_prior_anomaly= 0.48278490575683175 at iter 108
max_prior_star_anomaly= 0.4358186131884975 at iter 85
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43583139942291343
accuracies_anomaly['prior'][-1]= 0.4827284739131881
accuracies_anomaly['prior_star'][-1]= 0.43580755107621394



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 128.64690923690796 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4358313933945143
 first_prior_anomaly_auc= 0.4827799865831951
 first_prior_star_anomaly_auc= 0.4358082322853082


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4358358122110287; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.482750200263417; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4358107521561172 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4358326231879235; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4827230784960253; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.43580963087389113 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4358297536699688; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4826913510317484; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4358064297939879 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4358310618325658; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4826667310499686; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43580812980252415 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4358358122110287 at iter 100
0.4827799865831951 at iter 0
0.43581169861477037 at iter 230
last anomaly aucs:
0.43583107991776293
0.48264782599050216
0.43580594752206275




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.5468864440918 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43583338879460476,first_prior_anomaly_auc= 0.48264464902419507, first_prior_star_anomaly_auc= 0.4358076354738008


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43583338879460465 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4822307994284113 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358043138259162 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43583338879460476 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48176838504976327 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43579846627882357 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4358333887946047 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4808399271962302 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43579879784077213 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4358333887946047 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48034189703590846 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43579940068067863 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43583338879460476 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47927913850801457 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43579866521599275 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4358333887946047 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4783518200219048 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435798689329589 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4358333887946047 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4774230547200194 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43579877372717596 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43583338879460476 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47626724785256375 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43579727265580886 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43583338879460476 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4752962415584328 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357997021006318 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43583338879460476 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4748010326888734 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358043017691181 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4358333887946047 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4724486006638955 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358058932664712 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43583338879460476 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46957060678006807 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358103482533799 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43583338879460476 at iter 0
max_prior_anomaly= 0.4826964028301646 at iter 1
max_prior_star_anomaly= 0.4358139230940252 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4358333887946047
accuracies_anomaly['prior'][-1]= 0.4673523247194745
accuracies_anomaly['prior_star'][-1]= 0.4358137121000579



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 127.83691644668579 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.49205571542869875
accuracies_anomaly["prior"][-1]= 0.4891649895660469
accuracies_anomaly["prior_star"][-1]= 0.49205561294591466


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 569.4777302742004 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.012318849563598633 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5035297723338923
 first_prior_anomaly_auc= 0.5016232549593228
 first_prior_star_anomaly_auc= 0.5035297482202961


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4464322728655971; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4775860023467352; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.44643806615709813 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43563068990445714; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46757240348412527; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4356333604852427 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43525598270379967; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46073785675462825; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43525522312551757 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43603230787853886; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4556248339176058; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43603121673830814 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5035297723338923 at iter 0
0.5016232549593228 at iter 0
0.5035297482202961 at iter 0
last anomaly aucs:
0.43613711159627666
0.45283612665232387
0.4361380640833289




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.33515238761902 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4361467751199772,first_prior_anomaly_auc= 0.45267369746792774, first_prior_star_anomaly_auc= 0.43614545490058204


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43614678114837624 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.455189336340781 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4361461421380754 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43614678114837624 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.45869340960946103 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4361456658945493 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43614678114837624 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4614097218303763 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43614470135069894 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4361467751199772 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.46077903072023935 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.436143959857614 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43614678114837624 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4609237786101792 iter_best_prior_anomaly= 350
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43614165098077234 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4361467751199772 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.46357192772287115 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43614053572694533 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4361467751199772 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.46202958593579324 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4361390647975736 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43614678114837624 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.44932841223060893 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4361374491866243 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43614677511997724 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.43750021702236636 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4361332715060725 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4361467690915781 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.43817158174099197 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4361297448926198 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4361467751199772 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.43959832897600654 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4361317041223157 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4361467690915781 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4410281205525486 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43613013071015994 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43614678717677535 at iter 3
max_prior_anomaly= 0.46357192772287115 at iter 60
max_prior_star_anomaly= 0.43614629887645107 at iter 13
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4361467690915781
accuracies_anomaly['prior'][-1]= 0.4420096042042537
accuracies_anomaly['prior_star'][-1]= 0.43612383706153646



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 129.01787996292114 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43614677511997724
 first_prior_anomaly_auc= 0.44251555568094625
 first_prior_star_anomaly_auc= 0.43612337890320757


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4361457502921362; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4424955775664462; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4361226856373151 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.436149276905589; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.442485570423999; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4361268874314631 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43614436978875043; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4424752618615986; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43611929164864177 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43614581057612684; count_not_improved_vanilla_star_anomaly= 33 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.44246089618662765; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43612593494441093 ; count_not_improved_prior_star_anomaly= 36 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.43615094074373084 at iter 450
0.44251555568094625 at iter 0
0.4361294012738731 at iter 450
last anomaly aucs:
0.4361494698143591
0.4424543192032482
0.43612850304241246




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.440617084503174 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43615002442707307,first_prior_anomaly_auc= 0.44245129294691776, first_prior_star_anomaly_auc= 0.4361256576380539


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.436150024427073 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4460862909864824 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43612440373104855 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43615002442707307 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.44955892012564147 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4361236863515598 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43615002442707307 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4513827459502421 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43612276400650296 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.436150024427073 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4528743225887971 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4361205576124454 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43615002442707296 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4534085352003044 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43611657886906274 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.436150024427073 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4529038798294108 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43611193700178297 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43615001839867396 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.45329842649138974 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4361069635725547 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43615002442707296 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.45354369190733246 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4361025809264348 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43615002442707307 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.45426227707583094 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4360998259480622 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.436150024427073 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4545964975483706 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43609733621924857 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43615002442707296 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4549172324922029 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43609644401618697 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.436150018398674 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.455399624985351 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43609785466156803 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43615003045547207 at iter 5
max_prior_anomaly= 0.4556863296164636 at iter 129
max_prior_star_anomaly= 0.4361256576380539 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4361500183986739
accuracies_anomaly['prior'][-1]= 0.4556863296164636
accuracies_anomaly['prior_star'][-1]= 0.436092531585194



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 128.80045628547668 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43615001839867396
 first_prior_anomaly_auc= 0.45575965303428617
 first_prior_star_anomaly_auc= 0.4360920493132689


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43614722122150795; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4557485969504017; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4360910003718316 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43615203791236057; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.45574805439448585; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4360934659870491 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43614135558921807; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.45574223096098954; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43608369998056445 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43614658823960617; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4557351656772858; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43608655744172103 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.43615777694827007 at iter 480
0.45575965303428617 at iter 0
0.43609531067716284 at iter 170
last anomaly aucs:
0.4361468956879585
0.45572377200305375
0.436088607097403




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.42401075363159 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4361546120387612,first_prior_anomaly_auc= 0.45572379611665004, first_prior_star_anomaly_auc= 0.4360947982632423


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43615461203876116 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4562220372709389 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4360872145372191 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4361546120387612 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4558894203525504 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43608136699012645 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43615461203876116 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45603026183989637 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43608201805722546 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43615461203876116 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45447145046657395 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.436077122997185 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43615461203876116 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4508637791599691 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4360759836297618 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43615461203876116 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4472673628744178 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4360735300713425 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43615461203876116 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44698589692209234 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4360716009836418 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43615461203876116 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44632732446628176 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4360714804156605 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43615461203876116 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44407046065167477 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4360700094862887 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4361546120387612 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4433327172309489 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43607182403440725 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43615461203876116 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44513566068118987 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4360733974465631 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43615461203876116 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4536633737139616 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43607172758002216 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4361546120387612 at iter 0
max_prior_anomaly= 0.4563500262114792 at iter 12
max_prior_star_anomaly= 0.4360947982632423 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43615461203876116
accuracies_anomaly['prior'][-1]= 0.4538917354989272
accuracies_anomaly['prior_star'][-1]= 0.4360731321970043



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 128.5144727230072 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5035297723338923
accuracies_anomaly["prior"][-1]= 0.5016232549593228
accuracies_anomaly["prior_star"][-1]= 0.5035297482202961


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 570.7216532230377 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.012308120727539062 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.503930920092847
 first_prior_anomaly_auc= 0.50284639904433
 first_prior_star_anomaly_auc= 0.5039308356952601


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4519372380962027; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4841788524725358; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.45194282039373646 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43788805407618636; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47053934036775164; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.4378912611844888 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4356531456909727; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46003006844885436; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.43565516520465936 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4349713458135662; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4543852745019457; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.43497234652781097 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.503930920092847 at iter 0
0.5067137978962334 at iter 10
0.5039308356952601 at iter 0
last anomaly aucs:
0.43514677825474474
0.45075778784761555
0.4351470736462989




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.388062477111816 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43516663580126347,first_prior_anomaly_auc= 0.450489946077176, first_prior_star_anomaly_auc= 0.4351688843941145


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43516663580126347 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45586619895935365 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351685347469688 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4351666358012634 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4608535176190814 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351691677288706 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4351666358012635 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4698348375394679 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43516889042251355 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43516663580126347 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.47608857816108746 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43516931241044815 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43516663580126347 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4829491494893464 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43516905921768745 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43516663580126347 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4868283881170127 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43516817304302496 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4351666418296625 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.4968353436838534 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351691014164808 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43516663580126347 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.5016632594155154 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43517000567634057 iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43516663580126347 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.505508455673664 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351698971651574 iter_best_prior_star_anomaly= 860
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43516663580126347 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.5058609421953694 iter_best_prior_anomaly= 950
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351724170359664 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43516663580126347 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.5137064213060021 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43517271845591965 iter_best_prior_star_anomaly= 1060
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43516663580126347 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.5199126099158001 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43517387590854006 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4351666418296625 at iter 65
max_prior_anomaly= 0.5246969584074224 at iter 129
max_prior_star_anomaly= 0.43517399647652133 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4351666358012635
accuracies_anomaly['prior'][-1]= 0.5246969584074224
accuracies_anomaly['prior_star'][-1]= 0.4351731886710466



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 128.12075281143188 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43516663580126347
 first_prior_anomaly_auc= 0.5250889008010055
 first_prior_star_anomaly_auc= 0.4351729053362906


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4351707230558292; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5250914869842042; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 100 
last prior star auc 0.4351768418808798 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43516554466103274; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5250819440284848; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 100 
last prior star auc 0.4351711932709563 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43517015035791806; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5250876710075962; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 100 
last prior star auc 0.4351713741229282 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4351720673888206; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5250735705821843; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 100 
last prior star auc 0.43517475605480344 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.43517739649359377 at iter 260
0.5250914869842042 at iter 100
0.4351802479263513 at iter 250
last anomaly aucs:
0.43517242909276455
0.5250756383230634
0.4351738517949438




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.41753172874451 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43517308015986345,first_prior_anomaly_auc= 0.5250737634909544, first_prior_star_anomaly_auc= 0.43517505144635765


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43517307413146444 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.52718621097757 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43517329115383074 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43517308015986356 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5284122547225273 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435172284411187 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43517307413146444 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5290562927081932 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351722964679851 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43517308015986356 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5292805190114005 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351722361839945 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4351730801598635 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5296342112129186 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43517267022872713 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43517308015986345 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5299916771922514 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351728028535065 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43517308015986345 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5302124070240013 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43517452697563896 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43517308015986356 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5304393280215904 iter_best_prior_anomaly= 780
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351760762741986 iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43517308015986356 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5304503479350804 iter_best_prior_anomaly= 780
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43517379151095315 iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4351730801598635 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5305874096162129 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43517552166148465 iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43517308015986356 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5302381241744107 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351742798112773 iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43517308618826256 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5302526767297526 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351705602890545 iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43517308618826256 at iter 6
max_prior_anomaly= 0.5305874096162129 at iter 100
max_prior_star_anomaly= 0.43517648620533494 at iter 77
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43517308015986356
accuracies_anomaly['prior'][-1]= 0.5303547495827142
accuracies_anomaly['prior_star'][-1]= 0.4351712053277544



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 128.78575706481934 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43517308015986345
 first_prior_anomaly_auc= 0.5303236912707334
 first_prior_star_anomaly_auc= 0.435171356037731


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43518161034453984; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5303290806594971; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 100 
last prior star auc 0.43517601599020794 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43517296562028124; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5303232451692026; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 140 
last prior star auc 0.43516930035365 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43517497910556885; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5303281583144404; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 240 
last prior star auc 0.43517535286631087 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43516669005685504; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5303236309867428; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 240 
last prior star auc 0.4351679560206586 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.43518161034453984 at iter 100
0.5303317994674753 at iter 240
0.43517828869665526 at iter 260
last anomaly aucs:
0.4351743883224606
0.5303261508575519
0.4351737432837606




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.365827560424805 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43517439435085953,first_prior_anomaly_auc= 0.5303258072388052, first_prior_star_anomaly_auc= 0.4351736468293756


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43517438229406147 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5302410539763561 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351748223671932 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43517438229406147 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5301101231770724 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43517197696283466 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43517438832246047 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5299315619967794 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351708737658059 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4351743883224606 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5293718070584355 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43516912553007714 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43517438832246047 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5293330504808492 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435169017018894 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43517438229406147 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5293541438491762 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43516826949740994 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43517438832246047 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.527702471016663 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43516785353787446 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43517438832246047 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5203349052986734 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351685890025604 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4351743883224606 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5122335507897444 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43517032518149096 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43517438832246047 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5072102486160002 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351675762315175 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4351743883224605 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5058413318132122 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351647850827506 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43517438229406147 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5043685517229406 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435163609544933 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4351743943508596 at iter 3
max_prior_anomaly= 0.5303258072388052 at iter 0
max_prior_star_anomaly= 0.43517561208747063 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43517438832246047
accuracies_anomaly['prior'][-1]= 0.5015889774822415
accuracies_anomaly['prior_star'][-1]= 0.4351629102506415



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 128.27125191688538 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.503930920092847
accuracies_anomaly["prior"][-1]= 0.50284639904433
accuracies_anomaly["prior_star"][-1]= 0.5039308356952601


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 569.5385508537292 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return
