

/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0037689208984375 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4045427035439356
 first_prior_anomaly_auc= 0.5041072382499251
 first_prior_star_anomaly_auc= 0.4045432181870769


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5666033140959728; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5978462699179761; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 90 
last prior star auc 0.5666828264613033 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4775317097371512; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 160 
last prior auc 0.580742105116891; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 90 
last prior star auc 0.4776256321104383 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6355899405793028; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5632424370617171; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 90 
last prior star auc 0.6356128421990908 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6416583551799347; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5479455703120899; count_not_improved_prior_anomaly= 32; iter_best_prior_anomaly= 90 
last prior star auc 0.6416966960939615 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6430186856631743 at iter 480
0.5988020908921544 at iter 90
0.6430870045401818 at iter 480
last anomaly aucs:
0.6429436764253299
0.5430248099165558
0.6429461209802511




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 91.9967589378357 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6430818581087687,first_prior_anomaly_auc= 0.5427335218985803, first_prior_star_anomaly_auc= 0.6431248308110673


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6430819867695541 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5409516986826164 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6431225149169315 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6430814721264129 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5384502756943308 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6431218716130048 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.64308237275191 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5350487418519124 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6431178831286598 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6430821154303396 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5293736432720187 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6431120933933201 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6430814721264129 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5223751398542735 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.643110034820755 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6430818581087688 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5094717496940446 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6431039877638447 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6430818581087688 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4880359622334277 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430952388304426 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6430819867695541 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4581575827005796 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430891917735323 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6430816007871982 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.42418547430026543 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430822440911248 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6430817294479835 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.3935141583474603 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430599857752636 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6430812148048421 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.3806097389009487 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430418446045328 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6430816007871982 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.3806820462623013 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430252473632259 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6430823727519102 at iter 28
max_prior_anomaly= 0.5427335218985803 at iter 0
max_prior_star_anomaly= 0.6431259887581353 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6430819867695541
accuracies_anomaly['prior'][-1]= 0.3881544073523978
accuracies_anomaly['prior_star'][-1]= 0.6429980999375223



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 134.43998265266418 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6430817294479835
 first_prior_anomaly_auc= 0.38850114816884823
 first_prior_star_anomaly_auc= 0.6429962986865277


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6430967827598665; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.38850050486492166; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6430055622630712 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6431046310677714; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.3885106690669623; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 200 
last prior star auc 0.6430188143239596 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6431256027757792; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.3885113123708889; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 300 
last prior star auc 0.6430246040592993 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6431481184132111; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.3885158154983752; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 400 
last prior star auc 0.6430386280848996 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6431630430643087 at iter 480
0.38851607281994593 at iter 490
0.6430572838987717 at iter 480
last anomaly aucs:
0.6431608558309583
0.38851607281994593
0.6430558686301331




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.41899800300598 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6431618851172408,first_prior_anomaly_auc= 0.3885167161238725, first_prior_star_anomaly_auc= 0.6430552253262065


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6431617564564556 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.3910598252066035 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.643044289159454 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6431621424388115 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.39317668110755316 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430306511162095 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6431623997603821 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.3960931637892969 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430096794082015 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6431620137780263 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.39779740455170975 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6429946260963186 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6431621424388114 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.39906844444993395 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6429809880530741 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6431625284211675 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.39936346363068387 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.642974169031452 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6431621424388114 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.399683957646928 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6429695372431802 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6431618851172408 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.4023224043715847 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6429843332334926 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6431622710995968 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.4037384449748699 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6429854911805605 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6431617564564556 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.40632980185209777 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430323237064187 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6431622710995968 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.40821699825124264 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6431261174189206 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6431620137780262 iter_best_vanilla_star_anomaly= 1180 
last prior auc 0.41586073550739183 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6432915751888484 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6431627857427381 at iter 118
max_prior_anomaly= 0.42001557824788716 at iter 129
max_prior_star_anomaly= 0.6434512432234364 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6431617564564556
accuracies_anomaly['prior'][-1]= 0.42001557824788716
accuracies_anomaly['prior_star'][-1]= 0.6434512432234364



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 135.00429964065552 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6431618851172408
 first_prior_anomaly_auc= 0.4203385168190525
 first_prior_star_anomaly_auc= 0.6434659105529634


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6431643296721621; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4203656642447561; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6434916427100285 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.643165101636874; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4203876652390466; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 200 
last prior star auc 0.6435101698631152 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6431721779800669; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.42040516310585074; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 290 
last prior star auc 0.6435292116593433 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6431696047643604; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 330 
last prior auc 0.42041815784516856; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 400 
last prior star auc 0.6435535285477697 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6431724353016375 at iter 330
0.4204334684786223 at iter 490
0.643579003383264 at iter 490
last anomaly aucs:
0.6431683181565071
0.4204334684786223
0.643579003383264




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.51710653305054 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6431671602094391,first_prior_anomaly_auc= 0.4204330824962662, first_prior_star_anomaly_auc= 0.643582991867609


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6431678035133658 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4221952206120754 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6437547540160178 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6431671602094392 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4214087172313846 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439000120426495 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6431674175310098 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4197680348969221 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439912325394448 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.643167031548654 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.41971425468865636 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.644053890341898 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6431670315486538 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4209120866000307 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6441022667971801 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6431684468172925 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.42136857506636316 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6441380344955006 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6431671602094391 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.42256228983260713 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6441798492507311 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6431675461917952 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4240690362895465 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6442493260748066 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6431676748525805 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4261704528962572 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6443022056575749 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6431683181565071 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.42944049541607354 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6443914962425903 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6431675461917952 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4354400764965565 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6444717805726332 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6431678035133658 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.4414756825969305 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6445105074690158 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6431684468172925 at iter 60
max_prior_anomaly= 0.448689435508524 at iter 129
max_prior_star_anomaly= 0.6445317364985945 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6431674175310098
accuracies_anomaly['prior'][-1]= 0.448689435508524
accuracies_anomaly['prior_star'][-1]= 0.6445317364985945



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 135.2933223247528 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4045427035439356
accuracies_anomaly["prior"][-1]= 0.5041072382499251
accuracies_anomaly["prior_star"][-1]= 0.40454321818707695


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 710.341305732727 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004239559173583984 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4084485876648274
 first_prior_anomaly_auc= 0.5097199363489363
 first_prior_star_anomaly_auc= 0.40844948829032457


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5585620150131697; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5978811369907991; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 70 
last prior star auc 0.5586438432726364 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6119184146520961; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5885950448099783; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 70 
last prior star auc 0.6119638319093157 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6177190861584668; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5776434387631273; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 70 
last prior star auc 0.6177686205608168 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3984651540275458; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5665594407681769; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 70 
last prior star auc 0.3984503580372334 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6177190861584668 at iter 300
0.5999664709993443 at iter 70
0.6177686205608168 at iter 300
last anomaly aucs:
0.4051494678075276
0.5559980628832162
0.40514830986045963




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.21286249160767 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40513621574663916,first_prior_anomaly_auc= 0.5548226179484883, first_prior_star_anomaly_auc= 0.40513595842506844


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40513621574663916 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5519594008318692 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051358297642832 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40513621574663916 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.549888348170495 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051358297642832 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40513621574663916 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5477662171773471 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40513570110349784 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40513621574663916 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5454570134023368 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40513570110349784 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40513621574663916 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5422004802649795 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40513570110349784 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40513621574663916 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5350940304483469 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051355724427125 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40513621574663916 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.522092472108915 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40513582976428314 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40513621574663916 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.496273854996207 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051351864603565 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40513621574663916 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4606068980708087 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051349291387859 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40513621574663916 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4308356929721362 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051346718172152 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40513621574663916 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42713965459210934 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40513505779957126 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40513621574663916 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4294785790085297 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40513531512114187 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40513621574663916 at iter 0
max_prior_anomaly= 0.5548226179484883 at iter 0
max_prior_star_anomaly= 0.40513788833684833 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40513621574663916
accuracies_anomaly['prior'][-1]= 0.43148195609682294
accuracies_anomaly['prior_star'][-1]= 0.4051328705662206



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 134.55473041534424 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40513621574663916
 first_prior_anomaly_auc= 0.43166632700219343
 first_prior_star_anomaly_auc= 0.40513184127993807


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40513377119171795; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43168073701014975; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.40513184127993807 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40513287056622066; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4316902579082638; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 180 
last prior star auc 0.40513158395836746 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4051320986015087; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4316938604102529; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 300 
last prior star auc 0.40513068333287017 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4051322272622941; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4316956616612475; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 360 
last prior star auc 0.4051305546720848 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.40513737369370706 at iter 140
0.4317005507710899 at iter 360
0.40513415717407397 at iter 310
last anomaly aucs:
0.40513505779957115
0.43169231648082895
0.4051332565485766




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.19115209579468 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4051314552975821,first_prior_anomaly_auc= 0.4316912871945464, first_prior_star_anomaly_auc= 0.4051296540465875


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4051314552975821 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43266074621196915 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051233496681066 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4051314552975821 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43312611227248915 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40512347832889195 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4051314552975821 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43349202354595295 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40512489359753057 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4051314552975821 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4334098093041304 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40512489359753057 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4051314552975821 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4331521017511248 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40512425029360394 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4051314552975821 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4328335376466604 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40512373565046256 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4051314552975821 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4324467833259739 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40512347832889195 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4051314552975821 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43217325049637334 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051238643112479 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4051314552975821 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43315055782170087 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40512232038182405 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4051314552975821 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4338837956372672 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40512334966810665 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4051314552975821 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43521813664187115 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051203904700442 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4051314552975821 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43787318060783464 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40512373565046256 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4051314552975821 at iter 0
max_prior_anomaly= 0.44420843767723023 at iter 129
max_prior_star_anomaly= 0.4051305546720848 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4051314552975821
accuracies_anomaly['prior'][-1]= 0.44420843767723023
accuracies_anomaly['prior_star'][-1]= 0.4051236069896773



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 134.87819933891296 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4051314552975821
 first_prior_anomaly_auc= 0.4448315418605585
 first_prior_star_anomaly_auc= 0.40512334966810665


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4051319699407234; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44485573008819956; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.40512141975632676 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40513274190543536; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4448742572412863; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 200 
last prior star auc 0.405123092346536 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40513312788779127; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4448912404649492; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 300 
last prior star auc 0.4051220630602534 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40513299922700596; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4449077090454707; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 400 
last prior star auc 0.40512322100732134 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4051354437819272 at iter 190
0.44493524245353033 at iter 490
0.4051269521700957 at iter 10
last anomaly aucs:
0.40513299922700596
0.44493524245353033
0.40512373565046267




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.2457504272461 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4051291394034463,first_prior_anomaly_auc= 0.4449367863829542, first_prior_star_anomaly_auc= 0.40511910386219097


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4051291394034463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4501788127594445 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051187178798349 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4051291394034463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4528112124271909 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051183318974789 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4051291394034463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.454725041608898 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40511743127198174 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4051291394034463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45663025051798833 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40511665930726976 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4051291394034463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4577479267601053 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051155013602018 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4051291394034463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45868264736549025 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40511472939548987 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4051291394034463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45987044373560926 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40511653064648445 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4051291394034463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4614394620126458 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40511575868177246 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4051291394034463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46298403474047056 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051149867170605 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4051291394034463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46584956775122566 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40511627332491373 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4051291394034463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4698406253120024 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40511768859355235 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4051291394034463 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4751575322655518 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4051198758269029 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4051291394034463 at iter 0
max_prior_anomaly= 0.48106795142180464 at iter 129
max_prior_star_anomaly= 0.4051215484171121 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4051291394034463
accuracies_anomaly['prior'][-1]= 0.48106795142180464
accuracies_anomaly['prior_star'][-1]= 0.4051211624347561



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 134.70761060714722 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4084485876648274
accuracies_anomaly["prior"][-1]= 0.5097199363489363
accuracies_anomaly["prior_star"][-1]= 0.4084494882903246


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 723.1297118663788 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003978252410888672 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4062662434241472
 first_prior_anomaly_auc= 0.5093065492456875
 first_prior_star_anomaly_auc= 0.4062683019967125


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5612484522107525; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5934531474030592; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 50 
last prior star auc 0.5613274499329419 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.618064540367064; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5790289867602905; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 50 
last prior star auc 0.618106097800724 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6352690605807028; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5635952249350777; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 50 
last prior star auc 0.6353028983672432 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40489626338200835; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 320 
last prior auc 0.5471929047179396; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 50 
last prior star auc 0.4048958773996523 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6367854565965414 at iter 320
0.600653905575335 at iter 50
0.6368056563398374 at iter 320
last anomaly aucs:
0.4030317112810806
0.5393505152092487
0.4030270794928089




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.02560329437256 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4028447671600036,first_prior_anomaly_auc= 0.5387019361904262, first_prior_star_anomaly_auc= 0.40284373787372096


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4028447671600036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5358216071893589 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40284399519529157 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4028447671600036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.532372726177941 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.402843737873721 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4028447671600036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.52784927028749 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40284373787372096 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4028447671600036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5210818416401883 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40284309456979434 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4028447671600036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5130236879945078 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40284296590900903 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4028447671600036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5016400390305359 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40284373787372096 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4028447671600036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47894697837572453 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4028432232305797 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4028447671600036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44870873462632277 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40284348055215036 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4028447671600036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42358887423871416 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40284373787372096 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4028447671600036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3947059432019243 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40284373787372096 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4028447671600036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3972163724451828 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40284399519529157 iter_best_prior_star_anomaly= 1020
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4028447671600036 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40399023413175067 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4028443811776476 iter_best_prior_star_anomaly= 1020
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4028447671600036 at iter 0
max_prior_anomaly= 0.5387019361904262 at iter 0
max_prior_star_anomaly= 0.40284836966199267 at iter 127
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4028447671600036
accuracies_anomaly['prior'][-1]= 0.40622751652776445
accuracies_anomaly['prior_star'][-1]= 0.4028443811776476



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 134.72409653663635 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4028447671600036
 first_prior_anomaly_auc= 0.4063919450114096
 first_prior_star_anomaly_auc= 0.40284734037571


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4028486269835633; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4063858979544994; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 50 
last prior star auc 0.40284862698356333 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4028427085874384; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.40639245965455095; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 200 
last prior star auc 0.4028423226050824 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4028392347462347; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4063941322447602; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 300 
last prior star auc 0.4028369188520987 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40282276616571305; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 70 
last prior auc 0.40639824938989055; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 400 
last prior star auc 0.40282778393634067 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.40284901296591924 at iter 70
0.406407126984078 at iter 490
0.4028502995737726 at iter 50
last anomaly aucs:
0.40281916366372394
0.406407126984078
0.4028187776813679




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.18119382858276 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40281800571665605,first_prior_anomaly_auc= 0.4064091855566432, first_prior_star_anomaly_auc= 0.4028207075931478


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40281800571665605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4069952354337979 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4028199356284359 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40281800571665605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.407190156523565 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4028232808088543 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40281800571665605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4066250783544183 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40282392411278095 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40281800571665605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40598254639250597 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40282675465005807 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40281800571665605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4056961474843728 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40282289482649836 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40281800571665605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4054525926177529 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4028250820598489 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40281800571665605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40696422818453454 iter_best_prior_anomaly= 150
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40282546804220487 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40281800571665605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40748453240038823 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4028245674167075 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40281800571665605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40941328623319306 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40282199420100107 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40281800571665605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.40978087009686615 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40282083625393317 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40281800571665605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41700748908699214 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40282109357550383 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40281800571665605 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42498124125749964 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4028219942010011 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40281800571665605 at iter 0
max_prior_anomaly= 0.4291136970213485 at iter 129
max_prior_star_anomaly= 0.4028285559010526 at iter 58
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40281800571665605
accuracies_anomaly['prior'][-1]= 0.4291136970213485
accuracies_anomaly['prior_star'][-1]= 0.40281800571665605



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 134.72412967681885 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40281800571665605
 first_prior_anomaly_auc= 0.4292902196188141
 first_prior_star_anomaly_auc= 0.40281890634215334


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40281337392838434; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4292886756893902; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 50 
last prior star auc 0.4028163331264468 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40281260196367236; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42930205641106406; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 200 
last prior star auc 0.4028149178578082 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40280295240477304; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4293177530268736; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 300 
last prior star auc 0.4028078415146154 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40279793463414537; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42932328544064263; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 400 
last prior star auc 0.4028015371361344 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.40281800571665605 at iter 0
0.4293361515191751 at iter 490
0.4028223801833571 at iter 40
last anomaly aucs:
0.4027945894537269
0.4293361515191751
0.4027988352596426




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.16824841499329 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40279626204393615,first_prior_anomaly_auc= 0.4293356368760338, first_prior_star_anomaly_auc= 0.40280513963812353


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40279626204393615 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43132524726029725 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40280398169105563 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40279626204393615 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4329313198435074 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4028003791890665 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40279626204393615 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4348060361464757 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4028014084753491 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40279626204393615 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43638573326869423 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40279844927728664 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40279626204393615 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4394513338006293 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4028007651714225 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40279626204393615 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4434059803591591 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4027984492772866 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40279626204393615 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4490476271348684 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40279806329493073 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40279626204393615 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4550650920645115 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4028007651714225 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40279626204393615 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4620556185135666 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40279857793807194 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40279626204393615 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4702900374351421 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40280063651063713 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40279626204393615 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48047791306030485 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40279626204393615 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40279626204393615 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4947965718591072 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40279549007922416 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40279626204393615 at iter 0
max_prior_anomaly= 0.5093375564949508 at iter 129
max_prior_star_anomaly= 0.4028056542812648 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40279626204393615
accuracies_anomaly['prior'][-1]= 0.5093375564949508
accuracies_anomaly['prior_star'][-1]= 0.4027989639204279



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 134.76495122909546 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4062662434241472
accuracies_anomaly["prior"][-1]= 0.5093065492456875
accuracies_anomaly["prior_star"][-1]= 0.4062683019967125


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 722.9258277416229 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004054069519042969 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.39996135030008845
 first_prior_anomaly_auc= 0.47828707720779334
 first_prior_star_anomaly_auc= 0.39995697583338735


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5614043890825663; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5925857163883991; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.5614656316163809 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6062282627603193; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.586430455757673; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.6062227303465504 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4051910252411875; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.569682809992723; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 60 
last prior star auc 0.40519063925883153 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40325365113576594; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5518554429173268; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 60 
last prior star auc 0.40325390845733655 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6255612183455869 at iter 280
0.5926460582967165 at iter 60
0.6255836053222336 at iter 280
last anomaly aucs:
0.40191390637817825
0.543061349579588
0.40191545030760223




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.08219766616821 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4017272195786719,first_prior_anomaly_auc= 0.5426673902549233, first_prior_star_anomaly_auc= 0.40172464636296545


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4017272195786719 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5431443357861225 iter_best_prior_anomaly= 90
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40172580431003335 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40172721957867197 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.543845151083787 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.401726061631604 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4017272195786719 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5443962052273333 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40172554698846275 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40172721957867197 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5453316977974303 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40172786288259854 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4017272195786719 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5450661419365198 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40172786288259865 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4017272195786719 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5427686462929739 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40172927815123716 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4017272195786719 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.536633199423188 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4017285061865252 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40172721957867197 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5229694240216891 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4017294068120225 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4017272195786719 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5000715353966406 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40172889216888114 iter_best_prior_star_anomaly= 840
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40172721957867197 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4837752316666101 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4017279915433839 iter_best_prior_star_anomaly= 960
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40172721957867197 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.467299317480266 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4017277342218132 iter_best_prior_star_anomaly= 960
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4017272195786719 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4534698269872688 iter_best_prior_anomaly= 430
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40172734823945727 iter_best_prior_star_anomaly= 960
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40172721957867197 at iter 1
max_prior_anomaly= 0.5456165527761394 at iter 43
max_prior_star_anomaly= 0.4017305647590903 at iter 96
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4017272195786719
accuracies_anomaly['prior'][-1]= 0.44472706930287476
accuracies_anomaly['prior_star'][-1]= 0.4017261902923893



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 134.8376657962799 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4017272195786719
 first_prior_anomaly_auc= 0.4442258068832491
 first_prior_star_anomaly_auc= 0.40172953547280776


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40172426038060943; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.444247164573613; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.40172207314725894 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4017196285923378; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4442547555599472; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 200 
last prior star auc 0.4017180846629139 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4017155114472074; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4442703235149714; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 300 
last prior star auc 0.40171834198448453 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4017120376060036; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4442839615582159; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 400 
last prior star auc 0.4017135815354276 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4017272195786719 at iter 0
0.4443006874603081 at iter 490
0.40172953547280776 at iter 0
last anomaly aucs:
0.4017108796589357
0.4443006874603081
0.4017104936765797




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.3658492565155 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4017085637647998,first_prior_anomaly_auc= 0.44430210272894677, first_prior_star_anomaly_auc= 0.4017084351040145


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4017085637647998 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4422069905007169 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4017094643902971 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40170856376479985 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.44081024901523036 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.401710236355009 iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4017085637647998 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.43953869447386484 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4017112656412917 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4017085637647998 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4387887307562063 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.401706247870664 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4017085637647998 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4381226538705795 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4017133242138569 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4017085637647998 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.43715113628059166 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40170985037265317 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4017085637647998 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.43641262337282705 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40170997903343847 iter_best_prior_star_anomaly= 520
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4017085637647998 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.43587636521959305 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4017072771569466 iter_best_prior_star_anomaly= 720
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40170856376479985 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.43584317073697926 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4017079204608732 iter_best_prior_star_anomaly= 820
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4017085637647998 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.43720324389864823 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4017027740294602 iter_best_prior_star_anomaly= 820
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4017085637647998 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4383233646956864 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40170547590595207 iter_best_prior_star_anomaly= 820
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4017085637647998 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4392964262150982 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40170238804710423 iter_best_prior_star_anomaly= 820
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40170856376479985 at iter 3
max_prior_anomaly= 0.44430210272894677 at iter 0
max_prior_star_anomaly= 0.4017138388569982 at iter 82
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4017085637647998
accuracies_anomaly['prior'][-1]= 0.4430302908660106
accuracies_anomaly['prior_star'][-1]= 0.4017050899235961



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 135.12375855445862 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4017085637647998
 first_prior_anomaly_auc= 0.44356822160945375
 first_prior_star_anomaly_auc= 0.40170071545689506


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40170393197652815; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.44359433974887474; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.4016950543823407 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4017036746549575; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.44361248091960553; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 200 
last prior star auc 0.4016922238450636 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4016940250960581; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4436376984335292; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 300 
last prior star auc 0.40168784937836255 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4016940250960581; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.44365995674939035; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 390 
last prior star auc 0.40168669143129465 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.40170869242558516 at iter 20
0.4436854315848847 at iter 490
0.40170290269024556 at iter 20
last anomaly aucs:
0.4016886213430745
0.4436854315848847
0.4016798724096724




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.34128189086914 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40168887866464514,first_prior_anomaly_auc= 0.44369276524964824, first_prior_star_anomaly_auc= 0.40167665589003926


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40168900732543045 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44992586565549586 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4016792291057458 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40168900732543045 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4548033960271609 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4016846328587294 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4016888786646451 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4583653698688792 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40168347491166145 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40168900732543045 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.46223201245024687 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40168579080579736 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40168900732543045 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4663703866102206 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4016883640215039 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40168887866464514 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4716775153440853 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4016830889293055 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40168887866464514 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47724145100545823 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4016819309822376 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4016887500038598 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4832896658627941 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40168180232145234 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40168887866464514 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4915879005338908 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4016751119606154 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40168900732543045 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4996486273952779 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40168180232145223 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4016888786646451 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.509982404350999 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4016752406214007 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40168875000385984 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5208196309596962 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4016739540135475 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40168900732543045 at iter 1
max_prior_anomaly= 0.5317173281374962 at iter 129
max_prior_star_anomaly= 0.40168887866464514 at iter 35
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4016887500038598
accuracies_anomaly['prior'][-1]= 0.5317173281374962
accuracies_anomaly['prior_star'][-1]= 0.40167729919396594



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 134.93900561332703 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.3999613503000884
accuracies_anomaly["prior"][-1]= 0.47828707720779334
accuracies_anomaly["prior_star"][-1]= 0.39995684717260205


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 724.0213551521301 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0039975643157958984 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4014725998845141
 first_prior_anomaly_auc= 0.47640644250870007
 first_prior_star_anomaly_auc= 0.40147311452765533


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5545888413015531; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5947526213348402; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.5546617919668322 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6157223994310105; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5837361702521854; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.615757009182263 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6326747445054125; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5698589466078327; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 60 
last prior star auc 0.6326686974485022 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.39747343669426183; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.5492757941715635; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 60 
last prior star auc 0.3974608279373 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.635448156393875 at iter 360
0.5963491730199362 at iter 60
0.6354946029373773 at iter 360
last anomaly aucs:
0.4031538103663539
0.5411311804781447
0.4031538103663539




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.03059363365173 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4029788316983121,first_prior_anomaly_auc= 0.5407906153793898, first_prior_star_anomaly_auc= 0.40297883169831206


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4029788316983121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.540565716326642 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40297870303752675 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4029788316983121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5392978929480509 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40297998964537995 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4029788316983121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5385017400084607 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4029790890198827 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4029788316983121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.53667359890978 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4029792176806681 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4029788316983121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5349630537688861 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.402979217680668 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4029788316983121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5287542702514649 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.402979217680668 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4029788316983121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5158551258971517 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40297947500223874 iter_best_prior_star_anomaly= 650
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4029788316983121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48996960517607485 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40297973232380935 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4029788316983121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4564407331812048 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40297998964538007 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4029788316983121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4425023956638227 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4029793463414534 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4029788316983121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4360307581619829 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4029779310728148 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4029788316983121 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4350921777330382 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4029753578571083 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4029788316983121 at iter 0
max_prior_anomaly= 0.540798206365724 at iter 2
max_prior_star_anomaly= 0.40298114759244796 at iter 71
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4029788316983121
accuracies_anomaly['prior'][-1]= 0.4370777996329565
accuracies_anomaly['prior_star'][-1]= 0.40297574383946433



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 134.92267632484436 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4029788316983121
 first_prior_anomaly_auc= 0.43720787568692
 first_prior_star_anomaly_auc= 0.4029752291963229


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.402974457231611; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.43720967693791446; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 70 
last prior star auc 0.40297304196297246 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4029695681217687; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.43721520935168345; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 180 
last prior star auc 0.40296750954920346 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4029666089237062; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.43720864765163187; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 180 
last prior star auc 0.4029628777609318 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40296017588444; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4372099342594851; count_not_improved_prior_anomaly= 32; iter_best_prior_anomaly= 180 
last prior star auc 0.4029595325805133 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.40297973232380935 at iter 60
0.4372163672987514 at iter 180
0.4029761298218203 at iter 10
last anomaly aucs:
0.40295400016674443
0.4372100629202704
0.40295335686281775




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.36190128326416 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.402954643470671,first_prior_anomaly_auc= 0.43720954827712916, first_prior_star_anomaly_auc= 0.4029530995412471


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.402954643470671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43774644973428967 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4029530995412471 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.402954643470671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4377983000307757 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40295361418438835 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.402954643470671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4377263786517791 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4029518129333939 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.402954643470671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43760247831551125 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40295245623732046 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.402954643470671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4376426204805326 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40295219891574985 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.402954643470671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43727889644041923 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4029511696294672 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.402954643470671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4366492305570394 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40294846775297544 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.402954643470671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4360582915700424 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40294808177061947 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.402954643470671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.435260852022599 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40294808177061936 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.402954643470671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4350453452071799 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40295104096868195 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.402954643470671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43522418369878146 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40294962570004333 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.402954643470671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43430863355040983 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4029505263255406 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.402954643470671 at iter 0
max_prior_anomaly= 0.43783368174674 at iter 21
max_prior_star_anomaly= 0.40295425748831504 at iter 7
last values
accuracies_anomaly['vanilla_star'][-1]= 0.402954643470671
accuracies_anomaly['prior'][-1]= 0.43416672070419654
accuracies_anomaly['prior_star'][-1]= 0.4029471811451221



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 135.002614736557 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.402954643470671
 first_prior_anomaly_auc= 0.43416993722382957
 first_prior_star_anomaly_auc= 0.4029479531098341


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4029479531098341; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43417251043953614; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 100 
last prior star auc 0.4029420347137092 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40294293533920644; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43416221757671014; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 100 
last prior star auc 0.4029381748901494 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40294139140978247; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43416105962964213; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 100 
last prior star auc 0.40293534435287226 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4029367596215108; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4341541119472347; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 100 
last prior star auc 0.40292942595674736 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.402954643470671 at iter 0
0.43417251043953614 at iter 100
0.4029479531098341 at iter 0
last anomaly aucs:
0.40293418640580436
0.43415475525116126
0.40292723872339686




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.41348075866699 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4029332857803071,first_prior_anomaly_auc= 0.4341548839119466, first_prior_star_anomaly_auc= 0.4029271100626115


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4029332857803071 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4344515756829057 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40292608077632897 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4029332857803071 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.436908096057113 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4029253088116169 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4029332857803071 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4378600572077316 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40292518015083156 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4029332857803071 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43988221877068223 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40292286425669577 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4029332857803071 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4420248068286969 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4029242795253344 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4029332857803071 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4436779692593359 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4029244081861197 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4029332857803071 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4466167102569407 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40292234961355444 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4029332857803071 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4513591468040147 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40292325023905173 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4029332857803071 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4577439382757602 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4029242795253343 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4029332857803071 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46434307861585705 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4029250514900463 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4029332857803071 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47281899383148734 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4029259521155436 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4029332857803071 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48296942916812047 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4029227355959104 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4029332857803071 at iter 0
max_prior_anomaly= 0.4932083831250573 at iter 129
max_prior_star_anomaly= 0.4029281393488941 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4029332857803071
accuracies_anomaly['prior'][-1]= 0.4932083831250573
accuracies_anomaly['prior_star'][-1]= 0.40292505149004626



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 134.74854350090027 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4014727285452994
accuracies_anomaly["prior"][-1]= 0.47640644250870007
accuracies_anomaly["prior_star"][-1]= 0.4014731145276554


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 723.8091955184937 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004036426544189453 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4041008824071301
 first_prior_anomaly_auc= 0.47754534778039565
 first_prior_star_anomaly_auc= 0.40410062508555944


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5645051140088951; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5928505002845976; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.5645596661818728 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6230110329196632; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.573980080222573; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.6230513037454699 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6389418113585857; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5599205442454148; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 60 
last prior star auc 0.6389590519038194 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6450534559830867; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5437200928004513; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 60 
last prior star auc 0.6450458649967526 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6475478026281796 at iter 470
0.5944991595877502 at iter 60
0.6475721195166061 at iter 470
last anomaly aucs:
0.6472861065908289
0.5363187524638541
0.6473195583950133




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.1853551864624 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.647683025113556,first_prior_anomaly_auc= 0.5357814650243374, first_prior_star_anomaly_auc= 0.6472822467672692


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.647683797078268 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5344630779571137 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6472854632869023 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6476844403821946 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.533403299068393 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.64729048105753 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6476839257390534 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5315589467107613 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6472980720438641 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.647683797078268 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5292768903614544 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6473054057086276 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6476836684174827 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5252149407079637 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6473216169675785 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6476831537743414 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5178331568107359 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6473485070717113 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6476843117214093 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5066049300754364 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6473885205759474 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6476828964527708 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.489557376019894 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6474399848900774 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6476835397566973 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.46786400966705677 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6475189826122669 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6476836684174826 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.442529414428741 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6476000389070214 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6476832824351266 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.42222146741228167 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6476805805586348 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6476840543998386 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.4175328110734735 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6477095292353329 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6476854696684772 at iter 45
max_prior_anomaly= 0.5357814650243374 at iter 0
max_prior_star_anomaly= 0.6477235532609333 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6476836684174827
accuracies_anomaly['prior'][-1]= 0.41812194880947606
accuracies_anomaly['prior_star'][-1]= 0.6477235532609333



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 136.51517868041992 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6476843117214093
 first_prior_anomaly_auc= 0.4180604489540908
 first_prior_star_anomaly_auc= 0.6477267697805664


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6477060553941291; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4180603202933054; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 60 
last prior star auc 0.6477326881766914 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.64770438280392; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.41806199288351464; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 60 
last prior star auc 0.6477293429962729 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6477223953138654; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41805736109524294; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 60 
last prior star auc 0.6477387352336017 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6477312729080529; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4180589050246668; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 60 
last prior star auc 0.6477393785375283 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6477395071983136 at iter 450
0.41806315083058254 at iter 60
0.6477470981846478 at iter 450
last anomaly aucs:
0.6477346180884713
0.41806109225801735
0.6477436243434441




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.36407470703125 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6477362906786805,first_prior_anomaly_auc= 0.4180618642227293, first_prior_star_anomaly_auc= 0.647743238361088


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6477369339826071 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4172452542182725 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6477346180884713 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6477364193394659 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.41677358377927165 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6477319162119795 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6477366766610365 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4160481942716101 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6477272844237079 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6477362906786805 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4151460248449123 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6477265124589957 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6477369339826071 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.41408238613263176 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6477247112080012 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6477365480002512 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4130107704516611 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6477200794197296 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6477369339826071 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4117664919967845 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.647719436115803 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6477365480002512 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4110449623126828 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6477176348648084 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6477369339826071 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.41130601504610687 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6477234246001481 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6477364193394658 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.41073733437497106 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6477333314806181 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6477365480002512 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4110728817030983 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.647750700686637 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6477366766610365 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.41284261080524154 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6477971472301391 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6477371913041778 at iter 13
max_prior_anomaly= 0.4180618642227293 at iter 0
max_prior_star_anomaly= 0.6478577464600271 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6477366766610365
accuracies_anomaly['prior'][-1]= 0.41503511924796227
accuracies_anomaly['prior_star'][-1]= 0.6478577464600271



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 135.25513625144958 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6477368053218218
 first_prior_anomaly_auc= 0.41508439632874167
 first_prior_star_anomaly_auc= 0.6478630215522254


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6477365480002512; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41508027918361134; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 20 
last prior star auc 0.6478586470855244 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.647744396308156; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4150838816856004; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 20 
last prior star auc 0.6478640508385081 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6477414371100935; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4150879988307308; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 300 
last prior star auc 0.6478504127952636 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6477420804140201; count_not_improved_vanilla_star_anomaly= 36 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.41509327392292905; count_not_improved_prior_anomaly= 32; iter_best_prior_anomaly= 400 
last prior star auc 0.647859676371807 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6477490280964275 at iter 280
0.41509957830141003 at iter 480
0.6478774315601818 at iter 490
last anomaly aucs:
0.6477460688983652
0.4150980343719861
0.6478774315601818




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.36671137809753 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6477481274709305,first_prior_anomaly_auc= 0.4151006075876926, first_prior_star_anomaly_auc= 0.6478878530837932


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6477477414885744 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4177695469184713 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6479592598196485 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6477478701493598 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4218567140858857 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6480064783278626 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6477482561317156 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.42648888833993626 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6480432753124655 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6477496714003542 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4309644824182463 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6480823881912043 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6477488994356424 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.43394954129856816 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6480915231069624 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6477490280964276 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4374779346753168 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6480993714148673 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6477473555062184 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.44146538973410443 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6480975701638726 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6477500573827102 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4458358679508042 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6481086349914106 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6477482561317157 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.45137252752568846 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6481049038286362 iter_best_prior_star_anomaly= 840
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6477490280964276 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.45785008342365313 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6481176412463833 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6477492854179983 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4662381233229066 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6481316652719837 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6477485134532863 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.47414304197326534 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6482199265707166 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6477501860434955 at iter 59
max_prior_anomaly= 0.4799129635519434 at iter 129
max_prior_star_anomaly= 0.6483130769792917 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6477486421140717
accuracies_anomaly['prior'][-1]= 0.4799129635519434
accuracies_anomaly['prior_star'][-1]= 0.6483130769792917



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 135.09412097930908 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4041008824071301
accuracies_anomaly["prior"][-1]= 0.47754534778039565
accuracies_anomaly["prior_star"][-1]= 0.4041006250855594


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 726.1174232959747 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003978729248046875 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40770750154135615
 first_prior_anomaly_auc= 0.5196040438599471
 first_prior_star_anomaly_auc= 0.4077059576119323


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5620816594565162; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5977034564462655; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 10 
last prior star auc 0.5621573119982872 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6161311547459876; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5836336276062816; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 10 
last prior star auc 0.6161730981620035 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6336133249343574; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5671667196749102; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 10 
last prior star auc 0.633665046570058 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4003967383976277; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.5524604059299242; count_not_improved_prior_anomaly= 39; iter_best_prior_anomaly= 10 
last prior star auc 0.400392106609356 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6368961048719206 at iter 370
0.6010537832961247 at iter 10
0.6369267261388281 at iter 370
last anomaly aucs:
0.40488918703881543
0.5467995886972015
0.4048876431093915




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.19948267936707 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.404870788546514,first_prior_anomaly_auc= 0.5460835914268687, first_prior_star_anomaly_auc= 0.4048705312249433


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.404870788546514 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5445969160524401 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048705312249433 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.404870788546514 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5435752207561755 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048709172072993 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.404870788546514 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5413716474859168 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487027390337266 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.404870788546514 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.539640130637015 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048706598857287 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.404870788546514 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5366903248118722 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048711745288699 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.404870788546514 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5312349788533134 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048707885465139 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.404870788546514 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5205772340401442 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487117452886995 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.404870788546514 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4994058444933699 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048707885465139 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.404870788546514 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4579265079301362 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048709172072993 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.404870788546514 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4358618265508514 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.404870788546514 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.404870788546514 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43230281190719544 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487194649358194 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.404870788546514 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4342078921555005 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048725897975085 iter_best_prior_star_anomaly= 1180
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.404870788546514 at iter 0
max_prior_anomaly= 0.5460835914268687 at iter 0
max_prior_star_anomaly= 0.40487271845829387 at iter 122
last values
accuracies_anomaly['vanilla_star'][-1]= 0.404870788546514
accuracies_anomaly['prior'][-1]= 0.4341608023080716
accuracies_anomaly['prior_star'][-1]= 0.40487156051122597



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 134.7221279144287 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.404870788546514
 first_prior_anomaly_auc= 0.4339939292695052
 first_prior_star_anomaly_auc= 0.4048718178327966


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40487117452886995; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 90 
last prior auc 0.43400833927746163; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.4048718178327966 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4048714318504406; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.43402738107368977; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 200 
last prior star auc 0.4048691159563047 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40486782934845145; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.43403754527573035; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 300 
last prior star auc 0.4048673147053102 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40486667140138355; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.43405054001504817; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 400 
last prior star auc 0.4048670573837395 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4048729757798645 at iter 170
0.4340725410093387 at iter 490
0.4048729757798645 at iter 10
last anomaly aucs:
0.4048671860445249
0.4340725410093387
0.40486744336609554




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 106.34211254119873 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4048674433660955,first_prior_anomaly_auc= 0.4340733129740506, first_prior_star_anomaly_auc= 0.40486705738373957


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4048674433660955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43347092317715974 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40486770068766614 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4048674433660955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43270487686133563 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048678293484515 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4048674433660955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4319519539456146 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048679580092368 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4048674433660955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4311614620805787 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048670573837395 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4048674433660955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43014684312750695 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40486757202688084 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4048674433660955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4296033799702948 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048686013131635 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4048674433660955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42930334301891726 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487027390337266 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4048674433660955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4299438164082644 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048714318504406 iter_best_prior_star_anomaly= 780
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4048674433660955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4312852337560612 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048729757798645 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4048674433660955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4318512125507052 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487400506614707 iter_best_prior_star_anomaly= 980
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4048674433660955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4345121749127937 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487490569164436 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4048674433660955 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43953290473852524 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487490569164436 iter_best_prior_star_anomaly= 1110
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4048674433660955 at iter 0
max_prior_anomaly= 0.44400939944233264 at iter 129
max_prior_star_anomaly= 0.4048764496210682 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4048674433660955
accuracies_anomaly['prior'][-1]= 0.44400939944233264
accuracies_anomaly['prior_star'][-1]= 0.4048764496210682



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 131.62141108512878 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4048674433660955
 first_prior_anomaly_auc= 0.44440117153364683
 first_prior_star_anomaly_auc= 0.4048763209602829


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4048642268464624; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4444239444926493; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 90 
last prior star auc 0.4048765782818536 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40486242559546787; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4444604841556816; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 200 
last prior star auc 0.40487451970928834 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4048612676483999; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44449226336965686; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 300 
last prior star auc 0.4048741337269324 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4048593377366201; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4445120771305969; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 400 
last prior star auc 0.4048693732778754 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4048674433660955 at iter 0
0.4445267444601239 at iter 490
0.40487683560342425 at iter 10
last anomaly aucs:
0.4048610103268293
0.4445267444601239
0.40486988792101664




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 105.13855218887329 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4048606243444733,first_prior_anomaly_auc= 0.44452931767583037, first_prior_star_anomaly_auc= 0.40486911595630476


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4048606243444733 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4480246452307506 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40486988792101675 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4048606243444733 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45062886818651077 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048710458680846 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4048606243444733 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45381425190958335 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487027390337266 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4048606243444733 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4574044024632879 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40486963059944603 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4048606243444733 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46045507834412536 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.404870788546514 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4048606243444733 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4638919939025081 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048714318504406 iter_best_prior_star_anomaly= 510
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4048606243444733 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46777587702910917 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048707885465139 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4048606243444733 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.472499657762311 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40487001658180205 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4048606243444733 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4777954643470671 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048673147053101 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4048606243444733 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48431766553753963 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40486667140138355 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4048606243444733 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4900959500672638 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4048665427405982 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4048606243444733 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4998831760069251 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40486487015038897 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4048606243444733 at iter 0
max_prior_anomaly= 0.5089977633609079 at iter 129
max_prior_star_anomaly= 0.40487220381515254 at iter 68
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4048606243444733
accuracies_anomaly['prior'][-1]= 0.5089977633609079
accuracies_anomaly['prior_star'][-1]= 0.40486461282881836



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 131.57901859283447 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40770750154135615
accuracies_anomaly["prior"][-1]= 0.5196040438599471
accuracies_anomaly["prior_star"][-1]= 0.4077059576119323


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 715.93980717659 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004090785980224609 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40451800067315324
 first_prior_anomaly_auc= 0.49420370296033034
 first_prior_star_anomaly_auc= 0.4045167140653


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5623533910351224; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5956894005127905; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.5624168208022875 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6184155269894303; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5827899988369065; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.6184479495073321 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4025507772655363; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5660105738579811; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 60 
last prior star auc 0.4025430576184168 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5832741493720839; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5502105147769485; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 60 
last prior star auc 0.5834473267891311 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6388938208856597 at iter 480
0.5979682403424641 at iter 60
0.6389286879584827 at iter 480
last anomaly aucs:
0.40002529471039483
0.5411940956021685
0.400023364798615




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.77002763748169 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.3992679973279728,first_prior_anomaly_auc= 0.5407188226611785, first_prior_star_anomaly_auc= 0.39926761134561684


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.39926812598875816 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5400490146127773 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3992669680416902 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3992679973279728 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5399851988632562 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39926748268483153 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.39926658205933424 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5397696920478371 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39926632473776363 iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3992672253632608 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.5393256836776811 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39926825464954346 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.39926735402404623 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5365768459992157 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39926838331032877 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.3992668393809049 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5332476195181499 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39926825464954346 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.3992677400064022 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.5247297608865037 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3992697985789673 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.3992678686671875 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.508808503345695 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39926671072011954 iter_best_prior_star_anomaly= 750
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.3992668393809049 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4857349927486781 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3992683833103288 iter_best_prior_star_anomaly= 750
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.39926838331032877 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4604835123776822 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39927288643781517 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.3992659387554076 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4571479815181355 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39927623161823367 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.39926812598875816 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.4558147984605994 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.399279576798652 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.39926928393582606 at iter 69
max_prior_anomaly= 0.5407188226611785 at iter 0
max_prior_star_anomaly= 0.39928433724770906 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.39926864063189943
accuracies_anomaly['prior'][-1]= 0.4558545546432648
accuracies_anomaly['prior_star'][-1]= 0.39928356528299713



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 131.77332639694214 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.39926735402404623
 first_prior_anomaly_auc= 0.4558387293666699
 first_prior_star_anomaly_auc= 0.39928446590849437


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3992305570394433; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45584155990394704; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 100 
last prior star auc 0.39924831222781815 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3991959472881909; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4558442617804388; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 200 
last prior star auc 0.39921190122557115 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.3991572203918081; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45585185276677304; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 290 
last prior star auc 0.39917368897232974 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3991214526934878; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4558657481315881; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 390 
last prior star auc 0.399137792613224 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.39926735402404623 at iter 0
0.4558714092061424 at iter 450
0.39928446590849437 at iter 0
last anomaly aucs:
0.3990932759815017
0.45586999393750377
0.3991137330463683




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 105.04086971282959 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.3990932759815016,first_prior_anomaly_auc= 0.45587076590221576, first_prior_star_anomaly_auc= 0.3991109025090911


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.3990931473207163 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.45532254229594654 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3991142476895096 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3990928899991457 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.454447005651811 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3991143763502949 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.39909340464228704 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4533120888644605 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39912145269348775 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3990932759815016 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4518112608036462 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3991255698386182 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.3990935333030723 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4503451711548695 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39912698510725675 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.39909391928542837 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.44900169523450745 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39913058760924586 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.39909366196385765 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.44830911422710373 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3991332894857377 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.39909301865993096 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.44979862013880956 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3991363773445854 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.39909379062464295 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.44986295053147196 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3991393365426479 iter_best_prior_star_anomaly= 880
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.39909276133836036 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4486788853241274 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39914242440149583 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.3990932759815017 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4478102963623994 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3991412664544278 iter_best_prior_star_anomaly= 1050
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.3990944339285696 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.44916946889857107 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3991434536877783 iter_best_prior_star_anomaly= 1150
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.3990949485717109 at iter 33
max_prior_anomaly= 0.45587076590221576 at iter 0
max_prior_star_anomaly= 0.3991458982426995 at iter 126
last values
accuracies_anomaly['vanilla_star'][-1]= 0.3990931473207163
accuracies_anomaly['prior'][-1]= 0.45032419944686153
accuracies_anomaly['prior_star'][-1]= 0.3991453835995582



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 131.48104453086853 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.39909379062464295
 first_prior_anomaly_auc= 0.4502073754537866
 first_prior_star_anomaly_auc= 0.39914602690348483


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.39904888801056465; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4502072467930013; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 40 
last prior star auc 0.39910472679139564 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3990194246907252; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4502054455420067; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 140 
last prior star auc 0.3990604674812438 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.39897941118648916; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4502100773302784; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 270 
last prior star auc 0.3990308755006191 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3989383683959705; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4502126505459849; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 270 
last prior star auc 0.39898893208460323 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.39909379062464295 at iter 0
0.45021406581462353 at iter 490
0.39914602690348483 at iter 0
last anomaly aucs:
0.3988980975701639
0.45021406581462353
0.39894583072151935




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.99805212020874 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.39889243649560957,first_prior_anomaly_auc= 0.45021509510090607, first_prior_star_anomaly_auc= 0.3989404269685357


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.39889243649560957 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.45012464656882273 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3989384970567559 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.3988912785485416 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4503793949237659 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39893618116262003 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.39889243649560957 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.45057405869196243 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3989364384841907 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.3988920505132536 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.45132299312333835 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3989346372331961 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.3988925651563949 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4529010176553476 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39893283598220153 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.3988926938171802 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.4550326695466097 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39893618116262003 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.3988920505132536 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.45722582129325706 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39893553785869335 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.3988923078348242 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.4601246774474112 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.3989333506253429 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.3988920505132536 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.4635991619551087 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39893180669591893 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.3988925651563949 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.46788575333977667 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.398931806695919 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.39889114988775637 iter_best_vanilla_star_anomaly= 1020 
last prior auc 0.4737906400822606 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39892434437037017 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.3988923078348242 iter_best_vanilla_star_anomaly= 1020 
last prior auc 0.4810931689357282 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.39890787578984854 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.3988932084603216 at iter 102
max_prior_anomaly= 0.48952225162550034 at iter 129
max_prior_star_anomaly= 0.3989408129508917 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.3988930797995362
accuracies_anomaly['prior'][-1]= 0.48952225162550034
accuracies_anomaly['prior_star'][-1]= 0.3988952670328867



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 131.11252570152283 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40451800067315324
accuracies_anomaly["prior"][-1]= 0.49420370296033034
accuracies_anomaly["prior_star"][-1]= 0.40451658540451463


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 709.50648188591 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004193305969238281 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4049474703745675
 first_prior_anomaly_auc= 0.508133162883525
 first_prior_star_anomaly_auc= 0.404946441088285


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.559214067873196; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5940752223001049; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.5592958961326626 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6125331558843783; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5819865122325528; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.6125390742805031 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6315515358495265; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5658120502662249; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 60 
last prior star auc 0.6315510212063853 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6377371604255893; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5518497818427723; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 60 
last prior star auc 0.6377287974745433 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6388846859699017 at iter 470
0.5975647601196854 at iter 60
0.6389182664348714 at iter 470
last anomaly aucs:
0.4025790826383078
0.5461147273369173
0.40252967689674307




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.07280468940735 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5674789794008936,first_prior_anomaly_auc= 0.5460563153403798, first_prior_star_anomaly_auc= 0.5681467288767297


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5674792367224643 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5460889951798524 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.568130260296208 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5674785934185377 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5460667368639912 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5681034988528604 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5674794940440349 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5455769252542595 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5680638713309805 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5674787220793229 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5448898766606247 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5680314488130785 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5674792367224643 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5437270404828588 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5679868035205708 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.567477564132255 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5407639825968276 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5679218298239818 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5674789794008936 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5347939934969692 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5678445046920015 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5674785934185377 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5241367633269415 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5677565007148393 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5674782074361816 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5000283053727714 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5676924276437476 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5674782074361817 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4633498173531492 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.567615359833338 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.567478336096967 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4497737886072418 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5675026529853935 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5674787220793229 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.4491454093317153 iter_best_prior_anomaly= 170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5673723196098592 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5674802660087468 at iter 19
max_prior_anomaly= 0.5462246036475847 at iter 17
max_prior_star_anomaly= 0.5681467288767297 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5674792367224643
accuracies_anomaly['prior'][-1]= 0.447633902425719
accuracies_anomaly['prior_star'][-1]= 0.5672177980066841



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.82592248916626 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5674792367224644
 first_prior_anomaly_auc= 0.44736590200988735
 first_prior_star_anomaly_auc= 0.5672018440693039


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5740083855953444; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4473767095158546; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 90 
last prior star auc 0.5738313483547374 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5813897835102162; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4473925347924496; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 200 
last prior star auc 0.5809724079226224 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5875909760413032; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.44740913203375643; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 300 
last prior star auc 0.5869101031653641 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5937026206658041; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.44742431400642485; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 400 
last prior star auc 0.5931376711574428 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.5996017176729485 at iter 490
0.44743229097511494 at iter 490
0.5991921903932594 at iter 490
last anomaly aucs:
0.5996017176729485
0.44743229097511494
0.5991921903932594




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.26342153549194 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6001387477908944,first_prior_anomaly_auc= 0.4474346068692508, first_prior_star_anomaly_auc= 0.5997355248896863


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6001395197556063 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.44612908588055955 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5996223033986003 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6001384904693237 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4453124758761028 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5995462648744734 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6001382331477529 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.44486949679222926 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5994424356207162 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.600139005112465 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.44450410016190667 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5993366764551793 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.600139005112465 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4437570956423107 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5991449718850452 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6001384904693237 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.44309462125867305 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5990093634173128 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6001392624340356 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4427074809556305 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.598856514404347 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6001372038614704 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.44300597397758423 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5986864248461474 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6001392624340356 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4444306348534862 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5985198091291517 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6001390051124649 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4435065930932832 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5984691167797338 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6001387477908944 iter_best_vanilla_star_anomaly= 1090 
last prior auc 0.44563026801585504 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5985281720801978 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6001395197556063 iter_best_vanilla_star_anomaly= 1090 
last prior auc 0.4489663135185431 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5986820503794463 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6001404203811036 at iter 109
max_prior_anomaly= 0.45260471186674445 at iter 129
max_prior_star_anomaly= 0.5997355248896863 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.600139005112465
accuracies_anomaly['prior'][-1]= 0.45260471186674445
accuracies_anomaly['prior_star'][-1]= 0.5988724683417271



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 130.56678867340088 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.600139005112465
 first_prior_anomaly_auc= 0.45295634179303723
 first_prior_star_anomaly_auc= 0.5988832758476944


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6060399033706039; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4529684359068578; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.6053057649295402 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6103267520768424; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4529779568049719; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 200 
last prior star auc 0.6105847169514187 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6144164924599633; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4529897935972218; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 270 
last prior star auc 0.6143776369027952 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6179926189880676; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4530110226268003; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 400 
last prior star auc 0.6184942673900491 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6201887299327773 at iter 490
0.4530294211191018 at iter 490
0.6210386630806333 at iter 490
last anomaly aucs:
0.6201887299327773
0.4530294211191018
0.6210386630806333




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.24001288414001 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6203527724340665,first_prior_anomaly_auc= 0.453031479691667, first_prior_star_anomaly_auc= 0.6212329408664738


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6203526437732811 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4530797274861639 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6215111054843461 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6203530297556372 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.45334000825487597 iter_best_prior_anomaly= 50
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6217089857721758 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6203530297556372 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4553952356396551 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6223634831871232 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6203526437732813 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4574761951814992 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6229190404581559 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6203527724340665 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4590483013173835 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6232598628784815 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6203525151124958 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4608994726966374 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6235425306238401 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6203531584164225 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.46352968513103326 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6237307613527704 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6203516144869986 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4666696515968862 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6238405090026524 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6203529010948519 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.47030444744309846 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6239247818170403 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6203526437732811 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4751157175103212 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6240657940377563 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6203526437732811 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.48037897291639 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6242232748389939 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6203532870772078 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.48678254886279304 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6243822995696554 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6203539303811345 at iter 59
max_prior_anomaly= 0.49279306611002865 at iter 129
max_prior_star_anomaly= 0.624508901782415 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6203527724340665
accuracies_anomaly['prior'][-1]= 0.49279306611002865
accuracies_anomaly['prior_star'][-1]= 0.624508901782415



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 131.14072728157043 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.40494721305299697
accuracies_anomaly["prior"][-1]= 0.508133162883525
accuracies_anomaly["prior_star"][-1]= 0.404946441088285


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 705.4484617710114 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 4e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0041599273681640625 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40484286915609846
 first_prior_anomaly_auc= 0.491584812675043
 first_prior_star_anomaly_auc= 0.40484274049531316


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.558452396024073; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5943447666453604; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 70 
last prior star auc 0.5585182703461593 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6135006849900211; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.582075288174427; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 70 
last prior star auc 0.613527575094154 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6295940906615943; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5677267800734294; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 70 
last prior star auc 0.6295942193223797 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4036741145822076; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.5530509589345651; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 70 
last prior star auc 0.40367282797435433 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.6324367220525616 at iter 340
0.5957267121405345 at iter 70
0.6324685012665368 at iter 340
last anomaly aucs:
0.40266335545269555
0.547762228693002
0.4026636127742662




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 104.87137722969055 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40500613969267574,first_prior_anomaly_auc= 0.5474823914849205, first_prior_star_anomaly_auc= 0.405007040318173


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40500613969267574 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5470365818637698 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.405007040318173 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40500613969267574 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.546275424657788 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40500729763974364 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40500613969267574 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5458252405699363 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050072976397436 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40500613969267574 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5457502313320921 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40500498174560784 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40500613969267574 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5442411689810169 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050071689789583 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40500613969267574 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5410664641031263 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050067829966023 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40500613969267574 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5334449851628382 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050069116573876 iter_best_prior_star_anomaly= 650
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40500613969267574 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5199558024470252 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050076836220996 iter_best_prior_star_anomaly= 650
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40500613969267574 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5064863048313669 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40500729763974364 iter_best_prior_star_anomaly= 840
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40500613969267574 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4895499136943452 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050083269260262 iter_best_prior_star_anomaly= 930
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40500613969267574 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4770343071410853 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050087129083822 iter_best_prior_star_anomaly= 930
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40500613969267574 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4719926056073458 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050088415691675 iter_best_prior_star_anomaly= 1180
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40500613969267574 at iter 0
max_prior_anomaly= 0.5474823914849205 at iter 0
max_prior_star_anomaly= 0.4050107714809474 at iter 118
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40500613969267574
accuracies_anomaly['prior'][-1]= 0.47019392782850444
accuracies_anomaly['prior_star'][-1]= 0.40500613969267574



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 132.63233518600464 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 4e-06 to 1e-08  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.0001 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40500613969267574
 first_prior_anomaly_auc= 0.47006127855883456
 first_prior_star_anomaly_auc= 0.4050060110318904


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4050060110318904; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47006307980982914; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 30 
last prior star auc 0.4050075549613143 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4050057537103197; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.47005510284113894; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 30 
last prior star auc 0.4050088415691675 ; count_not_improved_prior_star_anomaly= 13 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40500459576325176; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.47005677543134816; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 30 
last prior star auc 0.40500665433581706 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40500794094367026; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4700580620392014; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 30 
last prior star auc 0.40500897022995286 ; count_not_improved_prior_star_anomaly= 31 ; iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.4050081982652409 at iter 320
0.470063851774541 at iter 30
0.40501218674958595 at iter 320
last anomaly aucs:
0.4050045957632518
0.47005870534312805
0.40500665433581695




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 105.02653503417969 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.405001121922048,first_prior_anomaly_auc= 0.47005729007448943, first_prior_star_anomaly_auc= 0.40500459576325176


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.405001121922048 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4689316368636824 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050039524593252 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.405001121922048 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4675023441995086 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40500639701424634 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.405001121922048 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4653454747943229 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40500523906717845 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.405001121922048 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4633031134880763 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050000926357654 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.405001121922048 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4614410059420697 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049993206710535 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.405001121922048 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45931771700185375 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40500086460047735 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.405001121922048 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4578147017076889 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4050000926357654 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.405001121922048 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4576910586929917 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049986773671269 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.405001121922048 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45685090376482046 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049993206710535 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.405001121922048 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4554219970830026 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049989346886975 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.405001121922048 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4567843861388075 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049962328122057 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.405001121922048 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4597175947226434 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40499649013377637 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.405001121922048 at iter 0
max_prior_anomaly= 0.47005729007448943 at iter 0
max_prior_star_anomaly= 0.40500639701424634 at iter 20
last values
accuracies_anomaly['vanilla_star'][-1]= 0.405001121922048
accuracies_anomaly['prior'][-1]= 0.46309751355312706
accuracies_anomaly['prior_star'][-1]= 0.404997133437703



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 132.81901502609253 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.405001121922048
 first_prior_anomaly_auc= 0.4631986409303925
 first_prior_star_anomaly_auc= 0.4049970047769177


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40500433844168116; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.46320237209316684; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 80 
last prior star auc 0.40499970665340945 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4050027945122573; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.46320378736180545; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 200 
last prior star auc 0.4049977767416296 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4050002212965508; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.46320121414609894; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 240 
last prior star auc 0.4049958468298497 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:519:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4050036951377545; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.46320121414609894; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 370 
last prior star auc 0.4049945602219965 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:584:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:636:::  fit_feats end


max anomaly aucs:
0.405007040318173 at iter 50
0.4632077758461505 at iter 370
0.40500060727890674 at iter 30
last anomaly aucs:
0.40499970665340945
0.4631821723498709
0.40499404557885516




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 105.00385689735413 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.40499867736712686,first_prior_anomaly_auc= 0.4631837162792948, first_prior_star_anomaly_auc= 0.40499250164943124


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.40499867736712686 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46571884839333555 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049939169180698 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.40499867736712686 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4678247681275327 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049890278082275 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.40499867736712686 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4703279923668129 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40499082905922207 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.40499867736712686 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4731041061317672 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40499070039843676 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.40499867736712686 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4758070119098716 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049876125395889 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.40499867736712686 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47884675162395646 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049856826278091 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.40499867736712686 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4820748507277569 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40498349539445855 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.40499867736712686 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48692806421099544 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40498272342974656 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.40499867736712686 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4934070353775988 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049874838788036 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.40499867736712686 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5006676208150507 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40498169414346397 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.40499867736712686 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.509749142347205 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4049850393238824 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.40499867736712686 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5216855180449325 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.40498349539445855 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.40499867736712686 at iter 0
max_prior_anomaly= 0.5339371126667058 at iter 129
max_prior_star_anomaly= 0.4049955895082791 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.40499867736712686
accuracies_anomaly['prior'][-1]= 0.5339371126667058
accuracies_anomaly['prior_star'][-1]= 0.40498362405524385



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 132.6968638896942 seconds


/home/daniel.z/pieclam/clamiter.py:1278:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4048428691560985
accuracies_anomaly["prior"][-1]= 0.491584812675043
accuracies_anomaly["prior_star"][-1]= 0.40484274049531316


/home/daniel.z/pieclam/clamiter.py:1289:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam redditGGAD 
took 713.3917336463928 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return
