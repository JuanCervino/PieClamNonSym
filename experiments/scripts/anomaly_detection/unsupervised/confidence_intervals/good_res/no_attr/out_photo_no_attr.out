

/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0030727386474609375 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4584373204454274
 first_prior_anomaly_auc= 0.47873162335564157
 first_prior_star_anomaly_auc= 0.4584382634016076


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5371296330056456; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5266279300267842; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5371277470932851 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5415841580008993; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.536030355645353; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5415703279769231 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5415030637694024; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 240 
last prior auc 0.5463331996431016; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5415211894826439 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5426997799349821; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 240 
last prior auc 0.5529975948331031; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.5427207345167643 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5510818221936681 at iter 490
0.5529975948331031 at iter 400
0.5510899944805632 at iter 490
last anomaly aucs:
0.5510818221936681
0.5495773879946172
0.5510899944805632




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 55.52314615249634 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5520676304936103,first_prior_anomaly_auc= 0.5489469694017006, first_prior_star_anomaly_auc= 0.5520694116330618


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5520678400394281 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5520366177125727 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5520689925414262 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5520678400394281 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5556520164803596 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5520674209477925 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5520678400394281 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5602492421775498 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.552067944812337 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5520676304936103 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5660945227656863 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5520706689079687 iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5520676304936103 iter_best_vanilla_star_anomaly= 250 
last prior auc 0.5723463222403968 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5520708784537866 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5520676304936103 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.5804070259874532 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5520708784537866 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5520677352665193 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.590097472332618 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5520715070912401 iter_best_prior_star_anomaly= 660
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5520679448123371 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.602990302638643 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5520748598243252 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5520677352665193 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.614591178204888 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5520782125574103 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5520679448123371 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.6252269905071555 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5520815652904955 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5520675257207015 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.6332802553776791 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5520819843821312 iter_best_prior_star_anomaly= 1010
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5520677352665193 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.6391819037908095 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.552083241657038 iter_best_prior_star_anomaly= 1170
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5520682591310638 at iter 55
max_prior_anomaly= 0.6480885440044122 at iter 126
max_prior_star_anomaly= 0.5520863848443054 at iter 117
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5520677352665193
accuracies_anomaly['prior'][-1]= 0.6460958680498367
accuracies_anomaly['prior_star'][-1]= 0.5520834512028558



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.88716793060303 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5520675257207015
 first_prior_anomaly_auc= 0.6459770555711317
 first_prior_star_anomaly_auc= 0.5520844989319449


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5580776140945547; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6433404453183902; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5580957398077961 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.564213220413283; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6381949429888695; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5642295649870732 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5700429946109006; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6318026430433094; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5700585010014195 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5746808721967485; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.622660473330475; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5746988931370811 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.577791055997767 at iter 490
0.6459770555711317 at iter 0
0.5778167253604503 at iter 490
last anomaly aucs:
0.577791055997767
0.6123973382652037
0.5778167253604503




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.9386727809906 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5780346530109848,first_prior_anomaly_auc= 0.61137800263441, first_prior_star_anomaly_auc= 0.5780539312262244


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5780346530109848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6194900451068327 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5780614748756661 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5780346530109848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6193347716558268 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5780639894254799 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5780346530109848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6197233743749772 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.578069647162561 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5780346530109848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6172826894618989 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5780754096725511 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5780346530109848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6137631579057655 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5780848392343532 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5780346530109848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6102742200390342 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5780874585570759 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5780346530109848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6072030117601304 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.57809667857306 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5780346530109848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.603880977137294 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5781031744934124 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5780346530109848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.601177940860303 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5781105085970363 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5780346530109848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6001676156996756 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5781197286130204 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5780346530109848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5998241701042659 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.578124967258466 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5780346530109848 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5990830065466305 iter_best_prior_anomaly= 120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5781350254577213 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5780346530109848 at iter 0
max_prior_anomaly= 0.6205648056064402 at iter 12
max_prior_star_anomaly= 0.5781490650275154 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5780346530109848
accuracies_anomaly['prior'][-1]= 0.5982743692356565
accuracies_anomaly['prior_star'][-1]= 0.5781490650275154



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.78630900382996 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5780346530109848
 first_prior_anomaly_auc= 0.5981030655295873
 first_prior_star_anomaly_auc= 0.5781506366211492


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5799285281124573; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5965938117767264; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5800458737704375 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5800780390534732; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5942523468083867; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.580195803803089 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5791312062756457; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.591767447727748; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5792592387703348 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5776624996385336; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 170 
last prior auc 0.5889010704857649; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5777802643881493 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5802026140421681 at iter 170
0.5981030655295873 at iter 0
0.5803140924172493 at iter 160
last anomaly aucs:
0.5761831061647122
0.5859402928528531
0.5763019186434172




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.54898762702942 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5760224892953518,first_prior_anomaly_auc= 0.585593808843085, first_prior_star_anomaly_auc= 0.5761466451924112


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5760225940682608 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5856579298633384 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5761608943080232 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.576022384522443 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5865511189118033 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5761745147861816 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5760224892953518 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5860325977856036 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5761898116308826 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5760224892953519 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5860849842400591 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5761996602843201 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5760225940682608 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5867794190803202 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5762086707544865 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5760224892953518 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.588477787933765 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5762223960055538 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5760224892953519 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5894070188628954 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5762352830733498 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.576022384522443 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5900332465394555 iter_best_prior_anomaly= 780
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5762449221809696 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5760226988411696 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5904358888283999 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5762453412726053 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5760226988411697 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5935317187408978 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5762475415036925 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5760224892953518 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5964749992980215 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5762448174080608 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5760224892953518 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5962854651058018 iter_best_prior_anomaly= 1130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5762416742207934 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5760228036140786 at iter 16
max_prior_anomaly= 0.5965975836014472 at iter 113
max_prior_star_anomaly= 0.576250370372233 at iter 87
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5760224892953519
accuracies_anomaly['prior'][-1]= 0.5944655596780202
accuracies_anomaly['prior_star'][-1]= 0.576236330802439



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.76595497131348 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5520677352665193
accuracies_anomaly["prior"][-1]= 0.6460958680498367
accuracies_anomaly["prior_star"][-1]= 0.5520834512028558


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 508.9484860897064 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0032935142517089844 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46126587466729363
 first_prior_anomaly_auc= 0.49340108787806775
 first_prior_star_anomaly_auc= 0.46126828444419854


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5427659964134137; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5336863761271994; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5427601291305149 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5462679261208501; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.538808618870942; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 170 
last prior star auc 0.5462630017941312 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5574900476213825; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5323508358573127; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 170 
last prior star auc 0.5574967530875529 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5538232053553205; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5400642174113296; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 400 
last prior star auc 0.5538458363036454 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5588679161464691 at iter 280
0.543644726800449 at iter 490
0.558859953405392 at iter 280
last anomaly aucs:
0.5520195397284202
0.543644726800449
0.5520300170193113




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.28180551528931 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.552374719889628,first_prior_anomaly_auc= 0.5438012575263619, first_prior_star_anomaly_auc= 0.5523937885590497


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.552374719889628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5459475305654007 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5523932646945053 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5523745103438102 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5479760388548237 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5523923217383251 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.552374719889628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5505203441748149 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5523866640012438 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5523745103438102 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5549577911859161 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5523843589972479 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.552374719889628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5595514546042036 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5523832064952499 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5523745103438102 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5631199151087982 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.552381844447434 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.552374719889628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5635844781869089 iter_best_prior_anomaly= 670
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5523807967183448 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.552374719889628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5620386586888383 iter_best_prior_anomaly= 670
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5523791203518023 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.552374719889628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5581273812262872 iter_best_prior_anomaly= 670
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5523759771645349 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5523745103438102 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.541130805624042 iter_best_prior_anomaly= 670
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5523733578418122 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.552374719889628 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5144148663537729 iter_best_prior_anomaly= 670
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5523734626147211 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5523745103438102 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4964162426507043 iter_best_prior_anomaly= 670
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5523730435230854 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.552374719889628 at iter 0
max_prior_anomaly= 0.5638271322439465 at iter 67
max_prior_star_anomaly= 0.5523945219694122 at iter 15
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5523745103438102
accuracies_anomaly['prior'][-1]= 0.48589557577533
accuracies_anomaly['prior_star'][-1]= 0.5523732530689033



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.0871319770813 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.552374719889628
 first_prior_anomaly_auc= 0.4851882538672728
 first_prior_star_anomaly_auc= 0.5523724148856319


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5554394322481793; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.48475617039092445; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5554374415629101 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5593523860772729; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.48513429581918377; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5593544815354512 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5636445130637149; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4849526195951323; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 230 
last prior star auc 0.5636484944342535 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.568039946138343; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.48416085072249304; count_not_improved_prior_anomaly= 38; iter_best_prior_anomaly= 230 
last prior star auc 0.5680453943296063 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5717218757032883 at iter 490
0.4852640046804154 at iter 230
0.571723237751104 at iter 490
last anomaly aucs:
0.5717218757032883
0.48282981568768957
0.571723237751104




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.50374960899353 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.572100524996092,first_prior_anomaly_auc= 0.4825261837976659, first_prior_star_anomaly_auc= 0.5721084877371692


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5721003154502742 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47527495554485466 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5721093259204404 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5721003154502742 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4722614771387609 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5721112118328009 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.572100524996092 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4722032234014064 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5721139359284325 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5721003154502742 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4707532711149891 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.572121584350783 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.572100524996092 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47035984884202886 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5721179172989712 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.572100420223183 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.470547706667706 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.572118126844789 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5721003154502742 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4712887654524325 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5721179172989711 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5721003154502742 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47205737951220245 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5721189650280603 iter_best_prior_star_anomaly= 420
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5721003154502742 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4733087871362337 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5721247275380503 iter_best_prior_star_anomaly= 880
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5721004202231831 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4750540942528707 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5721289184544068 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.572100524996092 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47723714258293715 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5721332141436722 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.572100524996092 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48000733829454006 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5721420150680206 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.572100524996092 at iter 0
max_prior_anomaly= 0.4828376736558579 at iter 129
max_prior_star_anomaly= 0.5721461012114681 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5721003154502742
accuracies_anomaly['prior'][-1]= 0.4828376736558579
accuracies_anomaly['prior_star'][-1]= 0.5721461012114681



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.42494654655457 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.572100524996092
 first_prior_anomaly_auc= 0.4831957874585151
 first_prior_star_anomaly_auc= 0.5721483014425554


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5754561917226888; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4841223990649227; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5755215700178491 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5766258764777695; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.48435562356015827; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 200 
last prior star auc 0.5767161907252506 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5759748176217974; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.483986927693701; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 220 
last prior star auc 0.5760691132398172 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5739633873165269; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4828501416320183; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 220 
last prior star auc 0.574043224273117 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5766694620078764 at iter 220
0.48437615905030484 at iter 220
0.5767490894186487 at iter 220
last anomaly aucs:
0.5711914104654725
0.4815656257687712
0.5712652753662546




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.44871926307678 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5708537273800528,first_prior_anomaly_auc= 0.4814052184452287, first_prior_star_anomaly_auc= 0.5709293734202865


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5708536226071439 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4844506525885405 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5709442511733518 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5708537273800529 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.48593758971180323 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5709553571016963 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5708533082884172 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4873380891852146 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5709651009822251 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5708536226071439 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.489006492986711 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5709809216914705 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5708537273800527 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4914128123856666 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5709930753489043 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5708536226071439 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.49236572199221074 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5710108867434192 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.570853517834235 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.49303920225068976 iter_best_prior_anomaly= 680
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5710349845124686 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5708537273800528 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.49360466164008165 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5710523768153478 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.570853517834235 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.49373122731404584 iter_best_prior_anomaly= 840
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5710773127676685 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5708537273800528 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.49333288071436676 iter_best_prior_anomaly= 840
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5710913523374626 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5708535178342351 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.4935144521655093 iter_best_prior_anomaly= 840
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5711037155407142 iter_best_prior_star_anomaly= 1080
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5708537273800528 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.49433943405027336 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5711152405606943 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5708539369258707 at iter 33
max_prior_anomaly= 0.49513445088308894 at iter 129
max_prior_star_anomaly= 0.5711248796683142 at iter 126
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5708536226071439
accuracies_anomaly['prior'][-1]= 0.49513445088308894
accuracies_anomaly['prior_star'][-1]= 0.5711244605766785



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.49259495735168 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5523745103438102
accuracies_anomaly["prior"][-1]= 0.48589557577533
accuracies_anomaly["prior_star"][-1]= 0.5523732530689033


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 515.4022443294525 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003489971160888672 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.47451095149307687
 first_prior_anomaly_auc= 0.516938007546164
 first_prior_star_anomaly_auc= 0.47451084672016786


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5459418728283195; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5384148822792549; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 30 
last prior star auc 0.5459252139358026 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5469011735823073; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5371932301613546; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 30 
last prior star auc 0.5468679605701825 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5649179229986174; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5281415842418192; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 30 
last prior star auc 0.5649112175324471 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5571142271971194; count_not_improved_vanilla_star_anomaly= 21 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.5382301676408452; count_not_improved_prior_anomaly= 37; iter_best_prior_anomaly= 30 
last prior star auc 0.5570997685356897 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5658976544698429 at iter 270
0.5421540178524655 at iter 30
0.5658728232904309 at iter 270
last anomaly aucs:
0.5631099616824518
0.5392196429925993
0.5630945600648418




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.38937854766846 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5641082379585544,first_prior_anomaly_auc= 0.5388918085606172, first_prior_star_anomaly_auc= 0.5640933602054891


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5641082379585544 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5449774382017952 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5640950365720316 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5641082379585544 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5520665827645213 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5640982845322078 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5641082379585544 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5601687765835063 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641004847632949 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5641084475043722 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5693600847906197 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641022659027464 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5641082379585544 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5802200063450473 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641042565880158 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5641085522772811 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.592378588105425 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641050947712871 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5641084475043722 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6067029306658989 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641111716000038 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5641084475043722 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.6224038844765523 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641126384207287 iter_best_prior_star_anomaly= 780
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.56410865705019 iter_best_vanilla_star_anomaly= 870 
last prior auc 0.6401234979231913 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641176675203563 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5641085522772811 iter_best_vanilla_star_anomaly= 870 
last prior auc 0.66097435452554 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641242682136178 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5641084475043722 iter_best_vanilla_star_anomaly= 870 
last prior auc 0.6840224038006582 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641324405005128 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5641083427314633 iter_best_vanilla_star_anomaly= 870 
last prior auc 0.7059950639387154 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5641382030105029 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5641089713689167 at iter 87
max_prior_anomaly= 0.7078417912311782 at iter 125
max_prior_star_anomaly= 0.5641472134806691 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5641088665960078
accuracies_anomaly['prior'][-1]= 0.7033295363631145
accuracies_anomaly['prior_star'][-1]= 0.5641472134806691



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.67964720726013 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5641087618230989
 first_prior_anomaly_auc= 0.7039613170038468
 first_prior_star_anomaly_auc= 0.5641490993930296


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.570096638340263; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.7031414689916194; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.570144833878362 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5762681817667479; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.7004457668182521; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5763182632172072 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5816829504721696; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6967018116912318; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5817309364644507 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5859292916974175; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6945465281820267; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5859810495144194 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5886322232014997 at iter 490
0.7039613170038468 at iter 0
0.588684819201773 at iter 490
last anomaly aucs:
0.5886322232014997
0.6919488934513999
0.588684819201773




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.44611859321594 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5888404069715055,first_prior_anomaly_auc= 0.6917086491712672, first_prior_star_anomaly_auc= 0.588884516366157


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5888401974256877 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6957455493516024 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5888966700235907 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5888403021985966 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6900004316643846 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5889065186770284 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5888405117444144 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.6816178655411541 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5889182532428263 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5888406165173234 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6763035740553778 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5889307212189867 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5888403021985966 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6757047968809524 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5889438178326005 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5888401974256877 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6736930522569551 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5889589051314837 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5888405117444144 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6722890952775497 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5889693824223748 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5888405117444144 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.671078234769267 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5889813265339906 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5888405117444144 iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6699489923570258 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5889924324623352 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5888403021985966 iter_best_vanilla_star_anomaly= 940 
last prior auc 0.6685300528516461 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5890073102154005 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5888403021985966 iter_best_vanilla_star_anomaly= 940 
last prior auc 0.6672516138171161 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5890305698011786 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5888403021985966 iter_best_vanilla_star_anomaly= 940 
last prior auc 0.6661100082016232 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.589051314837143 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5888407212902322 at iter 94
max_prior_anomaly= 0.6963818352274179 at iter 8
max_prior_star_anomaly= 0.5890705930523826 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5888403021985966
accuracies_anomaly['prior'][-1]= 0.6650009869608019
accuracies_anomaly['prior_star'][-1]= 0.5890705930523826



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.29208707809448 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5888406165173233
 first_prior_anomaly_auc= 0.6648952710957109
 first_prior_star_anomaly_auc= 0.589071431235654


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5901431533209032; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6678231500352246; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5904016280871861 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5900518961172417; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.6699542310024714; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5903119424771585 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5888350635531511; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.6723301662578428; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5891169026781212 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5860346932437819; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.6749358685024556; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.5862997687033262 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.590280720150303 at iter 150
0.6771375664103083 at iter 490
0.5905271460320614 at iter 150
last anomaly aucs:
0.5820559420278922
0.6771375664103083
0.5823223795352525




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.85739278793335 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5815986082804964,first_prior_anomaly_auc= 0.6773655522600984, first_prior_star_anomaly_auc= 0.58188107604292


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5815985035075875 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6756626781715702 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5819053833577874 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5815985035075875 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6743150890171589 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5819290620352011 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5815986082804964 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6729833205719932 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5819512738918903 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5815983987346786 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6717772796175202 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5819808198522031 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5815987130534053 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6705262910851246 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5820059653503417 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5815986082804963 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6690734051572579 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5820281772070308 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5815986082804964 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6670531739276387 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5820426358684605 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5815987130534053 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6640278561828379 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5820577231673436 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5815983987346786 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6611371716259875 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5820648477251497 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5815979796430429 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6569053938350783 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5820642190876961 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5815985035075875 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.6523599259548898 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5820694577331417 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5815986082804963 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.647006344628272 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.582067990912417 iter_best_prior_star_anomaly= 1120
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5815987130534053 at iter 8
max_prior_anomaly= 0.6773655522600984 at iter 0
max_prior_star_anomaly= 0.5820715531913199 at iter 112
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5815983987346784
accuracies_anomaly['prior'][-1]= 0.6421988397028975
accuracies_anomaly['prior_star'][-1]= 0.5820694577331418



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.29328656196594 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5641088665960078
accuracies_anomaly["prior"][-1]= 0.7033295363631145
accuracies_anomaly["prior_star"][-1]= 0.5641472134806691


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 515.1220991611481 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003552675247192383 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4653912031827495
 first_prior_anomaly_auc= 0.4998517463338911
 first_prior_star_anomaly_auc= 0.4653948702345614


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5434971017717938; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5345059098207; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5434812810625481 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5436504893104392; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5374471996925544; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 180 
last prior star auc 0.5436381261071876 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5444601743505022; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5383379789641145; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 300 
last prior star auc 0.544493492135536 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5346052345383475; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5564756363173078; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 400 
last prior star auc 0.5346295418532148 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 270
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5462552485988719 at iter 260
0.562573838707555 at iter 490
0.5462639447503115 at iter 270
last anomaly aucs:
0.5342552930225852
0.562573838707555
0.534297830823603




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.36280536651611 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.534304955381409,first_prior_anomaly_auc= 0.5628821853784796, first_prior_star_anomaly_auc= 0.5343395304413496


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.534304955381409 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5703749151863302 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5343376445289891 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.534304955381409 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5789542448324954 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5343365967999001 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.534304955381409 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5882059022351415 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5343321963377259 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.534304955381409 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5984238801766721 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5343301008795476 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.534304955381409 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.609362486185692 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.534329681787912 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.534304955381409 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6207577973046541 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5343280054213694 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.534304955381409 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.6318143776091074 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5343252813257378 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.534304955381409 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.6409392597919713 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5343271672380981 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.534304955381409 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.6503969007335362 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5343254908715556 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.534304955381409 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.6557509011517896 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5343224524571971 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.534304955381409 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.6509102879871993 iter_best_prior_anomaly= 1020
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.534329681787912 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.534304955381409 iter_best_vanilla_star_anomaly= 650 
last prior auc 0.6386103675727008 iter_best_prior_anomaly= 1020
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5343275863297338 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5343051649272269 at iter 65
max_prior_anomaly= 0.6580439610362123 at iter 102
max_prior_star_anomaly= 0.5343409972620743 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.534304955381409
accuracies_anomaly['prior'][-1]= 0.6366062713710541
accuracies_anomaly['prior_star'][-1]= 0.5343321963377259



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.9278953075409 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.534304955381409
 first_prior_anomaly_auc= 0.6365698103987532
 first_prior_star_anomaly_auc= 0.5343336631584505


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5345350366893773; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.6388325909125008; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5345652112871435 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.534992475209682; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6403361869282804; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5350245357198088 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.535522521355862; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6410615297766703; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5355634875632462 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5358208098275312; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6411361280878148; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 340 
last prior star auc 0.5358822067521529 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5364115194879706 at iter 490
0.6424560571942737 at iter 490
0.536469877998234 at iter 490
last anomaly aucs:
0.5364115194879706
0.6424560571942737
0.536469877998234




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.37623357772827 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5365331608352162,first_prior_anomaly_auc= 0.6425977101671212, first_prior_star_anomaly_auc= 0.5365911002538438


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5365334751539428 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6446459157634196 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5365984343574676 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5365334751539429 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6454054145801142 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5366005298156458 iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5365334751539429 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6473227588131827 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5366045111861844 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.536533265608125 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6486513840710814 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5366105880149012 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5365330560623072 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6492155861855662 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5366151980228933 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5365330560623072 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6496628617337067 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5366263039512379 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.536533265608125 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.6499888102533282 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5366290280468695 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5365331608352161 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.6502261208920114 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5366430676166636 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.536533265608125 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.650456830837433 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5366592026446358 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5365331608352161 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.6508614638116468 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5366686322064378 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5365334751539429 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.651071533494013 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.536683719505321 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5365334751539429 iter_best_vanilla_star_anomaly= 740 
last prior auc 0.6512613820049595 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5367102270512755 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5365336846997607 at iter 74
max_prior_anomaly= 0.6514185413683258 at iter 129
max_prior_star_anomaly= 0.5367411350594041 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5365334751539429
accuracies_anomaly['prior'][-1]= 0.6514185413683258
accuracies_anomaly['prior_star'][-1]= 0.5367411350594041



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.01655697822571 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5365334751539428
 first_prior_anomaly_auc= 0.6514069115754367
 first_prior_star_anomaly_auc= 0.5367421827884933


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5378795974876294; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.652205700232973; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5381348242937363 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5399819706778346; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.6530603328509588; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5402445315875652 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5431515607182058; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.6537152683045606; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 290 
last prior star auc 0.5434231320981027 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5466296022024104; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.6537268980974498; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 400 
last prior star auc 0.5468940490245013 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5498614273506744 at iter 490
0.6540899362268258 at iter 490
0.5501654783323339 at iter 490
last anomaly aucs:
0.5498614273506744
0.6540899362268258
0.5501654783323339




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.39209842681885 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.550204034762813,first_prior_anomaly_auc= 0.6541221015098614, first_prior_star_anomaly_auc= 0.5504932079914069


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5502038252169952 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6542925670326594 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5505194012186346 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.550204034762813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.6541992143708198 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5505569099200247 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5502038252169952 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.6540823925773842 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5506028004541277 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.550204034762813 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.6542071771118971 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5506465955300524 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.550204034762813 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.6539122413733129 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5506960483430583 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5502039299899041 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.6544682712009029 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5507425675146148 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5502038252169952 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.6555710060671897 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5507930680567098 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.550204034762813 iter_best_vanilla_star_anomaly= 230 
last prior auc 0.6556878278606252 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5508389585908127 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.550204034762813 iter_best_vanilla_star_anomaly= 850 
last prior auc 0.6551254068855916 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5508940691408999 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.550204034762813 iter_best_vanilla_star_anomaly= 850 
last prior auc 0.654230541470584 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.550945617412084 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5502038252169952 iter_best_vanilla_star_anomaly= 850 
last prior auc 0.6545060942210197 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5509981086394483 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.550204034762813 iter_best_vanilla_star_anomaly= 850 
last prior auc 0.6547628926207603 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.551043265763189 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5502042443086308 at iter 85
max_prior_anomaly= 0.6557170595022113 at iter 76
max_prior_star_anomaly= 0.5510862226558424 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5502038252169952
accuracies_anomaly['prior'][-1]= 0.6548100404297701
accuracies_anomaly['prior_star'][-1]= 0.5510862226558424



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.62551927566528 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.534304955381409
accuracies_anomaly["prior"][-1]= 0.6366062713710541
accuracies_anomaly["prior_star"][-1]= 0.5343321963377259


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 513.8668706417084 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003317594528198242 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4571943994270179
 first_prior_anomaly_auc= 0.4867916984652445
 first_prior_star_anomaly_auc= 0.4571934564708377


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5401383966308385; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5324780301687305; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5401156609096048 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5435991505850728; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5382706099836848; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5435957978519877 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.548905269783954; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5428821895693958; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.548914699345756 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5525869898030814; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.541347266453852; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 310 
last prior star auc 0.5525941143608875 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5544553003147796 at iter 490
0.5429814095141345 at iter 310
0.5544529953107837 at iter 490
last anomaly aucs:
0.5544553003147796
0.5422511423390258
0.5544529953107837




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.392282009124756 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5548706201257023,first_prior_anomaly_auc= 0.5422601528091922, first_prior_star_anomaly_auc= 0.5548708296715201


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5548706201257023 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5394350560933199 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5548688389862508 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5548706201257023 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5355327891009353 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5548655910260746 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5548704105798845 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5301172869851511 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5548662196635281 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5548706201257023 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5229980725975677 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5548664292093459 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5548706201257023 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5119179183886094 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5548649623886212 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5548704105798845 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4912249545599894 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.554859409424449 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5548706201257023 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4632927065901741 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.554855742372637 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5548704105798845 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42396001362886 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5548539612331855 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5548704105798845 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3724545945644653 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5548551137351836 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5548704105798845 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3228775208885748 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5548523896395519 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5548704105798845 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3059316553742425 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5548484082690133 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5548704105798845 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.31313102103714285 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5548446364442925 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5548706201257023 at iter 0
max_prior_anomaly= 0.5422601528091922 at iter 0
max_prior_star_anomaly= 0.5548708296715201 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5548706201257023
accuracies_anomaly['prior'][-1]= 0.32603160453842717
accuracies_anomaly['prior_star'][-1]= 0.5548396073446648



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.38981771469116 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5548706201257023
 first_prior_anomaly_auc= 0.32679927564201694
 first_prior_star_anomaly_auc= 0.5548387691613934


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5583935044149209; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.3247603948346118; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5583522238888099 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5634418822578814; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.32263015205063633; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5633980871819566 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5686415521813091; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.3201011435753462; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5686061389380972 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5726876723776284; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.31588204330641506; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5726401054769829 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5754809181291918 at iter 490
0.32679927564201694 at iter 0
0.5754431998819838 at iter 490
last anomaly aucs:
0.5754809181291918
0.31051861332635966
0.5754431998819838




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.4800341129303 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5757057607917144,first_prior_anomaly_auc= 0.30995944031150247, first_prior_star_anomaly_auc= 0.5756567270703441


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5757057607917144 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.32224720706856713 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5756525361539877 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5757058655646233 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.3307659779733818 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5756479261459956 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5757059703375322 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.33731962819866457 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5756444686400015 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5757059703375322 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.3430569926906228 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5756447829587282 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5757059703375322 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.34754410206054787 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5756401729507362 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5757059703375322 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.3509599084368594 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5756336770303837 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5757059703375322 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.3535496851993179 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5756294861140273 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5757059703375322 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.35531552780610137 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5756252951976708 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5757059703375322 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.3566502298927167 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5756185897315005 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5757059703375322 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.35774940248010045 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5756054931178867 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5757059703375322 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.35884888938621096 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.575596796966447 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5757059703375322 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.3596617176135414 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5755867387671917 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.57570617988335 at iter 6
max_prior_anomaly= 0.3601562457436005 at iter 129
max_prior_star_anomaly= 0.5756567270703441 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5757059703375322
accuracies_anomaly['prior'][-1]= 0.3601562457436005
accuracies_anomaly['prior_star'][-1]= 0.5755779378428432



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.0359537601471 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.575706075110441
 first_prior_anomaly_auc= 0.3601899826202698
 first_prior_star_anomaly_auc= 0.5755762614763006


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5774018246411633; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.3607156283042756; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.5772664580428504 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5775038734544424; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.36063118133969346; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 100 
last prior star auc 0.5773813939239256 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5759471575738451; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.36014660663598075; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 100 
last prior star auc 0.5758092764257183 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5730516534631847; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 150 
last prior auc 0.35915262604914355; count_not_improved_prior_anomaly= 31; iter_best_prior_anomaly= 100 
last prior star auc 0.5728571949442463 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5776788442123235 at iter 150
0.3607156283042756 at iter 100
0.5775394962434721 at iter 150
last anomaly aucs:
0.5694675817951622
0.3577622895478965
0.5692716564554989




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.45407176017761 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5690516333467861,first_prior_anomaly_auc= 0.35756049692533426, first_prior_star_anomaly_auc= 0.568871947808004


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.569051738119695 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.3583098327698646 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5688611561983863 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5690516333467861 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.35854661954400313 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5688460688995031 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5690516333467861 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.3590271081042683 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5688276288675348 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.569051738119695 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.3591152221206623 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5688114938395624 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5690516333467861 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.3578132091816272 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5687945206283189 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5690516333467861 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.356110439866008 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5687781760545289 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5690516333467861 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.354358112964474 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5687689560385447 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5690516333467861 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.35201099025905314 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5687553355603863 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5690516333467861 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.34990233069431326 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5687398291698675 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5690518428926039 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.34766427658706855 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.568716883902816 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.569051842892604 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.34594180996457413 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5687021109226597 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5690516333467861 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.34458604852326774 iter_best_prior_anomaly= 380
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5686878618070477 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.569051842892604 at iter 7
max_prior_anomaly= 0.3592141277466742 at iter 38
max_prior_star_anomaly= 0.5688724716725486 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5690516333467861
accuracies_anomaly['prior'][-1]= 0.34304986813281685
accuracies_anomaly['prior_star'][-1]= 0.5686761272412497



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.89530992507935 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5548706201257023
accuracies_anomaly["prior"][-1]= 0.32603160453842717
accuracies_anomaly["prior_star"][-1]= 0.5548396073446648


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 515.8112454414368 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0035431385040283203 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.47040584414904074
 first_prior_anomaly_auc= 0.5189506951263414
 first_prior_star_anomaly_auc= 0.47040710142394765


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5485224295747938; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5412156716802599; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.5485134191046275 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5475803115778675; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5395752422454427; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 20 
last prior star auc 0.5475578901753606 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5525781888787329; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 240 
last prior auc 0.5390051728480588; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 20 
last prior star auc 0.5525794461536399 ; count_not_improved_prior_star_anomaly= 16 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5538513892678175; count_not_improved_vanilla_star_anomaly= 26 ;iter_best_vanilla_star_anomaly= 240 
last prior auc 0.5446770542719477; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 400 
last prior star auc 0.553855580184174 ; count_not_improved_prior_star_anomaly= 26 ; iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5620169706966938 at iter 490
0.5447678923839734 at iter 410
0.5620079602265273 at iter 490
last anomaly aucs:
0.5620169706966938
0.5426018172651504
0.5620079602265273




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.342862606048584 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5630654331961646,first_prior_anomaly_auc= 0.5420972309358358, first_prior_star_anomaly_auc= 0.5630563179530894


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5630657475148914 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5447855990055794 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630540129490933 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5630654331961646 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5474999507567327 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630584134112676 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5630656427419825 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5498724285061102 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630616613714439 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5630655379690735 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5523631948696478 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630613470527172 iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5630654331961646 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5553876744311774 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630642806941666 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5630656427419825 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5594564255758214 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630671095627072 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5630655379690735 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5641762355764375 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.563068576383432 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5630657475148914 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5692533211964396 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630716147977904 iter_best_prior_star_anomaly= 780
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5630654331961646 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5685760691132398 iter_best_prior_anomaly= 840
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630688907021586 iter_best_prior_star_anomaly= 780
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5630654331961646 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.566609586385892 iter_best_prior_anomaly= 840
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630716147977903 iter_best_prior_star_anomaly= 780
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5630653284232557 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5641926849231365 iter_best_prior_anomaly= 840
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.563073291164333 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5630656427419825 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.5572404785523569 iter_best_prior_anomaly= 840
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5630741293476043 iter_best_prior_star_anomaly= 1170
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5630659570607092 at iter 8
max_prior_anomaly= 0.5695472092059345 at iter 84
max_prior_star_anomaly= 0.5630775868535983 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5630657475148914
accuracies_anomaly['prior'][-1]= 0.5381687707162235
accuracies_anomaly['prior_star'][-1]= 0.5630775868535983



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.03506326675415 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5630656427419825
 first_prior_anomaly_auc= 0.5362786674394716
 first_prior_star_anomaly_auc= 0.5630781107181428


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5694147762490712; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5388155338829301; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.569443274480295 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5756718143692273; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5412035180228263; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.575693188042645 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5810506459668926; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5434199889108353; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5810745341901242 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5844869878333507; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.546324503491662; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.5845106665107647 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5857321090828473 at iter 490
0.5479656663368415 at iter 490
0.5857564163977146 at iter 490
last anomaly aucs:
0.5857321090828473
0.5479656663368415
0.5857564163977146




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.474404096603394 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5857656364136987,first_prior_anomaly_auc= 0.5482160735891385, first_prior_star_anomaly_auc= 0.5857861719038453


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5857658459595165 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.540020317562496 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5857954966927383 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5857656364136988 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.5356407051971135 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5858044023899958 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5857658459595165 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.5335873657282786 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5858150892267047 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5857656364136987 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.5359035804255708 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5858259856092314 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5857654268678809 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.5407809688811889 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5858329006212195 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5857659507324255 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.5452716405300169 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5858433779121106 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5857658459595165 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.5488609508434849 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5858561602069977 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5857657411866077 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.5506681787492881 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5858622370357146 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5857658459595166 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.5516019149135016 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5858754384222373 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5857656364136987 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.551385139764965 iter_best_prior_anomaly= 940
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5858842393465858 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5857658459595166 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.548229589294388 iter_best_prior_anomaly= 940
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5858928307251166 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5857658459595166 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.5423729932320892 iter_best_prior_anomaly= 940
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5858915734502096 iter_best_prior_star_anomaly= 1160
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5857660555053344 at iter 14
max_prior_anomaly= 0.551805907767151 at iter 94
max_prior_star_anomaly= 0.5858955548207482 at iter 124
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5857658459595166
accuracies_anomaly['prior'][-1]= 0.5359691682665491
accuracies_anomaly['prior_star'][-1]= 0.5858947166374769



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.42988061904907 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5857656364136988
 first_prior_anomaly_auc= 0.5352364913145353
 first_prior_star_anomaly_auc= 0.5858945070916591


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5849993273579248; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5352239185654661; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 40 
last prior star auc 0.5851612015021921 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5823624027864565; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5343972603141595; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 40 
last prior star auc 0.582539259456698 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5782944898250837; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5319196953371446; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 40 
last prior star auc 0.5784767946865886 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5729607105782502; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.528763621002023; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 40 
last prior star auc 0.5731329572404995 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5857912010034729 at iter 10
0.535383802024464 at iter 40
0.5859362067094056 at iter 20
last anomaly aucs:
0.567346559027171
0.52556919978224
0.5675024611156303




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.33863091468811 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5667566875500029,first_prior_anomaly_auc= 0.5251839497961748, first_prior_star_anomaly_auc= 0.5669092369053771


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.566756478004185 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5191980639642799 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.566922228746082 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5667562684583672 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5116632154470472 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5669226478377176 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.566756478004185 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5047699962239843 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5669314487620661 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.566756478004185 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4985213399365412 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5669322869453375 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.566756478004185 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4937198070669746 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5669364778616939 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5667566875500029 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.489913826377879 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5669409830967771 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.566756478004185 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4866962503452268 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5669368969533295 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.566756478004185 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.483979907908804 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5669287246664345 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5667562684583671 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4805676638113954 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5669226478377176 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.566756478004185 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47700569922715313 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5669247432958959 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.566756478004185 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4736634434328969 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5669193998775415 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.566756478004185 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47083939444611383 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5668985500686681 iter_best_prior_star_anomaly= 630
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5667566875500029 at iter 0
max_prior_anomaly= 0.5251839497961748 at iter 0
max_prior_star_anomaly= 0.5669471646984028 at iter 63
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5667566875500029
accuracies_anomaly['prior'][-1]= 0.46923898826250054
accuracies_anomaly['prior_star'][-1]= 0.5668905873275909



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.78295564651489 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5630657475148914
accuracies_anomaly["prior"][-1]= 0.5381687707162235
accuracies_anomaly["prior_star"][-1]= 0.5630775868535983


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 515.5699393749237 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003541231155395508 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46469833993612203
 first_prior_anomaly_auc= 0.4938276183902439
 first_prior_star_anomaly_auc= 0.46470012107557357


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5403581054208246; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5333523600935915; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.540354019277377 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5283811998844984; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5407228199167433; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 200 
last prior star auc 0.5283781614701399 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5318390201972832; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5635404735651665; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 300 
last prior star auc 0.5318618606914258 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5426743201181168; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5599289513950094; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 310 
last prior star auc 0.5426932840146297 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5496657115568291 at iter 490
0.5635477028958813 at iter 310
0.5496659211026469 at iter 490
last anomaly aucs:
0.5496657115568291
0.554923949536338
0.5496659211026469




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.53509449958801 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5504566422461971,first_prior_anomaly_auc= 0.5543141712064767, first_prior_star_anomaly_auc= 0.5504730915928961


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5504565374732882 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.553110540028909 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5504707865889 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.550456747019106 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5510123577550602 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5504686911307217 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5504564327003793 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5487927436797838 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5504684815849039 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5504565374732882 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5458329090030523 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5504656527163634 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.550456747019106 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5407495370085156 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.550462509529096 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.550456747019106 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5323520931322197 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5504619856645515 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5504565374732882 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5192242571915078 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5504596806605555 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5504563279274703 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4994412460767784 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5504575852023772 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5504563279274703 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.47539450143392203 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5504561183816525 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5504566422461971 iter_best_vanilla_star_anomaly= 960 
last prior auc 0.42879716928745615 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5504529751943852 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5504564327003793 iter_best_vanilla_star_anomaly= 960 
last prior auc 0.3905464661564645 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5504445933616723 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.550456851792015 iter_best_vanilla_star_anomaly= 960 
last prior auc 0.3658882668172043 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5504384117600466 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5504569565649238 at iter 96
max_prior_anomaly= 0.5543141712064767 at iter 0
max_prior_star_anomaly= 0.5504730915928961 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.550456747019106
accuracies_anomaly['prior'][-1]= 0.35185959340567696
accuracies_anomaly['prior_star'][-1]= 0.5504295060627891



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.96028184890747 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5504564327003791
 first_prior_anomaly_auc= 0.35176267846493436
 first_prior_star_anomaly_auc= 0.5504292965169713


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5554871039217338; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.35457635493373535; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5554611202403239 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5601945507190984; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.35657573635448114; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5601629093006073 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5642021144849385; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.3572396822782492; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.5641669107875444 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5672638932020403; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.3585796230103101; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 400 
last prior star auc 0.5672310992815511 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.569395078942196 at iter 490
0.35885538530656336 at iter 430
0.5693579893324415 at iter 490
last anomaly aucs:
0.569395078942196
0.3586107405642567
0.5693579893324415




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.8075315952301 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5695603058195483,first_prior_anomaly_auc= 0.35849580468318143, first_prior_star_anomaly_auc= 0.5695296073572376


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5695602010466394 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.35920281227251183 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5695245782576097 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5695602010466395 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.3600823808428184 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5695174536998038 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5695604105924573 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.3594244069748582 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5695110625523603 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5695604105924573 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.3574580290204194 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5695069764089127 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5695603058195484 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.3548009880504402 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5694996423052889 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5695605153653662 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.3519026550712393 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5694876981936732 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5695604105924572 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.3484772095873079 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5694801545442316 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5695604105924572 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.34610557002120185 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5694690486158871 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5695603058195483 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.3444918576781569 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5694546947273662 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5695604105924572 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.3436921260644404 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5694437983448395 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5695599915008216 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.3435572833306721 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5694239962650554 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5695603058195483 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.34383576972255714 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5694140428387088 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5695608296840929 at iter 7
max_prior_anomaly= 0.36018778238918275 at iter 21
max_prior_star_anomaly= 0.5695296073572376 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5695605153653661
accuracies_anomaly['prior'][-1]= 0.34434643288058864
accuracies_anomaly['prior_star'][-1]= 0.5694024130458197



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.28503274917603 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5695602010466394
 first_prior_anomaly_auc= 0.34441841186901045
 first_prior_star_anomaly_auc= 0.569400946225095


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5706279417613499; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.34656248467696205; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5704321211945955 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5702797813850392; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.34803559177624865; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5700958001569918 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5686061389380972; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.34904287852251764; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5683848585544775 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5657961295211082; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.348943658577779; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 330 
last prior star auc 0.5655817641494766 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5706601070443856 at iter 120
0.3490807015426344 at iter 330
0.5704870221988648 at iter 120
last anomaly aucs:
0.5625066792729431
0.3483339850208268
0.5622862370725946




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.88580012321472 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5621500322910105,first_prior_anomaly_auc= 0.3482562435224149, first_prior_star_anomaly_auc= 0.5619279137241195


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5621500322910106 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.34931843127295314 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5619116739232384 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5621500322910106 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.349722854701349 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5618941768474502 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5621500322910105 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.34959063129030354 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5618808706880185 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5621502418368284 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.3494835533773966 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.561857925420967 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5621500322910105 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.3487822035251474 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5618436763053551 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5621502418368283 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.34780341501010215 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5618196833092146 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5621498227451928 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.34593175176531876 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5618007194127017 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5621499275181016 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.3452672819770061 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5617810221058265 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5621500322910106 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.344671543216939 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5617738975480205 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5621499275181016 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.344311962593557 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5617571338825949 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5621500322910105 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.34463801588608756 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5617282165597355 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5621501370639194 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.34556955181921395 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5617126053963077 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5621503466097373 at iter 53
max_prior_anomaly= 0.3497606777214658 at iter 22
max_prior_star_anomaly= 0.5619279137241195 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5621500322910105
accuracies_anomaly['prior'][-1]= 0.34684306652702535
accuracies_anomaly['prior_star'][-1]= 0.5617011851492364



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.350332736969 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.550456747019106
accuracies_anomaly["prior"][-1]= 0.35185959340567696
accuracies_anomaly["prior_star"][-1]= 0.5504295060627891


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 515.986891746521 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0036454200744628906 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.46041040386603654
 first_prior_anomaly_auc= 0.4796739508983858
 first_prior_star_anomaly_auc= 0.4604101943202187


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5402249390535989; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5297380090548939; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.540209537435989 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5421907931434933; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5355735457625016; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5421660667369903 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5396081409388407; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5472688217196755; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5396219709628169 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5406321913505354; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5563690822689453; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.540669071414472 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.546816936163543 at iter 490
0.5564523767315295 at iter 410
0.5468366334704182 at iter 490
last anomaly aucs:
0.546816936163543
0.5541137406317304
0.5468366334704182




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.93879818916321 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5475979134265645,first_prior_anomaly_auc= 0.5536128213542275, first_prior_star_anomaly_auc= 0.5476158295939881


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5475979134265645 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5561115504588425 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5476148866378081 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5475984372911089 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5591462977654453 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5476165630043506 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5475983325182001 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5627182157760341 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.547613838908719 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5475982277452912 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5672542540944205 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5476116386776317 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5475982277452912 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5737721767577646 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5476116386776317 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5475981229723823 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5818701796603933 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5476105909485427 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5475983325182001 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5925896007439715 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.547611533904723 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5475979134265645 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.6046526296114225 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5476117434505406 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5475985420640179 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.6125889679156017 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5476122673150852 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5475983325182001 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.6103515424458104 iter_best_prior_anomaly= 920
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5476098575381803 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5475982277452912 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5852018533908495 iter_best_prior_anomaly= 920
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5476094384465446 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5475982277452912 iter_best_vanilla_star_anomaly= 150 
last prior auc 0.5705195018006273 iter_best_prior_anomaly= 920
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5476059809405506 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5475985420640179 at iter 15
max_prior_anomaly= 0.6130723901173164 at iter 92
max_prior_star_anomaly= 0.5476165630043506 at iter 20
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5475981229723823
accuracies_anomaly['prior'][-1]= 0.5440715716313519
accuracies_anomaly['prior_star'][-1]= 0.547604409346917



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.90277147293091 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5475983325182001
 first_prior_anomaly_auc= 0.541221329417341
 first_prior_star_anomaly_auc= 0.5476035711636457


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5524061517623012; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5467383564818598; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5524164195073745 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5576428065225747; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5524364311329765; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5576496167616538 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.562989682383022; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5563793500140186; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5629981689886439 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5676340558892223; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5603170302496152; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.567646209546656 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5711160787439656 at iter 490
0.5651027424099362 at iter 490
0.5711292801304884 at iter 490
last anomaly aucs:
0.5711160787439656
0.5651027424099362
0.5711292801304884




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.85191488265991 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5714463229528527,first_prior_anomaly_auc= 0.5656628583809735, first_prior_star_anomaly_auc= 0.571459943431011


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5714464277257616 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5513436496930364 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5714639248015496 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5714463229528526 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5384387705024867 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5714597338851932 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5714465324986704 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5265144609664336 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5714618293433715 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5714465324986704 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5194655492007294 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5714653916222744 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5714465324986704 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.5169279493469086 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.571462457980825 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5714463229528526 iter_best_vanilla_star_anomaly= 490 
last prior auc 0.513918661857171 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5714681157179061 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5714466372715794 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.509685522018446 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5714679061720882 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5714464277257615 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.5070660945227656 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5714685348095416 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5714463229528526 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.5049922195637843 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5714687443553595 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5714465324986704 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.5019633395400804 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5714675918533615 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5714463229528526 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.49918989586830126 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5714714684509912 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5714464277257616 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4967142168036468 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5714731448175339 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5714466372715794 at iter 70
max_prior_anomaly= 0.5656628583809735 at iter 0
max_prior_star_anomaly= 0.5714750307298941 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5714463229528526
accuracies_anomaly['prior'][-1]= 0.4924182132195751
accuracies_anomaly['prior_star'][-1]= 0.5714750307298941



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.54866218566895 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5714463229528526
 first_prior_anomaly_auc= 0.4918266653758644
 first_prior_star_anomaly_auc= 0.5714754498215298


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5745645742678573; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.497342749484203; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5746071120688753 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.577137692137799; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5013570187162133; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.5771989842895119 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5788766081069925; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5037647001629848; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.5789679700835627 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5797254782149881; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5057203912807147; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.5797992383428614 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5801225675397602 at iter 490
0.5065163510697105 at iter 490
0.5801764208149405 at iter 490
last anomaly aucs:
0.5801225675397602
0.5065163510697105
0.5801764208149405




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.96440148353577 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5801299016433841,first_prior_anomaly_auc= 0.5065637084245381, first_prior_star_anomaly_auc= 0.5801852217392889


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5801299016433841 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5010966580375699 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5801824976436573 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.580129901643384 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.49538171494811856 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5801820785520215 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.580129901643384 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4879179024631273 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5801791449105721 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.580129901643384 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4813743104371 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.580182916735293 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5801299016433841 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4745620806726253 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5801829167352929 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5801299016433841 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4677372781590813 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5801820785520216 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5801299016433841 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.46446762999070035 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5801814499145682 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.580129901643384 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.46341078565851657 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5801813451416593 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.580129901643384 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4645882236088567 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.580175792177487 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.580129901643384 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4652072219547021 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5801747444483979 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5801299016433841 iter_best_vanilla_star_anomaly= 1020 
last prior auc 0.4664526575229254 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5801707630778593 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.580129901643384 iter_best_vanilla_star_anomaly= 1020 
last prior auc 0.4671130411677905 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5801611239702394 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5801302159621107 at iter 102
max_prior_anomaly= 0.5065637084245381 at iter 0
max_prior_star_anomaly= 0.5801865837871047 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5801296920975663
accuracies_anomaly['prior'][-1]= 0.4682903743452217
accuracies_anomaly['prior_star'][-1]= 0.5801632194284176



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 113.06680202484131 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5475981229723823
accuracies_anomaly["prior"][-1]= 0.5440715716313519
accuracies_anomaly["prior_star"][-1]= 0.547604409346917


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 519.437023639679 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003271818161010742 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4650900858425397
 first_prior_anomaly_auc= 0.49962292230082983
 first_prior_star_anomaly_auc= 0.46508819993017936


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5421662762828081; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.534691672188199; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5421505603464715 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5432536095314848; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 120 
last prior auc 0.5394375706431338; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 190 
last prior star auc 0.5432301403998889 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 120
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5568024230202007; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5316425709930754; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 190 
last prior star auc 0.556814786223452 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.551301740529472; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5431029460884711; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 400 
last prior star auc 0.5513034168960146 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5568024230202007 at iter 300
0.5453880432318168 at iter 470
0.556814786223452 at iter 300
last anomaly aucs:
0.5555872668226526
0.5451344927922525
0.5556006777549931




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 62.40523076057434 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.55636478657968,first_prior_anomaly_auc= 0.544877694392512, first_prior_star_anomaly_auc= 0.5563718063645771


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5563646818067711 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5448152497388012 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5563727493207573 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5563644722609533 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5444458204619814 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5563747400060266 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5563646818067711 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5451223391348188 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5563723302291217 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5563646818067711 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5454969022841751 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5563715968187593 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5563646818067711 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5439267754712371 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.556367196356585 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5563646818067711 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5352843725339076 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5563648913525889 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5563644722609533 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5200163403828737 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5563619577111394 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5563646818067711 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.5008322112154789 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5563619577111394 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5563646818067711 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.46529984120617923 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5563634245318642 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5563646818067711 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.44383260558070803 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.556362376802775 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5563643674880443 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.42932574861291145 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5563651008984067 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5563645770338622 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4288082752158007 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5563667772649493 iter_best_prior_star_anomaly= 170
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5563648913525889 at iter 16
max_prior_anomaly= 0.5454969022841751 at iter 40
max_prior_star_anomaly= 0.5563758925080245 at iter 17
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5563646818067711
accuracies_anomaly['prior'][-1]= 0.43139365151608494
accuracies_anomaly['prior_star'][-1]= 0.5563682440856741



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.37429714202881 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.55636478657968
 first_prior_anomaly_auc= 0.43215262646823516
 first_prior_star_anomaly_auc= 0.556367091583676


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5609979493846268; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.43071105601453075; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5609962730180842 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5652858854547123; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42990880985100033; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.565280437263449 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5690771979365604; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.429077122500066; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5690864179525446 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5722776959850602; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.42818980073449997; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5722740289332484 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5745079968970456 at iter 490
0.43215262646823516 at iter 0
0.5745128164508555 at iter 490
last anomaly aucs:
0.5745079968970456
0.42724055817976764
0.5745128164508555




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.90941405296326 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.574690720850186,first_prior_anomaly_auc= 0.4270763790315044, first_prior_star_anomaly_auc= 0.57468841584619


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5746909303960038 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.43312743361274175 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.574689673121097 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5746910351689127 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.43775074776425094 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5746900922127325 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5746910351689127 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4429490556398628 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5746950165394513 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.574690720850186 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4472943024911226 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5746947022207247 iter_best_prior_star_anomaly= 320
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5746912447147305 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.45170136535863975 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5746964833601762 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.574690720850186 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4555350060956878 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5747041317825267 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5746910351689127 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.45929782034631217 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5747091608821544 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5746908256230949 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4637935210947679 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5747162854399603 iter_best_prior_star_anomaly= 780
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.574690720850186 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.46889711426072445 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.574727181822487 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5746911399418217 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4746815217887837 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.574737868659196 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5746909303960038 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.48007397386460743 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5747523273206256 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5746909303960039 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4860324091943676 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5747693005318693 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5746913494876396 at iter 8
max_prior_anomaly= 0.49151056550968036 at iter 129
max_prior_star_anomaly= 0.5747885787471088 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5746909303960038
accuracies_anomaly['prior'][-1]= 0.49151056550968036
accuracies_anomaly['prior_star'][-1]= 0.5747885787471088



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.57980132102966 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5746910351689127
 first_prior_anomaly_auc= 0.49200519841264856
 first_prior_star_anomaly_auc= 0.5747889978387445


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5763130245717617; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4928325900743175; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5764358184210052 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.577367040035405; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.49338966763099656; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.577478518410486 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5778821036556105; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.49352587241258067; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 300 
last prior star auc 0.5780222898077334 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5774841761475672; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.49355541837289346; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 340 
last prior star auc 0.5775975404350087 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5778821036556105 at iter 300
0.4935694579426876 at iter 340
0.5780222898077334 at iter 300
last anomaly aucs:
0.5762616858463954
0.49326991219611144
0.5764133970184983




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.9495644569397 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5761005451124905,first_prior_anomaly_auc= 0.4932289459887273, first_prior_star_anomaly_auc= 0.5762572853842212


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5761003355666727 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49795546145551367 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5762847358863559 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5761005451124905 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.501620732127942 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.576310405249039 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5761005451124904 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5050455489744199 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5763364937033577 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5761004403395815 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5084762331037969 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5763658301178528 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5761003355666726 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5112603636122849 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.576392651982534 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5761004403395816 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5132919103160662 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5764209406679399 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5761003355666726 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5152825955853726 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5764500675366171 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5761003355666726 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5179301022206408 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5764860046443735 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5761005451124905 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.521212427911 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5765361908677418 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5761005451124905 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5246716102716007 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5765791477603953 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5761003355666726 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5278483248697777 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5766055505334408 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5761005451124905 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5306057382864936 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5766237810195913 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5761005451124905 at iter 0
max_prior_anomaly= 0.5328807772305838 at iter 129
max_prior_star_anomaly= 0.5766380301352031 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5761005451124905
accuracies_anomaly['prior'][-1]= 0.5328807772305838
accuracies_anomaly['prior_star'][-1]= 0.5766380301352031



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.51778197288513 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5563646818067711
accuracies_anomaly["prior"][-1]= 0.43139365151608494
accuracies_anomaly["prior_star"][-1]= 0.5563682440856741


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 516.8979923725128 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on photoGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003124237060546875 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4698118865284251
 first_prior_anomaly_auc= 0.5049472719858615
 first_prior_star_anomaly_auc= 0.46981293425751425


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5450106512139199; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5425747858546516; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 70 
last prior star auc 0.5450063555246545 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5414189311235471; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5395753470183515; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 70 
last prior star auc 0.5414027960955746 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5464615464565173; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5459734094739017; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 300 
last prior star auc 0.546464270552149 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.549257935395348; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.550154581949807; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 400 
last prior star auc 0.5492552112997162 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5526664076680359 at iter 490
0.5509389119459137 at iter 450
0.5526678744887605 at iter 490
last anomaly aucs:
0.5526664076680359
0.5504342208436901
0.5526678744887605




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.596030473709106 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5532944164840474,first_prior_anomaly_auc= 0.5501787844917655, first_prior_star_anomaly_auc= 0.5532967214880435


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5532944164840475 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5494928362571261 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5532952546673188 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5532945212569564 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5480267489427366 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5532944164840475 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.553294835575683 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5464323148149313 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5532933687549584 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5532944164840474 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5448328515874982 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5532933687549584 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5532945212569564 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5437972761558233 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5532959880776811 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5532944164840474 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5409460909856323 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5532988169462217 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5532945212569564 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5341821615321655 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5532967214880435 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5532946260298652 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5155487187740061 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5532965119422257 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5532946260298652 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4835107348227012 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5532965119422257 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5532944164840475 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4636220078428809 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5532983978545861 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5532945212569564 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.44048060590592314 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5532977692171326 iter_best_prior_star_anomaly= 1010
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5532946260298652 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.42016293863702175 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5533015410418534 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5532948355756832 at iter 18
max_prior_anomaly= 0.5501787844917655 at iter 0
max_prior_star_anomaly= 0.5533015410418534 at iter 120
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5532944164840474
accuracies_anomaly['prior'][-1]= 0.41249649534619687
accuracies_anomaly['prior_star'][-1]= 0.5532968262609524



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.5451979637146 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5532946260298653
 first_prior_anomaly_auc= 0.4121703372807574
 first_prior_star_anomaly_auc= 0.5532956737589545


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.557610641239539; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.40433049482568517; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5576001639486479 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.562448006443953; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.39697994185522645; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5624330239179787 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5670485848742285; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.39067544160733375; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5670443939578721 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5707202466941004; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.38674331433590947; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5707145889570192 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5730126779410698 at iter 490
0.4121703372807574 at iter 0
0.5729984288254579 at iter 490
last anomaly aucs:
0.5730126779410698
0.383786937165172
0.5729984288254579




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.736621618270874 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5731721423084322,first_prior_anomaly_auc= 0.3835008023509364, first_prior_star_anomaly_auc= 0.5731610363800876


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5731719327626144 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.3847566104371419 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.573164179567355 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5731719327626144 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.38755278983015473 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5731654368422618 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5731721423084322 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.39112062169729594 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5731679513920758 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5731719327626144 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.39503462325547867 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5731698373044362 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5731719327626144 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.3981835730327943 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5731717232167965 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5731720375355233 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.40170708595946625 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5731689991211648 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5731719327626144 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4050337305902948 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5731689991211648 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5731719327626144 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.40830180716504205 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5731681609378936 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5731721423084322 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4108207574410767 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5731648082048084 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5731719327626144 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41287126804137103 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5731632366111747 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5731719327626144 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41494399049835445 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.573159464786454 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5731722470813411 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41741642160283277 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.573157055009549 iter_best_prior_star_anomaly= 480
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5731722470813411 at iter 16
max_prior_anomaly= 0.4193237076366459 at iter 129
max_prior_star_anomaly= 0.5731719327626144 at iter 48
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5731721423084322
accuracies_anomaly['prior'][-1]= 0.4193237076366459
accuracies_anomaly['prior_star'][-1]= 0.5731566359179133



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 109.89975333213806 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5731722470813411
 first_prior_anomaly_auc= 0.4194920777012656
 first_prior_star_anomaly_auc= 0.5731560072804599


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5740993825522932; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41914454596240835; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.5740912102653982 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5734661350908361; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4181534990170206; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.5734286263894459 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5713966605940288; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41695814489925664; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.5713648096297199 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5676013667416422; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41524374579074835; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.5675575716657175 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 110
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5740993825522932 at iter 100
0.4194920777012656 at iter 0
0.5740920484486695 at iter 110
last anomaly aucs:
0.5631858172685031
0.41334316522310555
0.5631367835471329




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 61.16037178039551 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.5627233496485707,first_prior_anomaly_auc= 0.4131544692141571, first_prior_star_anomaly_auc= 0.5626623718155845


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5627234544214796 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41605280219335794 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.562664152955036 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.5627233496485707 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.41829200880260076 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626613240864955 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.5627233496485707 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4200975603418614 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626609049948599 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.5627233496485707 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4213178504119461 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626580761263194 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.5627235591943885 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4218555449804766 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626576570346836 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.5627235591943885 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4226518190881991 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626585999908638 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.5627235591943885 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.42367335495007985 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626609049948598 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.5627233496485706 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4253208041697941 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626699154650261 iter_best_prior_star_anomaly= 770
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.5627233496485706 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.42739803186186065 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626785068435569 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.5627233496485707 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.42850778651304444 iter_best_prior_anomaly= 990
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.562691289138444 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.5627235591943885 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4289358886188541 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626975755129786 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.5627233496485707 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4294466565497946 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.5626986232420677 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.5627235591943885 at iter 16
max_prior_anomaly= 0.43008681902323986 at iter 129
max_prior_star_anomaly= 0.5627072146205985 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.5627232448756618
accuracies_anomaly['prior'][-1]= 0.43008681902323986
accuracies_anomaly['prior_star'][-1]= 0.5627038618875133



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 108.1071445941925 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.5532944164840474
accuracies_anomaly["prior"][-1]= 0.41249649534619687
accuracies_anomaly["prior_star"][-1]= 0.5532968262609524


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam photoGGAD 
took 513.2088000774384 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return
