

/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.005499362945556641 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40628116807524495
 first_prior_anomaly_auc= 0.5147166066078122
 first_prior_star_anomaly_auc= 0.40628219736152754


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5527709930656983; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5954652734247546; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 20 
last prior star auc 0.5528430431054803 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6049006121165522; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5928202650000463; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 160 
last prior star auc 0.604953620360106 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6203116009827626; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5794836739756285; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 160 
last prior star auc 0.620344280822235 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6323391971772854; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5686065625234806; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 160 
last prior star auc 0.6323629994225703 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6349191032446192 at iter 490
0.5985264994899886 at iter 160
0.6349588594272845 at iter 490
last anomaly aucs:
0.6349191032446192
0.558515825791238
0.6349588594272845




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.53083109855652 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6351755241897716,first_prior_anomaly_auc= 0.5573286727250458, first_prior_star_anomaly_auc= 0.6352165669802902


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6351753955289863 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5555310242324869 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6352204268038499 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6351753955289863 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5533699090213855 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6352175962665727 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6351756528505569 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5525339998991299 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6352124498351598 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6351751382074156 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5505149261950271 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635210133941024 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6351753955289863 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.5498630019957861 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6352083326900295 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6351759101721275 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.546272594120511 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6352024142939046 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6351752668682009 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.537942194253083 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.63520061304291 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6351751382074156 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.524346094424665 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6351972678624915 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6351753955289863 iter_best_vanilla_star_anomaly= 840 
last prior auc 0.5002757200629511 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6351927647350051 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6351753955289863 iter_best_vanilla_star_anomaly= 840 
last prior auc 0.4661511486320271 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6351831151761057 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6351753955289863 iter_best_vanilla_star_anomaly= 840 
last prior auc 0.42714917549022335 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6351869749996654 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6351753955289863 iter_best_vanilla_star_anomaly= 840 
last prior auc 0.4057602205554646 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6351819572290378 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6351759101721276 at iter 84
max_prior_anomaly= 0.5573286727250458 at iter 0
max_prior_star_anomaly= 0.6352210701077766 at iter 8
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6351753955289863
accuracies_anomaly['prior'][-1]= 0.4045627746264463
accuracies_anomaly['prior_star'][-1]= 0.6351761674936982



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.94152688980103 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6351751382074156
 first_prior_anomaly_auc= 0.40726349317120014
 first_prior_star_anomaly_auc= 0.6351759101721275


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6371997443252875; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.40630111049697026; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6372111951351813 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6380948374087924; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4046361112740814; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6380988258931375 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6388601117599044; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4021577185663689; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6388671881030974 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6387427731236883; count_not_improved_vanilla_star_anomaly= 16 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4015015485612122; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6387521653610171 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6389474724331401 at iter 370
0.40726349317120014 at iter 0
0.6389535194900504 at iter 370
last anomaly aucs:
0.6385465654260678
0.40540884795074245
0.6385488813202037




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.52743721008301 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6384324433094848,first_prior_anomaly_auc= 0.40581155620880927, first_prior_star_anomaly_auc= 0.6384334725957673


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6384327006310554 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4237953747991605 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6384260102702185 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6384323146486994 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.42944770042005176 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.638424980983936 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6384324433094848 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.42981322571115965 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6384222791074441 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6384325719702701 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4320749536563851 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6384159747289632 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6384323146486994 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.43549347072246636 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6384153314250365 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6384325719702701 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4377411746420914 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6384180333015285 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6384325719702701 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4386890186475796 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6384179046407431 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6384324433094848 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.43920867955950665 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6384218931250881 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6384323146486994 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.43986111840188896 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6384233083937267 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6384325719702701 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.44042503862396776 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6384284548251397 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6384327006310555 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.44125361408145974 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6384323146486994 iter_best_prior_star_anomaly= 1080
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6384325719702701 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.44195957581053724 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6384374610801125 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6384328292918409 at iter 37
max_prior_anomaly= 0.4430892175056894 at iter 129
max_prior_star_anomaly= 0.6384476252821532 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6384325719702701
accuracies_anomaly['prior'][-1]= 0.4430892175056894
accuracies_anomaly['prior_star'][-1]= 0.6384476252821532



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.65184783935547 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6384324433094848
 first_prior_anomaly_auc= 0.4431117331431212
 first_prior_star_anomaly_auc= 0.6384486545684357


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6374918043079748; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4458522078705405; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6375204956631023 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6360444991338556; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44964680041212624; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.636108829526518 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6341912691820365; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45476003734250636; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6342370724216122 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6326321577854699; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4586143284884828; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6326715279857793 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6384324433094848 at iter 0
0.46345338928533564 at iter 490
0.6384486545684357 at iter 0
last anomaly aucs:
0.6313810603089711
0.46345338928533564
0.631433682570169




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.38729095458984 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6313432340380857,first_prior_anomaly_auc= 0.46390807650067367, first_prior_star_anomaly_auc= 0.6313802883442592


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.631342976716515 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.465712286693284 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6313880079913787 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6313433626988709 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4678228382157528 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6313989441581314 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6313449066282948 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.47017385674599377 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6314276355132589 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6313440060027975 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4732044615443206 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6314616019605845 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6313454212714362 iter_best_vanilla_star_anomaly= 500 
last prior auc 0.47592113402645475 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6315030307334591 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6313451639498655 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.4784562661404955 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6315510212063853 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6313449066282948 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.48090571017150996 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6315896194419827 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.631343748681227 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.4830723577963804 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6316332354482078 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6313436200204416 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.4848990836264226 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6316684885033869 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6313446493067242 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.48624950722919225 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6317056714703457 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6313452926106509 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.4876695363168225 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6317397665784568 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.631342976716515 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.48988880620289077 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6317728324002854 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6313456785930068 at iter 66
max_prior_anomaly= 0.4914306770542239 at iter 129
max_prior_star_anomaly= 0.6317963773239997 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6313446493067243
accuracies_anomaly['prior'][-1]= 0.4914306770542239
accuracies_anomaly['prior_star'][-1]= 0.6317963773239997



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.30323195457458 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6351753955289863
accuracies_anomaly["prior"][-1]= 0.4045627746264463
accuracies_anomaly["prior_star"][-1]= 0.6351761674936982


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 674.2289543151855 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.005026102066040039 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.3941976044391059
 first_prior_anomaly_auc= 0.44263054180600625
 first_prior_star_anomaly_auc= 0.39419760443910584


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5501805368139678; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5922768018428342; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.550259019893016 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6062753526077482; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5892898130507325; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 140 
last prior star auc 0.6063190972747587 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6221522221776199; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5787440031207961; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 140 
last prior star auc 0.6221679187934295 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6365174561807097; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5662407480029272; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 140 
last prior star auc 0.636554767808454 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6402486189551303 at iter 490
0.5958111136157077 at iter 140
0.6402957088025591 at iter 490
last anomaly aucs:
0.6402486189551303
0.5551786223414822
0.6402957088025591




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.8199212551117 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6403143646164313,first_prior_anomaly_auc= 0.553978860518328, first_prior_star_anomaly_auc= 0.6403529628520288


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6403146219380019 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5518815610567477 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403521908873168 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6403135926517194 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.548570990389554 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403488457068982 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6403143646164313 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5448921925547606 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403457578480505 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6403157798850698 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5423973312665266 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403425413284174 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6403141072948606 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5392607099810921 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403422840068468 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.640314235955646 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5335844534541304 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403382955225018 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6403156512242845 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5231598419839699 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403400967734962 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6403155225634992 iter_best_vanilla_star_anomaly= 770 
last prior auc 0.5040257959728145 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403381668617164 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.640314235955646 iter_best_vanilla_star_anomaly= 770 
last prior auc 0.4770241429390446 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403352076636539 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6403156512242846 iter_best_vanilla_star_anomaly= 770 
last prior auc 0.4514468934596062 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403323771263769 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6403141072948606 iter_best_vanilla_star_anomaly= 770 
last prior auc 0.418294611583382 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403299325714555 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.640317452475279 iter_best_vanilla_star_anomaly= 770 
last prior auc 0.4014096847604902 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6403301898930263 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6403192537262736 at iter 77
max_prior_anomaly= 0.553978860518328 at iter 0
max_prior_star_anomaly= 0.6403579806226564 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6403161658674259
accuracies_anomaly['prior'][-1]= 0.4186508732979465
accuracies_anomaly['prior_star'][-1]= 0.6403227275674774



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.62223052978516 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6403144932772166
 first_prior_anomaly_auc= 0.4198287627875954
 first_prior_star_anomaly_auc= 0.6403198970302002


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6415648187890035; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4155477038166965; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6415797434401012 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.642502884574807; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.411875982325096; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6425121481513505 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6424825561707257; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4090701479187317; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6424871879589973 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6425050718081575; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4050900265247075; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6425185811906166 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6427837510691712 at iter 360
0.4198287627875954 at iter 0
0.6427998336673367 at iter 360
last anomaly aucs:
0.6418712887796474
0.40176375924170427
0.6418813243209027




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.64126992225647 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6417213989647439,first_prior_anomaly_auc= 0.4018702903719532, first_prior_star_anomaly_auc= 0.6417260307530155


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6417217849470999 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4158501853229951 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6417234575373091 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6417215276255293 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4237156051122592 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6417170244980428 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6417241008412358 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4215246405989623 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6417220422686706 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6417247441451623 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.42303305964611077 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6417199836961053 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6417271887000835 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.42345583898668826 iter_best_prior_anomaly= 180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6417085328862113 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6417226855725972 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.42505123272471634 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6417058310097196 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6417264167353716 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.42601773254407665 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6417057023489343 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6417219136078851 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4259732159123542 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6416983686841707 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6417253874490889 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.42590438239220546 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6416936082351137 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6417244868235916 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4260664949817148 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6416961814508202 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6417261594138008 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.42655540596594915 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6417067316352169 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6417269313785129 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.42685261238004957 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6417105914587766 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6417310485236433 at iter 78
max_prior_anomaly= 0.42702514649317014 at iter 129
max_prior_star_anomaly= 0.6417315631667846 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.641724229502021
accuracies_anomaly['prior'][-1]= 0.42702514649317014
accuracies_anomaly['prior_star'][-1]= 0.6417064743136462



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.97167325019836 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6417265453961568
 first_prior_anomaly_auc= 0.4270299069422272
 first_prior_star_anomaly_auc= 0.641710720119562


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6401456903268704; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42736262373307726; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 100 
last prior star auc 0.6401308943365581 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6384384903663951; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42772145866334826; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 200 
last prior star auc 0.6384256242878625 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6363248509850784; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42894849657299133; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 260 
last prior star auc 0.6362821356043507 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.634212884193971; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.42922769047714626; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 370 
last prior star auc 0.634174414619159 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6417265453961568 at iter 0
0.43045871687113435 at iter 490
0.641710720119562 at iter 0
last anomaly aucs:
0.6327108981860887
0.43045871687113435
0.632698675411483




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.73917269706726 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.632535919518047,first_prior_anomaly_auc= 0.43052021672651963, first_prior_star_anomaly_auc= 0.6326069402715464


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6325342469278378 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43198862226943213 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6326007645538507 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6325321883552726 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.43377855111487146 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6326030804479865 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6325332176415551 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.435787589277719 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.632616332508875 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6325350188925498 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.43834343577819707 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6326122153637446 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6325339896062672 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.44077551060319264 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.632636532252171 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.632526398619933 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.44224108560882797 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6326486263659916 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.632531545051346 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4433471823802657 iter_best_prior_anomaly= 650
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6326715279857793 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6325325743376286 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.44376134144822643 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6326922423722166 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6325229247787292 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4449309966476146 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6327224776567679 iter_best_prior_star_anomaly= 880
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6325352762141203 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.44633867429985374 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6327437066863466 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6325316737121313 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.44785519897647774 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6328475359401038 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6325284571924982 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4486055486764922 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329769686901406 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6325384927337535 at iter 78
max_prior_anomaly= 0.45104727306038717 at iter 129
max_prior_star_anomaly= 0.632994981200086 at iter 126
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6325368201435443
accuracies_anomaly['prior'][-1]= 0.45104727306038717
accuracies_anomaly['prior_star'][-1]= 0.6329911213765262



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.53165578842163 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6403161658674259
accuracies_anomaly["prior"][-1]= 0.4186508732979465
accuracies_anomaly["prior_star"][-1]= 0.6403227275674774


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 677.6445775032043 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004413604736328125 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4055803527775805
 first_prior_anomaly_auc= 0.5056673789327742
 first_prior_star_anomaly_auc= 0.40557932349129794


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5521801827394865; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5945266929958098; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.5522185236535134 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6092036720817418; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5864810194463057; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.609241755674198 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6234793581782456; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5767159231617204; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 60 
last prior star auc 0.6235197576648377 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6341399335286919; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.562567096599547; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 60 
last prior star auc 0.6341569167523547 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6379733816274458 at iter 490
0.5962925622743933 at iter 60
0.637999242445296 at iter 490
last anomaly aucs:
0.6379733816274458
0.5509874972595253
0.637999242445296




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.57352876663208 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6382871852828531,first_prior_anomaly_auc= 0.5504849482320464, first_prior_star_anomaly_auc= 0.6383344037910672


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6382869279612824 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5493636694879404 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6383277134302303 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6382873139436384 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5489260941570505 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.638327970751801 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6382869279612824 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5473907850057692 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6383230816419586 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6382865419789264 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5463294621876246 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.638322438338032 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6382873139436384 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5452978600108899 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6383193504791842 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6382871852828531 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5418415166739231 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6383226956596026 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6382869279612824 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5393467840464744 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6383181925321162 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6382869279612824 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5338743262034673 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6383152333340538 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6382870566220677 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5202164691980934 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6383112448497088 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6382871852828529 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.49633985797907865 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6383039111849452 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6382870566220677 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.45716547938493973 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6382987647535322 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6382870566220677 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.43753698997578083 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6382952909123285 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6382873139436384 at iter 20
max_prior_anomaly= 0.5504849482320464 at iter 0
max_prior_star_anomaly= 0.6383344037910672 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6382871852828531
accuracies_anomaly['prior'][-1]= 0.42008068060526155
accuracies_anomaly['prior_star'][-1]= 0.6382949049299725



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.97673034667969 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.638286799300497
 first_prior_anomaly_auc= 0.4185637699462815
 first_prior_star_anomaly_auc= 0.6382940043044752


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.639913457609359; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41827273924987673; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6399215632388346 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6409565105959877; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 190 
last prior auc 0.41769556696690946; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6409604990803327 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6419653398137198; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.42016199422158684; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 300 
last prior star auc 0.6419803931256027 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6422060641430625; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 350 
last prior auc 0.42488860549206575; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 400 
last prior star auc 0.6422180295960978 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6424442152566989 at iter 350
0.4304109837197788 at iter 490
0.642451420260677 at iter 350
last anomaly aucs:
0.6415809013871692
0.4304109837197788
0.6415953113951255




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.62650084495544 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6414849204413169,first_prior_anomaly_auc= 0.43081047545821255, first_prior_star_anomaly_auc= 0.6414997164316292


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6414846631197462 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4156423981546955 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6414992017884877 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6414845344589608 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.40922994461410517 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6414998450924145 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6414850491021021 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.4229243412825113 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.64149611392964 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6414847917805315 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.42727294716570585 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6414904528550858 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6414850491021021 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4290080665165967 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6414889089256619 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6414847917805315 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4314748797536301 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6414872363354526 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6414849204413168 iter_best_vanilla_star_anomaly= 370 
last prior auc 0.43393333003961726 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6414833765118928 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6414845344589608 iter_best_vanilla_star_anomaly= 790 
last prior auc 0.4364685908144434 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6414832478511076 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6414847917805314 iter_best_vanilla_star_anomaly= 790 
last prior auc 0.4389139177003274 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6414795166883331 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6414847917805315 iter_best_vanilla_star_anomaly= 790 
last prior auc 0.44040831272187553 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6414793880275478 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6414845344589608 iter_best_vanilla_star_anomaly= 790 
last prior auc 0.44144428936531116 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6414805459746158 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6414846631197462 iter_best_vanilla_star_anomaly= 790 
last prior auc 0.4419535287536269 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6414864643707406 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6414853064236727 at iter 79
max_prior_anomaly= 0.44215822806307875 at iter 129
max_prior_star_anomaly= 0.6415011317002677 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6414846631197462
accuracies_anomaly['prior'][-1]= 0.44215822806307875
accuracies_anomaly['prior_star'][-1]= 0.6414842771373901



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.98364734649658 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6414849204413168
 first_prior_anomaly_auc= 0.44224906257751817
 first_prior_star_anomaly_auc= 0.6414837624942489


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6405233097317988; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44032416856827306; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6405036246316441 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6387444457138975; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4396139610332799; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6387736517121663 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6367346355863381; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4391034350371109; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6367792808788457 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6347562186903979; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43814735674136196; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6347989340711258 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6414849204413168 at iter 0
0.44224906257751817 at iter 0
0.6415206881396371 at iter 30
last anomaly aucs:
0.6333099428025613
0.4371175558156219
0.6333458391616669




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.46605157852173 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6331417831561417,first_prior_anomaly_auc= 0.43693691607302587, first_prior_star_anomaly_auc= 0.6331940194349837


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6331413971737858 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4385034897951412 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6332104880155052 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.633141911816927 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.43959234602134534 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.633227085256812 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6331402392267178 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.44061468462153663 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6332438111589043 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6331406252090737 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4416199113372796 iter_best_prior_anomaly= 390
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6332602797394259 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6331413971737857 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4423938059610086 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6332779062670153 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6331416544953564 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.443823355946753 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.633309042177064 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.633141911816927 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.44611441855103257 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6333643663147537 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6331410111914297 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.44758321007630103 iter_best_prior_anomaly= 780
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6334373169800329 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6331415258345711 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.4480187268346256 iter_best_prior_anomaly= 860
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6335267362258337 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6331410111914297 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.44898278209906467 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6336611867464981 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6331416544953563 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.44907438857821597 iter_best_prior_anomaly= 1040
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6337297629450762 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6331425551208536 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.4497521735953073 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6337606415335542 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6331428124424243 at iter 53
max_prior_anomaly= 0.4504782064068954 at iter 129
max_prior_star_anomaly= 0.6337762094885786 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.633142297799283
accuracies_anomaly['prior'][-1]= 0.4504782064068954
accuracies_anomaly['prior_star'][-1]= 0.6337762094885786



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.79108786582947 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6382871852828531
accuracies_anomaly["prior"][-1]= 0.42008068060526155
accuracies_anomaly["prior_star"][-1]= 0.6382949049299725


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 676.7253444194794 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004336833953857422 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40129247478505925
 first_prior_anomaly_auc= 0.4747702633017239
 first_prior_star_anomaly_auc= 0.4012938900536979


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5502514289066818; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5915097262407275; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 80 
last prior star auc 0.5503353157387136 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6037654380076312; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5896153248376043; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 130 
last prior star auc 0.6038336282238532 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6132510830664909; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5833178940390944; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 130 
last prior star auc 0.6132723120960695 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.62119781647208; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5766644588475905; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 130 
last prior star auc 0.6212137704094605 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6319955442196827 at iter 490
0.5928605358258531 at iter 130
0.6320278380767992 at iter 490
last anomaly aucs:
0.6319955442196827
0.5677890518935265
0.6320278380767992




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.58439016342163 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.632914954191614,first_prior_anomaly_auc= 0.5667142196929228, first_prior_star_anomaly_auc= 0.6329364405427632


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.632914954191614 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5667139623713521 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329378558114018 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6329146968700434 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.5667209100537597 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329388850976845 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.632914954191614 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.5665608560368155 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.632934767952554 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.632914954191614 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.5662884811542828 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329348966133395 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6329149541916141 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.5657546675559699 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329339959878421 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6329149541916139 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.5648416906233049 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.632934767952554 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.632914954191614 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.5635899498428795 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329309081289942 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6329146968700434 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.5603331593839516 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329285922348584 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6329150828523994 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.5565477017581238 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329283349132878 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6329148255308287 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.5539625205985917 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329275629485759 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.632914954191614 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.560503248942151 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329251183936546 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.632914954191614 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.5455102789674612 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329293641995704 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6329152115131846 at iter 122
max_prior_anomaly= 0.5667335188107213 at iter 13
max_prior_star_anomaly= 0.6329404290271083 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6329146968700433
accuracies_anomaly['prior'][-1]= 0.5176139188325424
accuracies_anomaly['prior_star'][-1]= 0.6329302648250676



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.30078291893005 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.632914954191614
 first_prior_anomaly_auc= 0.5141920565860427
 first_prior_star_anomaly_auc= 0.6329309081289943


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6356174739873623; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5221757156370201; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6356309833698216 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6374512761605975; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5265989447757031; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6374727625117468 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6388262739733641; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.5337629059633759; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6388429998754563 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6394287924310404; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.5369688754121005; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6394452610115621 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6397706441376486 at iter 430
0.5379712715905665 at iter 480
0.6397905865593738 at iter 430
last anomaly aucs:
0.6395251593592487
0.5379695990003571
0.6395529500888789




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.79302287101746 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6395189836415531,first_prior_anomaly_auc= 0.5380133436673676, first_prior_star_anomaly_auc= 0.6395460024064713


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6395185976591972 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5260861028853983 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395479323182511 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6395176970336999 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5132207963176254 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395534647320201 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6395182116768412 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5033325716614843 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395623423262076 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6395176970336999 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49675375972546876 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395672314360499 iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6395183403376264 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49289174893237286 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395764950125933 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6395189836415531 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48959854747119796 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395791968890852 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6395182116768412 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4858402372710739 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395812554616503 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6395184689984119 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48296145219943043 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395846006420688 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6395184689984118 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4807401237407969 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395903903774084 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6395183403376266 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47881677366097575 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395970807382452 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6395185976591972 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47674546367803106 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6396053150285061 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6395183403376266 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47514273627523945 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6396134206579815 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6395189836415531 at iter 0
max_prior_anomaly= 0.5380133436673676 at iter 0
max_prior_star_anomaly= 0.6396274446835819 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6395184689984118
accuracies_anomaly['prior'][-1]= 0.47371820406012266
accuracies_anomaly['prior_star'][-1]= 0.6396274446835819



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.25306344032288 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6395179543552705
 first_prior_anomaly_auc= 0.47358349621788753
 first_prior_star_anomaly_auc= 0.6396268013796553


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6390175925611422; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4763988515223659; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.639130814052228 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6388215135243072; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4789544407012733; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6390438393613485 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6376096575873323; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4806073458103416; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6378714822854685 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6367229274548736; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48154965740206085; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6367531627394248 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.639596566095104 at iter 30
0.4824513121856174 at iter 490
0.639641340048397 at iter 30
last anomaly aucs:
0.6354804502509915
0.4824513121856174
0.6354898424883202




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.78604936599731 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6353815101070767,first_prior_anomaly_auc= 0.48261779924182774, first_prior_star_anomaly_auc= 0.6353920602914733


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6353812527855061 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.48303993527847855 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6353943761856091 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6353813814462913 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.48312626666543157 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354005519033048 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6353818960894326 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4827714202195056 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354067276210003 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6353807381423647 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.48157641884540836 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354149619112612 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6353815101070767 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4805471325628096 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354283426329349 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6353813814462914 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.47905917058052777 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635442623980106 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6353808668031501 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.47771144885425 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354460978213099 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6353815101070767 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4762837001195001 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.63546205175869 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6353809954639353 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.475376255600604 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354792923039235 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6353813814462914 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4745801026610138 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354900998098909 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6353813814462914 iter_best_vanilla_star_anomaly= 1060 
last prior auc 0.47341688050089187 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635516346610097 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6353815101070767 iter_best_vanilla_star_anomaly= 1060 
last prior auc 0.472863639123995 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6355375756396757 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.635382024750218 at iter 106
max_prior_anomaly= 0.48314376453223573 at iter 19
max_prior_star_anomaly= 0.6355620211888875 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6353812527855061
accuracies_anomaly['prior'][-1]= 0.4728736746652503
accuracies_anomaly['prior_star'][-1]= 0.6355620211888875



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.86239171028137 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6329146968700433
accuracies_anomaly["prior"][-1]= 0.5176139188325424
accuracies_anomaly["prior_star"][-1]= 0.6329302648250676


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 676.8926792144775 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.005330085754394531 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4069678306865237
 first_prior_anomaly_auc= 0.4956456043814659
 first_prior_star_anomaly_auc= 0.40696924595516226


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5512073785416454; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5938167427823873; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 80 
last prior star auc 0.5512718375950931 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6051349034066289; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5932115224482192; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 160 
last prior star auc 0.6051638520833269 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6185979679830208; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5807377306501899; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 160 
last prior star auc 0.6186184250478876 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6308302634869954; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.568181724610338; count_not_improved_prior_anomaly= 32; iter_best_prior_anomaly= 160 
last prior star auc 0.6308539370714952 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6338981799130665 at iter 490
0.5977967355156262 at iter 160
0.6338175096006677 at iter 490
last anomaly aucs:
0.6338981799130665
0.5590541425170372
0.6338175096006677




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.68317341804504 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6341755725662269,first_prior_anomaly_auc= 0.5584158563610406, first_prior_star_anomaly_auc= 0.634207351780202


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6341760872093682 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5558908884490406 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6342079950841286 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6341758298877974 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5527055047259679 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6342067084762755 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6341759585485829 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5498209299189849 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6342046499037103 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6341763445309387 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5474224355589591 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6341991174899413 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6341759585485829 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5444794487554385 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6341973162389468 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6341762158701535 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5404724372572814 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6341940997193136 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6341764731917242 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5353607442563252 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6341948716840256 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6341759585485828 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5258237635441209 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6341961582918788 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6341755725662268 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5174476890979026 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6341960296310936 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6341764731917241 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4964515355407406 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6341974448997321 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6341758298877975 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4677009964520502 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.634194614362455 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6341760872093682 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.43433681026239596 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6341912691820366 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6341766018525095 at iter 4
max_prior_anomaly= 0.5584158563610406 at iter 0
max_prior_star_anomaly= 0.6342082524056993 at iter 6
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6341758298877975
accuracies_anomaly['prior'][-1]= 0.40694016861767884
accuracies_anomaly['prior_star'][-1]= 0.6341852221251262



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.52937722206116 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6341754439054416
 first_prior_anomaly_auc= 0.4054949220161248
 first_prior_star_anomaly_auc= 0.6341853507859115


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6350871342302534; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4081430182996808; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6350948538773729 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6355517283260614; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41535535594263584; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6355568747574745 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6362562747865003; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.42090462427448183; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6362733866709486 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6373026729535473; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.423696949298387; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6372311375569066 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6373347094890931 at iter 420
0.42766188871974287 at iter 490
0.6373470609244843 at iter 420
last anomaly aucs:
0.6369855241177216
0.42766188871974287
0.6369146320250076




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.5815544128418 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6372829878533925,first_prior_anomaly_auc= 0.42868680053564057, first_prior_star_anomaly_auc= 0.6370995175735193


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6372838884788898 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.41711067503682275 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371630760014699 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6372829878533925 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4017155114472074 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6372238038921432 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6372831165141779 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.3944433465390763 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6372523665864853 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6372833738357486 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.38839371641310194 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6372759115101998 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6372840171396752 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.3876938017409348 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6372898068750148 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6372826018710366 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4004595248608662 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6373046028653272 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6372842744612459 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.40709829272284304 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6373046028653272 iter_best_prior_star_anomaly= 690
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6372831165141779 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4100691989167791 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6373094919751695 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6372835024965339 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.41191651047247324 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6373151530497237 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6372828591926072 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4125843886090946 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6373242879654819 iter_best_prior_star_anomaly= 950
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6372832451749633 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.41319153885504256 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6373264751988325 iter_best_prior_star_anomaly= 1080
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6372820872278954 iter_best_vanilla_star_anomaly= 540 
last prior auc 0.4140068622516461 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6373329082380986 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6372844031220313 at iter 54
max_prior_anomaly= 0.42868680053564057 at iter 0
max_prior_star_anomaly= 0.6373330368988839 at iter 122
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6372833738357486
accuracies_anomaly['prior'][-1]= 0.4138351001032374
accuracies_anomaly['prior_star'][-1]= 0.6373290484145389



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.82044982910156 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6372824732102513
 first_prior_anomaly_auc= 0.41382377795412884
 first_prior_star_anomaly_auc= 0.637327890467471


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6368755191462688; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4156003260778944; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6368707586972118 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6360062868806141; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4167209615180737; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6359948360707202 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.635072724222297; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4189177157667102; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6350872628910387 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6339888857667205; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42187935838410284; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6339936462157775 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6374941202021107 at iter 20
0.42420168555921633 at iter 490
0.637494634845252 at iter 20
last anomaly aucs:
0.6331736910309023
0.42420168555921633
0.6332023823860297




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.71636843681335 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6327947850181206,first_prior_anomaly_auc= 0.42452732600687354, first_prior_star_anomaly_auc= 0.6328453487067534


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6327942703749793 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4261753420060995 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6328534543362287 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6327936270710527 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.42718121202576925 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.632855126926438 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6327946563573352 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.42871253269270554 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6328583434460711 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6327938843926233 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.429863274756651 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.632874168722666 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6327942703749793 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.43176809768338537 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6328919239110409 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6327940130534087 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4317229377477363 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329104510641277 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6327933697494821 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.43267078175322443 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.632939914383967 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6327934984102672 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.433835033199629 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329611434135456 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6327927264455554 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4356675487650108 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329643599331787 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6327954283220473 iter_best_vanilla_star_anomaly= 1000 
last prior auc 0.4356330676745438 iter_best_prior_anomaly= 940
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329758107430726 iter_best_prior_star_anomaly= 960
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6327931124279114 iter_best_vanilla_star_anomaly= 1000 
last prior auc 0.4348244346387771 iter_best_prior_anomaly= 940
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329830157470508 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6327928551063406 iter_best_vanilla_star_anomaly= 1000 
last prior auc 0.4336201696881365 iter_best_prior_anomaly= 940
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6329921506628089 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6327955569828325 at iter 123
max_prior_anomaly= 0.4360220092285808 at iter 94
max_prior_star_anomaly= 0.6330073326354773 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6327942703749794
accuracies_anomaly['prior'][-1]= 0.4327437324185037
accuracies_anomaly['prior_star'][-1]= 0.6330073326354773



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.37997627258301 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6341758298877975
accuracies_anomaly["prior"][-1]= 0.40694016861767884
accuracies_anomaly["prior_star"][-1]= 0.6341852221251262


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 677.0225257873535 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.00436091423034668 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4022278386943709
 first_prior_anomaly_auc= 0.4876139548575622
 first_prior_star_anomaly_auc= 0.40222578012180576


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5516314444900761; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.593154011077179; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.55168252282185 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6077894327294511; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5890606681920689; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 140 
last prior star auc 0.6078298322160431 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6223100889612134; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.577536392989737; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 140 
last prior star auc 0.6223255282554524 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6329251183936546; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5641972287496128; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 140 
last prior star auc 0.6329665471665293 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.637297397861349 at iter 490
0.5950431373881037 at iter 140
0.6373335515420253 at iter 490
last anomaly aucs:
0.637297397861349
0.5544286586238236
0.6373335515420253




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.48055267333984 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6375987214205798,first_prior_anomaly_auc= 0.5535816846740302, first_prior_star_anomaly_auc= 0.6376405361758103


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6375987214205797 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5512033900573003 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376365476914652 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6376002653500036 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5497317679947548 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376357757267533 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6375998793676476 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5473066408521667 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.637631658581623 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6376002653500037 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5457970638579502 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376286993835605 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6375997507068623 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5429725736377138 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376280560796339 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6375982067774385 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5388154150030827 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376240675952888 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6375987214205798 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5307205930335845 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376259975070686 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.637600008028433 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5142112270430561 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376231669697915 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6375996220460771 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4873765757086378 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376199504501584 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6375985927597945 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4588919784632137 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.637613131428536 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6376007799931449 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4260482251501985 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376114588383269 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6376002653500037 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.3994850480728158 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376050257990608 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.637600779993145 at iter 7
max_prior_anomaly= 0.5535816846740302 at iter 0
max_prior_star_anomaly= 0.6376418227836637 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6375985927597945
accuracies_anomaly['prior'][-1]= 0.39297532697851983
accuracies_anomaly['prior_star'][-1]= 0.6376021952617835



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.02538776397705 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.637600394010789
 first_prior_anomaly_auc= 0.3926126322246891
 first_prior_star_anomaly_auc= 0.6376001366892183


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6402363961805245; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.39588023018958424; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6402417999335082 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6415937674657017; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.3996839576469281; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6415992998794706 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6426701435957294; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.40461359563664956; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6426765766349956 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6442313135648611; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4079380616686583; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6442488114316652 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6444170997388701 at iter 430
0.40808344835607546 at iter 490
0.6443808173974084 at iter 440
last anomaly aucs:
0.6439781091393417
0.40808344835607546
0.6439838988746813




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.58880591392517 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6439290893801329,first_prior_anomaly_auc= 0.40810146086602095, first_prior_star_anomaly_auc= 0.6439441426920159


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6439285747369916 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4075542665460343 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439383529566763 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6439296040232741 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4054317495705303 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439308906311274 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6439305046487714 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4032514639024154 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439321772389808 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6439278027722797 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4024864468728739 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439335925076193 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.643928317415421 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4015144146397447 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439271594683531 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6439288320585622 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4017355825297181 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.643927159468353 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6439298613448448 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.40198145329047386 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439222703585108 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.643928703397777 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4065652510892422 iter_best_prior_anomaly= 40
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439261301820705 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6439270308075677 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4098463584365965 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439251008957878 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6439280600938503 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.41140572715473367 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439253582173585 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6439285747369916 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4128629392093229 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439243289310759 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.643928317415421 iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4131582157116434 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.643928703397777 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6439305046487714 at iter 30
max_prior_anomaly= 0.4133119653501066 at iter 129
max_prior_star_anomaly= 0.6439441426920159 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.643928703397777
accuracies_anomaly['prior'][-1]= 0.4133119653501066
accuracies_anomaly['prior_star'][-1]= 0.6439362943841112



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.26120710372925 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6439280600938503
 first_prior_anomaly_auc= 0.41332200089136184
 first_prior_star_anomaly_auc= 0.6439351364370431


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6427934006280704; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4158684551545113; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6428013775967607 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6412200078843329; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41713061745854807; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6412427808433354 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.639677365068288; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.418269265408673; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6397424674256624 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6382331477530166; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4190597572737088; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 400 
last prior star auc 0.6382774070631684 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6439280600938503 at iter 0
0.41973445443195234 at iter 490
0.6439351364370431 at iter 0
last anomaly aucs:
0.6368917304052197
0.41973445443195234
0.6369465398997681




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.42799162864685 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6367637129238215,first_prior_anomaly_auc= 0.41999177600260196, first_prior_star_anomaly_auc= 0.6368271426909866


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6367629409591096 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4206556656548783 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368319031400437 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6367630696198948 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4214456428767729 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368382075185246 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6367622976551829 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.42279876835603425 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368586645833914 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6367634556022508 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.42441178862165185 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368791216482579 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6367630696198949 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.425148500278422 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6369067837171027 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6367631982806802 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4254989722576468 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6369343171251622 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6367628122983242 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.42557809864062157 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6369823075980884 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6367621689943976 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.4255797712308308 iter_best_prior_anomaly= 750
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.637027724855308 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6367630696198948 iter_best_vanilla_star_anomaly= 850 
last prior auc 0.4256308495626048 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6370737854164543 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6367629409591096 iter_best_vanilla_star_anomaly= 850 
last prior auc 0.4258723458566595 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371083951677068 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6367629409591095 iter_best_vanilla_star_anomaly= 850 
last prior auc 0.4263209860150873 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371505959052932 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6367621689943975 iter_best_vanilla_star_anomaly= 850 
last prior auc 0.4260330431775303 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371868782467549 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6367651281924601 at iter 85
max_prior_anomaly= 0.4263209860150873 at iter 110
max_prior_star_anomaly= 0.6372294649666974 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6367626836375389
accuracies_anomaly['prior'][-1]= 0.4252784476716
accuracies_anomaly['prior_star'][-1]= 0.6372294649666974



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.99533915519714 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6375985927597945
accuracies_anomaly["prior"][-1]= 0.39297532697851983
accuracies_anomaly["prior_star"][-1]= 0.6376021952617835


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 674.0896825790405 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004492282867431641 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.3986257226876312
 first_prior_anomaly_auc= 0.4697270178385606
 first_prior_star_anomaly_auc= 0.39862816724255234


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.550183367351245; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5921227948828004; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.5502413933654264 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.608164092936317; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5865375015310633; count_not_improved_prior_anomaly= 11; iter_best_prior_anomaly= 100 
last prior star auc 0.6082021765287732 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6224293575092096; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5763377891136507; count_not_improved_prior_anomaly= 21; iter_best_prior_anomaly= 100 
last prior star auc 0.6224487852877936 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6333754311422917; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5632945446797736; count_not_improved_prior_anomaly= 31; iter_best_prior_anomaly= 100 
last prior star auc 0.6333921570443839 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.636736565498118 at iter 490
0.5921227948828004 at iter 100
0.6367568939021993 at iter 490
last anomaly aucs:
0.636736565498118
0.5540918246878432
0.6367568939021993




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.53328466415405 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6370278535160935,first_prior_anomaly_auc= 0.5531703561433465, first_prior_star_anomaly_auc= 0.6370609193379219


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6370282394984493 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5515152638009279 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.637057831479074 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6370287541415907 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5492617701459631 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.637057831479074 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6370287541415907 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5480653535032274 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6370568021927915 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.637028882802376 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5468358710386632 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6370565448712209 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.63702849682002 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5442199399514382 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.637052685047661 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.637028882802376 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.5384411407785726 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6370517844221638 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6370287541415907 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.5272996314125822 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6370521704045198 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6370282394984493 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.5131617410171613 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6370553869241529 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6370287541415907 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.49272834973501023 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6370566735320062 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.63702849682002 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.47205706466079356 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6370525563868756 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.63702849682002 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.45265308832202666 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6370414915593378 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6370287541415907 iter_best_vanilla_star_anomaly= 560 
last prior auc 0.4371919217495397 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6370416202201231 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6370291401239466 at iter 124
max_prior_anomaly= 0.5531703561433465 at iter 0
max_prior_star_anomaly= 0.6370610479987073 at iter 5
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6370287541415907
accuracies_anomaly['prior'][-1]= 0.42217785140605646
accuracies_anomaly['prior_star'][-1]= 0.6370399476299139



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.90711688995361 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6370279821768787
 first_prior_anomaly_auc= 0.4197341971103817
 first_prior_star_anomaly_auc= 0.6370377603965633


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6388395260342526; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42375446066942724; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6388240867400136 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6401198295090202; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4274646517358398; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6401202154913761 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6406901827703653; count_not_improved_vanilla_star_anomaly= 2 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.43144014134159236; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6406828491056017 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6419183786270761; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 370 
last prior auc 0.4389851957753974; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.641938063727231 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6424527068685303 at iter 490
0.4430506192700919 at iter 490
0.6424590112470112 at iter 490
last anomaly aucs:
0.6424527068685303
0.4430506192700919
0.6424590112470112




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.44819808006287 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6424345656977996,first_prior_anomaly_auc= 0.4433383047860783, first_prior_star_anomaly_auc= 0.6424496190096824


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6424345656977994 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.43152711603247196 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6424457591861228 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6424346943585848 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.419229332188767 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.642441899362563 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6424344370370142 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.41657158634631164 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6424447298998401 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6424345656977994 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.41416279912345977 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6424397121292125 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.64243482301937 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4283955125176651 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6424375248958619 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6424344370370141 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.434558621456296 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6424354663232967 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6424348230193702 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.43544753882210535 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6424308345350251 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6424343083762288 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4349850032988626 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6424255594428268 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6424341797154435 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.43518095367491233 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6424251734604708 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6424341797154435 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.43668293968279454 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6424233722094761 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6424345656977996 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4376235786843045 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6424218282800522 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6424345656977994 iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4385167418560296 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6424240155134029 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6424349516801555 at iter 27
max_prior_anomaly= 0.4433383047860783 at iter 0
max_prior_star_anomaly= 0.6424498763312532 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6424345656977994
accuracies_anomaly['prior'][-1]= 0.43920559170065887
accuracies_anomaly['prior_star'][-1]= 0.6424245301565441



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.08698773384094 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6424346943585848
 first_prior_anomaly_auc= 0.4393008006817992
 first_prior_star_anomaly_auc= 0.6424267173898948


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6414616328391729; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44080934838973307; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.641492511427651 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6403155225634993; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44134084609391; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 200 
last prior star auc 0.6403402254342816 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6392552290316372; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44232703101342496; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 270 
last prior star auc 0.6392837917259793 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6379910081550351; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44202802334833; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 270 
last prior star auc 0.6379970552119455 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6424346943585848 at iter 0
0.4430202553247553 at iter 490
0.6424267173898948 at iter 0
last anomaly aucs:
0.6371680937720974
0.4430202553247553
0.6372231605882165




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.8313901424408 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.637079575151794,first_prior_anomaly_auc= 0.44300983380114395, first_prior_star_anomaly_auc= 0.6371330980384892


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6370797038125793 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.444954541571329 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.63714133232875 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6370782885439408 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.44666045492395123 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371444201875978 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6370800897949352 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.44769257174382715 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371554850151356 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6370789318478673 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.44848409289514557 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371756847584317 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.637079189169438 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4494666753126714 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371987150390048 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6370800897949354 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4509366247850078 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6372146689763851 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6370790605086527 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4521789733281045 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6372379565785289 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6370788031870821 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4533254695861343 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6372607295375314 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6370794464910086 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.45476068064643294 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6372908361612974 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6370784172047261 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4564560438146585 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6373214574282047 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6370789318478675 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4574406848047496 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.637352850659824 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6370794464910088 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.4589983809326774 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6373754949580412 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6370806044380766 at iter 9
max_prior_anomaly= 0.45994004922047 at iter 129
max_prior_star_anomaly= 0.6373756236188265 at iter 121
last values
accuracies_anomaly['vanilla_star'][-1]= 0.63707996113415
accuracies_anomaly['prior'][-1]= 0.45994004922047
accuracies_anomaly['prior_star'][-1]= 0.6373738223678319



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 123.88495421409607 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6370287541415907
accuracies_anomaly["prior"][-1]= 0.42217785140605646
accuracies_anomaly["prior_star"][-1]= 0.6370399476299139


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 675.998831987381 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004428386688232422 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4053138962911727
 first_prior_anomaly_auc= 0.49802479962369295
 first_prior_star_anomaly_auc= 0.40531505423824066


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5509018091764989; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5937154867443366; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.5509607358161777 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.605227281850492; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5914811635463852; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 140 
last prior star auc 0.6052959867098555 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6149199421129394; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5825903172980824; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 140 
last prior star auc 0.6149437443582245 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.62990326252873; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5738734204315386; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 140 
last prior star auc 0.6299368429936998 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6363608760049695 at iter 490
0.5966341566594308 at iter 140
0.6363808184266948 at iter 490
last anomaly aucs:
0.6363608760049695
0.5605671933524574
0.6363808184266948




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.61220049858093 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6367786375749191,first_prior_anomaly_auc= 0.5591663347218405, first_prior_star_anomaly_auc= 0.6368093875026117


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6367795382004164 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5573343337996 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368100308065384 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6367799241827725 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5544506596181142 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368117033967476 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6367794095396311 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.5536771509767412 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368096448241825 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6367796668612018 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.5518522263976936 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368057850006228 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6367800528435578 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.5513827431920432 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.636801539194707 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6367795382004164 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.5503570594114335 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6367993519613564 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6367795382004164 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.5470652732188973 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6367962641025087 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6367795382004164 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.5371890140157913 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6367961354417233 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.636779795521987 iter_best_vanilla_star_anomaly= 850 
last prior auc 0.5124193682858369 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6367894450808864 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6367797955219872 iter_best_vanilla_star_anomaly= 850 
last prior auc 0.48531697385715766 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6367863572220387 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6367795382004164 iter_best_vanilla_star_anomaly= 850 
last prior auc 0.455376579825783 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.636785327935756 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6367796668612018 iter_best_vanilla_star_anomaly= 850 
last prior auc 0.4277031888318321 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6367844273102587 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6367803101651284 at iter 85
max_prior_anomaly= 0.5591663347218405 at iter 0
max_prior_star_anomaly= 0.6368119607183182 at iter 16
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6367795382004164
accuracies_anomaly['prior'][-1]= 0.4110030188966669
accuracies_anomaly['prior_star'][-1]= 0.6367827547200495



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.62319469451904 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6367795382004164
 first_prior_anomaly_auc= 0.41046946261992473
 first_prior_star_anomaly_auc= 0.636782111416123


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6401759256114219; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.41143145931179864; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 100 
last prior star auc 0.6401877624036717 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.642174156268302; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4129845236514549; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 200 
last prior star auc 0.6421849637742693 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6431622710995969; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4162862167244611; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 300 
last prior star auc 0.6431784823585477 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6438141952988379; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.42164429512931434; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 400 
last prior star auc 0.6438149672635498 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6438228155714546 at iter 430
0.42452127894996333 at iter 490
0.6438279620028676 at iter 430
last anomaly aucs:
0.6436828326370211
0.42452127894996333
0.6436655920917876




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.87052273750305 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6438854733739078,first_prior_anomaly_auc= 0.4245840654132018, first_prior_star_anomaly_auc= 0.643846746477525


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6438854733739078 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4189368862237236 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6438630863972612 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.643886759981761 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.41302312188705237 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6438782683699296 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6438859880170491 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4092107741570917 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6438870173033318 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6438857306954785 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4072171752884832 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439000120426495 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6438862453386197 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4154193003529423 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439159659800298 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6438856020346931 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.42025411534387935 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439266448252118 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6438856020346931 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.42435530653689424 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439415694763094 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6438853447131225 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4259959888713567 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439585526999724 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6438857306954784 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.42676203518718087 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439665296686625 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6438858593562637 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.42790492894322146 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439716761000754 iter_best_prior_star_anomaly= 950
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6438868886425464 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4291835598277798 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6439898172708063 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.643887145964117 iter_best_vanilla_star_anomaly= 780 
last prior auc 0.4297088818142612 iter_best_prior_anomaly= 1170
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6440089877278197 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6438871459641171 at iter 78
max_prior_anomaly= 0.4297154435143128 at iter 117
max_prior_star_anomaly= 0.6440335619378167 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6438865026601903
accuracies_anomaly['prior'][-1]= 0.42948488338701063
accuracies_anomaly['prior_star'][-1]= 0.6440335619378167



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.70515751838684 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6438861166778345
 first_prior_anomaly_auc= 0.4294766490967498
 first_prior_star_anomaly_auc= 0.6440353631888112


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6434707996628058; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4302084716436776; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.6435697398067206 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.642572232738097; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.43049525653416665; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 180 
last prior star auc 0.6426336039326971 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6409544520234225; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4316870413886307; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 300 
last prior star auc 0.6410088755356148 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6393611168579595; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4331644531865159; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 400 
last prior star auc 0.6394273771624017 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6442040374783722 at iter 10
0.43406597930928714 at iter 430
0.6442980885124445 at iter 10
last anomaly aucs:
0.6372950819672131
0.433774433969741
0.6374269592721711




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.80099511146545 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6370488252241013,first_prior_anomaly_auc= 0.43371923849283667, first_prior_star_anomaly_auc= 0.6371840477094778


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6370485679025306 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4350440585993266 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6372104231704694 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6370484392417454 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43586208387242203 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6372353833628224 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.637048696563316 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.43679461724445656 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6372495360492081 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6370483105809601 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.43729780957586195 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6372773267788383 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6370485679025306 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4383286397878847 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6373293057361096 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.63704831058096 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.43990409110418743 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6373796121031715 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6370485679025307 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4409148502336995 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6374350649016466 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.637048696563316 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4426688827200331 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6374907750216923 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6370475386162481 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4425077994168064 iter_best_prior_anomaly= 820
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6375356776357706 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6370481819201746 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4428693362235692 iter_best_prior_anomaly= 960
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6375777497125719 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6370484392417454 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4418054401897181 iter_best_prior_anomaly= 960
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376234242913621 iter_best_prior_star_anomaly= 1090
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.637047924598604 iter_best_vanilla_star_anomaly= 350 
last prior auc 0.44075350960890214 iter_best_prior_anomaly= 960
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376675549407286 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6370492112064573 at iter 35
max_prior_anomaly= 0.4430070032638668 at iter 96
max_prior_star_anomaly= 0.6376943163840761 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6370485679025307
accuracies_anomaly['prior'][-1]= 0.4390807907388937
accuracies_anomaly['prior_star'][-1]= 0.6376943163840761



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.66801929473877 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6367795382004164
accuracies_anomaly["prior"][-1]= 0.4110030188966669
accuracies_anomaly["prior_star"][-1]= 0.6367827547200495


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 676.5915269851685 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004427909851074219 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40515770209778834
 first_prior_anomaly_auc= 0.4877329660839877
 first_prior_star_anomaly_auc= 0.4051569301330764


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5522442558105785; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5935537601371832; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 50 
last prior star auc 0.5523018958424039 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6100721323826844; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5883364366314754; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 50 
last prior star auc 0.6101196082124694 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.622784847259062; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5766557099141885; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 50 
last prior star auc 0.6228096787906298 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6338600963206105; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5653608368920907; count_not_improved_prior_anomaly= 35; iter_best_prior_anomaly= 50 
last prior star auc 0.6338759215972053 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6363739994050726 at iter 490
0.5964158193067345 at iter 50
0.6363979303111429 at iter 490
last anomaly aucs:
0.6363739994050726
0.5540029200851837
0.6363979303111429




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.88709282875061 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.636635180799282,first_prior_anomaly_auc= 0.5534510939769255, first_prior_star_anomaly_auc= 0.6366436724111133


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6366353094600672 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5503887099646234 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6366447016973961 iter_best_prior_star_anomaly= 50
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6366355667816379 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.547358619809438 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6366468889307466 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6366358241032086 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5443305882268177 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6366488188425264 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6366342801737847 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.5423565457975784 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6366461169660346 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6366363387463498 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.5401830791510859 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6366486901817411 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6366374966934178 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.5354043602625503 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6366483041993851 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6366369820502765 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.5259975842650947 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.636650234111165 iter_best_prior_star_anomaly= 140
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6366358241032086 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.5113231783948692 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.636649462146453 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6366362100855646 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.48708927617500747 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6366461169660347 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6366354381208525 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4580446185310644 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6366479182170293 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6366336368698581 iter_best_vanilla_star_anomaly= 320 
last prior auc 0.4278656874036974 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6366448303581813 iter_best_prior_star_anomaly= 710
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6366364674071352 iter_best_vanilla_star_anomaly= 1140 
last prior auc 0.4169291346687294 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6366485615209557 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6366381399973444 at iter 114
max_prior_anomaly= 0.5534510939769255 at iter 0
max_prior_star_anomaly= 0.6366548658994367 at iter 122
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6366362100855645
accuracies_anomaly['prior'][-1]= 0.40605652634406775
accuracies_anomaly['prior_star'][-1]= 0.6366531933092274



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.53724408149719 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6366373680326325
 first_prior_anomaly_auc= 0.4053127383441048
 first_prior_star_anomaly_auc= 0.6366493334856678


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6384318000055582; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4078379635776756; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.638433729917338 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6393711523992149; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.41110864940141856; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.63937321097178 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6401444037190172; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.41666396479017487; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6401552112249845 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6407579870042314; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.4227209285809127; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6407662212944922 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6408170423046955 at iter 390
0.4263761814919917 at iter 490
0.6407705957611932 at iter 390
last anomaly aucs:
0.6401133964697538
0.4263761814919917
0.6401148117383925




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.78005003929138 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.640009695876782,first_prior_anomaly_auc= 0.426709798908339, first_prior_star_anomaly_auc= 0.6400090525728555


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.640016000255263 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4190035325105219 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6400086665904995 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6400143276650537 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4135304313635882 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6400078946257874 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6400166435591896 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41041053598024596 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.640000560961024 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6400078946257876 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.42128571752061406 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399933559570459 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6400111111454206 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.43013693624703697 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399992743531708 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.640016772219975 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.4330220256971613 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399928413139044 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6400143276650538 iter_best_vanilla_star_anomaly= 480 
last prior auc 0.43432072766423035 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399948998864697 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6400090525728555 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.43466733981989547 iter_best_prior_anomaly= 770
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399903967589833 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6400134270395565 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.4350003139323162 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399916833668367 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6400158715944777 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.4355073660872814 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399941279217577 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6400202460611787 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.4363477783370233 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399884668472035 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6400089239120701 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.43784538987820454 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6400032628375159 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6400268077612303 at iter 73
max_prior_anomaly= 0.4387878301307091 at iter 129
max_prior_star_anomaly= 0.6400138130219124 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6400178015062575
accuracies_anomaly['prior'][-1]= 0.4387878301307091
accuracies_anomaly['prior_star'][-1]= 0.6399976017629615



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.46769952774048 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6400131697179858
 first_prior_anomaly_auc= 0.43891288841404485
 first_prior_star_anomaly_auc= 0.6400018475688771


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6386631320975723; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44093672256720473; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6386814019290884 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6371458354562363; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4429627439537151; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6371785152957088 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6360051289335462; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4457100377027566; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6360661141457902 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6347684414650037; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44940221625922366; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6348142447045795 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6400131697179858 at iter 0
0.45201557413074206 at iter 490
0.6400018475688771 at iter 0
last anomaly aucs:
0.6336063772519497
0.45201557413074206
0.6336658185347698




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.92451524734497 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6334972729059942,first_prior_anomaly_auc= 0.45229618330353555, first_prior_star_anomaly_auc= 0.633567650355567


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6335035772844753 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4540783925018553 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6335815457203821 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6335031913021192 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4556492120298864 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6336023887676047 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6334965009412823 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.45715222732405125 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6336314661050881 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6335046065707577 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.45903234738000326 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6336606721033569 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.633495214333429 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.46078830977811674 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6337148382939786 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6334979162099208 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.462750515415106 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6337500913491576 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6334957289765704 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.46413542010834263 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6337962805710893 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6335022906766219 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.46504492319980406 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6338326915733361 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6335025479981926 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4664951875719857 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6338882730325964 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6334948283510731 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.46785937787878507 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6339317603780363 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.633496758262853 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4690754796216755 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6339814234411716 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.633496758262853 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4702550417015337 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6340285132886005 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6335076944296056 at iter 17
max_prior_anomaly= 0.4714295860107643 at iter 129
max_prior_star_anomaly= 0.6340743165281761 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6335028053197632
accuracies_anomaly['prior'][-1]= 0.4714295860107643
accuracies_anomaly['prior_star'][-1]= 0.6340743165281761



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.19006562232971 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6366362100855645
accuracies_anomaly["prior"][-1]= 0.40605652634406775
accuracies_anomaly["prior_star"][-1]= 0.6366531933092274


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 676.1000826358795 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004548311233520508 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40548475781408416
 first_prior_anomaly_auc= 0.4958234135867848
 first_prior_star_anomaly_auc= 0.40548424317094284


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5519644186024968; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5943621358513793; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 80 
last prior star auc 0.5520103505028578 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6020040718565339; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5931100090885979; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 150 
last prior star auc 0.6020812683277289 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.613480871229081; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5840812384784266; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 150 
last prior star auc 0.6135031295449422 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6225046240686246; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5772287650520254; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 150 
last prior star auc 0.6225237945256379 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6353835686796419 at iter 490
0.5961072907435255 at iter 150
0.6354005519033047 at iter 490
last anomaly aucs:
0.6353835686796419
0.5689358054731268
0.6354005519033047




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.64968395233154 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6363759293168524,first_prior_anomaly_auc= 0.5680234718443884, first_prior_star_anomaly_auc= 0.636376186638423


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6363760579776376 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5658521924312463 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363769586031349 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6363759293168523 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5629115215218615 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363751573521405 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6363764439599937 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5588763333117183 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.636376186638423 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6363765726207791 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5550983380114395 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363760579776377 iter_best_prior_star_anomaly= 130
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.636376186638423 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5495269400245176 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.636377730567847 iter_best_prior_star_anomaly= 470
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6363755433344964 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5409098839273859 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.636381719052192 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6363759293168524 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.529844670407093 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363831343208306 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6363758006560671 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5104679701548149 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363806897659094 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6363764439599937 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.47662233530647513 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363800464619829 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6363758006560671 iter_best_vanilla_star_anomaly= 940 
last prior auc 0.443750919924615 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363791458364856 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.636376186638423 iter_best_vanilla_star_anomaly= 940 
last prior auc 0.4106728753215233 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363818477129773 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6363758006560671 iter_best_vanilla_star_anomaly= 940 
last prior auc 0.3819954155588973 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363827483384745 iter_best_prior_star_anomaly= 620
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6363774732462764 at iter 94
max_prior_anomaly= 0.5680234718443884 at iter 0
max_prior_star_anomaly= 0.6363846782502544 at iter 62
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6363756719952818
accuracies_anomaly['prior'][-1]= 0.3731479279952488
accuracies_anomaly['prior_star'][-1]= 0.6363728414580045



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.6705117225647 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6363758006560671
 first_prior_anomaly_auc= 0.3735086928372997
 first_prior_star_anomaly_auc= 0.6363723268148633


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6390583780300901; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.3729988101450573; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6390588926732315 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6407250498431882; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.3735732805515328; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 200 
last prior star auc 0.6407146283195769 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6422257492432173; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.3730649417887143; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 200 
last prior star auc 0.6422227900451547 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6426370777739008; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.37376434181774015; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 350 
last prior star auc 0.6426320600032731 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6429943687747479 at iter 490
0.3740434070611098 at iter 350
0.6429782861765823 at iter 490
last anomaly aucs:
0.6429943687747479
0.3734011324207681
0.6429782861765823




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.02001142501831 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.643028849865215,first_prior_anomaly_auc= 0.373464433527148, first_prior_star_anomaly_auc= 0.6430069775317098


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.643028849865215 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.37133741342415755 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430095507474163 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.643029235847571 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.3709455126720581 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430107086944842 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6430289785260003 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.3709781925115306 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430123812846934 iter_best_prior_star_anomaly= 280
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6430293645083562 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.379108782179349 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.64301302458862 iter_best_prior_star_anomaly= 310
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6430292358475709 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.38966153979169305 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430152118219705 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6430292358475709 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.39578900969278885 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430157264651117 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6430297504907122 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.39985739238554596 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430146971788293 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6430289785260003 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4013966900211724 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430163697690385 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.643029235847571 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4021485836506108 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430231887906607 iter_best_prior_star_anomaly= 860
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6430291071867856 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4028612357405251 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430266626318644 iter_best_prior_star_anomaly= 960
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6430288498652149 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4036752725292755 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430306511162094 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6430294931691416 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4045424462223649 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6430368268339051 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6430297504907122 at iter 70
max_prior_anomaly= 0.40575919126918203 at iter 129
max_prior_star_anomaly= 0.6430463477320192 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6430285925436443
accuracies_anomaly['prior'][-1]= 0.40575919126918203
accuracies_anomaly['prior_star'][-1]= 0.6430463477320192



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.66513466835022 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6430288498652149
 first_prior_anomaly_auc= 0.4060036467612992
 first_prior_star_anomaly_auc= 0.643048277643799


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6432725333926204; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4069229280724453; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6432947917084815 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6419996922434015; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.40827463828306815; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6419955750982711 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.640317452475279; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.40893646936277916; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 290 
last prior star auc 0.6403788236698791 ; count_not_improved_prior_star_anomaly= 24 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6385361439024566; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41033359683062165; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 400 
last prior star auc 0.6385429629240789 ; count_not_improved_prior_star_anomaly= 34 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6433632392462743 at iter 60
0.41081620343637515 at iter 460
0.6433822810425024 at iter 80
last anomaly aucs:
0.6368158205418781
0.4104556959158949
0.6368230255458562




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.89579653739929 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6366035302460921,first_prior_anomaly_auc= 0.4103323102227684, first_prior_star_anomaly_auc= 0.6366261745443094


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6366040448892334 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4124245919137211 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6366345374953554 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6366040448892334 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41385581448967473 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6366401985699096 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6366041735500186 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41543473964718125 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6366606556347764 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6366043022108041 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41721669152393037 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6366867737741972 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6366036589068774 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.41928195444996486 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6367082601253464 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6366036589068773 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4215166636302722 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6367400393393217 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6366043022108041 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.424702947978842 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6367803101651284 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6366041735500187 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4279594811161992 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368254701007774 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.636603916228448 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.43021567664765575 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368714020011385 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6366045595323746 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.43252848292465523 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6369169479191434 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.636604302210804 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4341626035590661 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6369600492822272 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.636603916228448 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4352015394005642 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6369962029629035 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6366048168539453 at iter 6
max_prior_anomaly= 0.4360419516503062 at iter 129
max_prior_star_anomaly= 0.6370243796748897 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.636603916228448
accuracies_anomaly['prior'][-1]= 0.4360419516503062
accuracies_anomaly['prior_star'][-1]= 0.6370243796748897



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.42227530479431 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6363756719952818
accuracies_anomaly["prior"][-1]= 0.3731479279952488
accuracies_anomaly["prior_star"][-1]= 0.6363728414580045


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 677.6293585300446 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return
