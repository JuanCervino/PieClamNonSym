

/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.012024402618408203 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.488913539012664
 first_prior_anomaly_auc= 0.48493014773435883
 first_prior_star_anomaly_auc= 0.48891350887066864


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.44603275880278886; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46995100478944246; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.44603659286459396 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43717021642917187; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4693176792689143; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4371739781501881 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4355109960410297; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46786979646677945; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.435512882929937 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4349772355594523; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46627606257767595; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4349790259939745 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.488913539012664 at iter 0
0.48493014773435883 at iter 0
0.48891350887066864 at iter 0
last anomaly aucs:
0.4352345396883269
0.46344999732339076
0.43523613118568




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.76603555679321 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43525314935623927,first_prior_anomaly_auc= 0.46306438474882555, first_prior_star_anomaly_auc= 0.4352562660385557


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43525317346983555 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.46647226285363197 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43525528340950825 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43525316141303744 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4686438851054657 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352552412107147 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43525316141303744 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.46922149013343983 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352548192227802 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4352531674414365 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4712373626670409 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43525354723057763 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43525316141303744 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.47541114284460384 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43525194970482545 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43525316141303744 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4751695306384943 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352515036032947 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4352531794982346 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4791717003798856 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352511479277499 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4352531734698356 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.4857995574190543 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43524899578928383 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43525316141303744 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.489563653624587 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352448482507274 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43525316141303744 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.4884240812358122 iter_best_prior_anomaly= 930
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43524298547541646 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4352531794982346 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.4888363935898345 iter_best_prior_anomaly= 930
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43523799396099094 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4352531674414365 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.48765223516157796 iter_best_prior_anomaly= 930
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352364989180229 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4352531855266337 at iter 75
max_prior_anomaly= 0.4901528693491596 at iter 93
max_prior_star_anomaly= 0.43525638660653704 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43525316744143655
accuracies_anomaly['prior'][-1]= 0.48813082976331545
accuracies_anomaly['prior_star'][-1]= 0.43523535352220066



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.94782328605652 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4352531734698356
 first_prior_anomaly_auc= 0.48817516261003635
 first_prior_star_anomaly_auc= 0.43523449146113447


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43503345038072955; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4867938875891661; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4350141896457182 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.435003248101416; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4864136342613692; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4349920051371605 ; count_not_improved_prior_star_anomaly= 17 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43491828987339876; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4862520611096402; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.434904955054668 ; count_not_improved_prior_star_anomaly= 27 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4346975359280527; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4858141401163915; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.434683471673035 ; count_not_improved_prior_star_anomaly= 37 ; iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.4352629816751137 at iter 30
0.48817516261003635 at iter 0
0.43524078510975783 at iter 30
last anomaly aucs:
0.43456561044292336
0.485561797359947
0.4345443784214179




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.77516770362854 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4345495869582097,first_prior_anomaly_auc= 0.4855575111682121, first_prior_star_anomaly_auc= 0.4345274084780511


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43454958695820967 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48557970773356796 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43452540102116255 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43454958695820967 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.485889326309525 iter_best_prior_anomaly= 160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43452290526394977 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4345495990150078 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4860537267804153 iter_best_prior_anomaly= 260
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345211268862258 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4345495929866087 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4861778756307514 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345184864474355 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4345495929866088 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.48604468418181845 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43451586409384235 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4345495869582096 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4858716932422611 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43451691906367873 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4345495929866088 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4857301705458209 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345146584140295 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4345495990150078 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4854341339529563 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345123977643803 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4345495929866088 iter_best_vanilla_star_anomaly= 310 
last prior auc 0.4853882337224786 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345065743308839 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4345495990150078 iter_best_vanilla_star_anomaly= 930 
last prior auc 0.4853773343769698 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43449962358676236 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4345495929866087 iter_best_vanilla_star_anomaly= 930 
last prior auc 0.4855883464294275 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344960065473237 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43454959298660867 iter_best_vanilla_star_anomaly= 930 
last prior auc 0.485751927038045 iter_best_prior_anomaly= 420
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43449106928848974 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4345496050434069 at iter 93
max_prior_anomaly= 0.4862186878924187 at iter 42
max_prior_star_anomaly= 0.4345274084780511 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43454958695820967
accuracies_anomaly['prior'][-1]= 0.4855476607641406
accuracies_anomaly['prior_star'][-1]= 0.43448394974919446



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 113.09322214126587 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4345495869582097
 first_prior_anomaly_auc= 0.48558320420502543
 first_prior_star_anomaly_auc= 0.43448358201685155


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4344620244617966; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48537014249688576; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.43439190815227635 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43426663801971427; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4850977432567534; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.43420770439045897 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4340967396488771; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48480260489534943; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43404327377757335 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4339635180579488; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4844309239510224; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4339233930337749 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.4345495869582097 at iter 0
0.48558320420502543 at iter 0
0.43448358201685155 at iter 0
last anomaly aucs:
0.4340195701124513
0.48424452585194544
0.43397599081561344




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.50304198265076 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4340347857916903,first_prior_anomaly_auc= 0.48423145628277336, first_prior_star_anomaly_auc= 0.43398682987713155


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4340347918200894 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4843686023614927 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43398622100882606 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4340347857916903 iter_best_vanilla_star_anomaly= 170 
last prior auc 0.4842436939328745 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4339828330485518 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43403478579169036 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.48427859233505943 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4339827185089696 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4340347797632913 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.48426816923307675 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43398274262256575 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43403480387688753 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4843784829075595 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4339802830357474 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4340347918200894 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4842339701251833 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43397720855222455 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4340347797632913 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4840850807250862 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43397482130619497 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4340347918200894 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4838639711041953 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43397483939139214 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4340347978484885 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4828280932077304 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4339748092493968 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4340347918200894 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.48060963029516485 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43397770288094784 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4340347857916904 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4786166596496102 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43398262205458454 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4340347797632913 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.47587231537304453 iter_best_prior_anomaly= 440
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43398004792818395 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4340348099052866 at iter 22
max_prior_anomaly= 0.4844277228711191 at iter 44
max_prior_star_anomaly= 0.43398699264390633 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4340347797632913
accuracies_anomaly['prior'][-1]= 0.4713110839592017
accuracies_anomaly['prior_star'][-1]= 0.4339856302257177



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.96773982048035 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.43525316744143655
accuracies_anomaly["prior"][-1]= 0.48813082976331545
accuracies_anomaly["prior_star"][-1]= 0.43523535352220066


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 500.6274712085724 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.011749267578125 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5013615199571357
 first_prior_anomaly_auc= 0.49852375358026624
 first_prior_star_anomaly_auc= 0.5013614898151404


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4596205231300026; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48420350259631095; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.45962558698521694 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.442336042013601; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4770730639555268; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.44234103955642556 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43768229878771303; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4696526050641446; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43768455340896323 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4361560226841422; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4661428168731514; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43615691488720376 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5013615199571357 at iter 0
0.49852375358026624 at iter 0
0.5013614898151404 at iter 0
last anomaly aucs:
0.43563322183206427
0.46393876183435023
0.4356366459627329




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.59436511993408 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43556416049238034,first_prior_anomaly_auc= 0.46377191986183874, first_prior_star_anomaly_auc= 0.4355678800146032


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4355641484355822 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4652372609076647 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4355668732719594 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4355641544639813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46777835770976783 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4355663126308464 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4355641544639813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47009141223205575 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4355660714948838 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4355641484355822 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4739176310899491 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435565993125696 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4355641544639813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47759155450227364 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43556514914982697 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4355641484355822 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4808620212788019 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435563382828901 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4355641544639813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4872091719439272 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43556291864217306 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4355641544639813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4904063092742338 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4355628402729852 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4355641484355822 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49276182181113365 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43556230374546845 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4355641484355822 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4941659203508625 iter_best_prior_anomaly= 980
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43556115834964615 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43556414240718316 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4953193881994812 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43555846968366335 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4355641544639813 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4997328092966595 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43555841542807183 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43556416049238034 at iter 0
max_prior_anomaly= 0.5089401459547754 at iter 129
max_prior_star_anomaly= 0.4355678800146032 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4355641484355822
accuracies_anomaly['prior'][-1]= 0.5089401459547754
accuracies_anomaly['prior_star'][-1]= 0.43555473207624334



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 113.38932919502258 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43556414240718316
 first_prior_anomaly_auc= 0.5095003168526548
 first_prior_star_anomaly_auc= 0.43555469590584894


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43533813169785285; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5072751141899351; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.43532752171549915 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4350532355864596; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5030338460848441; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.43503729047093376 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43462260292767996; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4986015741837909; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43461320465353825 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4344170827467701; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49533170421877015; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4344115788184241 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.43556414240718316 at iter 0
0.5095003168526548 at iter 0
0.43555469590584894 at iter 0
last anomaly aucs:
0.43422554845169015
0.4940201898318752
0.4342133469719833




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.531452894210815 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4341909394126603,first_prior_anomaly_auc= 0.4939096289930307, first_prior_star_anomaly_auc= 0.43417677870325755


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4341909394126603 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49793713609569046 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43417439748562714 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4341909333842612 iter_best_vanilla_star_anomaly= 190 
last prior auc 0.5063981388644135 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4341728542154666 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4341909394126603 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5099608443423957 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4341712205193201 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4341909394126603 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.511533659686745 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4341693577440091 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4341909394126603 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5121250576917791 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.434166735390416 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4341909394126603 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.512577935143107 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4341627385618362 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4341909394126603 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5134354387396498 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43416106266689625 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4341909394126603 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5139561296520553 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43415789775738733 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4341909394126603 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5142272810135813 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43415539597177555 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43419093941266035 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.514583541313101 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43415334631609354 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4341909394126603 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.514549372347203 iter_best_prior_anomaly= 1040
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4341523516302479 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4341909394126603 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.5147338835573727 iter_best_prior_anomaly= 1160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4341510012688575 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4341909514694584 at iter 26
max_prior_anomaly= 0.5148214400253869 at iter 116
max_prior_star_anomaly= 0.43417707409481177 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4341909394126603
accuracies_anomaly['prior'][-1]= 0.514510543428828
accuracies_anomaly['prior_star'][-1]= 0.4341484211140578



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 113.69447350502014 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4341909394126603
 first_prior_anomaly_auc= 0.5145825767692508
 first_prior_star_anomaly_auc= 0.4341482583472831


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4339940880696053; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5140574911539272; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4339589364746598 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43405905009792534; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5132038517611848; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4340177193939385 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43396990213255826; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5127653580700249; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4339088043080387 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43364692462427396; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5119953386007072; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.433573938796799 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.4341909394126603 at iter 0
0.5145825767692508 at iter 0
0.4341482583472831 at iter 0
last anomaly aucs:
0.43361155600696205
0.5111094955001618
0.43353441058413256




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.535345792770386 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.433609024079355,first_prior_anomaly_auc= 0.5110099967736008, first_prior_star_anomaly_auc= 0.4335339222838083


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43360901805095586 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5108739538919103 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43353067297671255 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4336090240793549 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5102231158720996 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4335269715396869 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43360901805095586 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5093198205562621 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4335237764881827 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4336090361361531 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5058226920033045 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4335147158043886 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.433609024079355 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4989777643706183 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43350185722918383 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.433609024079355 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.49257623754593044 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43349238058585426 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.433609024079355 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.49234249240060013 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4334812099623876 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4336090240793549 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.49244933974562083 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4334631850491845 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.433609024079355 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.49182984940094593 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4334428934579331 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.433609024079355 iter_best_vanilla_star_anomaly= 940 
last prior auc 0.49143535699455854 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43342327704737693 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.433609024079355 iter_best_vanilla_star_anomaly= 940 
last prior auc 0.4913909035798563 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4334088932872089 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43360900599415775 iter_best_vanilla_star_anomaly= 940 
last prior auc 0.4928189047218762 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4333909708567898 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4336090421645521 at iter 94
max_prior_anomaly= 0.5110652410226286 at iter 2
max_prior_star_anomaly= 0.4335344045557335 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4336090120225568
accuracies_anomaly['prior'][-1]= 0.49354347609064586
accuracies_anomaly['prior_star'][-1]= 0.4333769186585703



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 113.2056176662445 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4355641484355822
accuracies_anomaly["prior"][-1]= 0.5089401459547754
accuracies_anomaly["prior_star"][-1]= 0.43555473207624334


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 501.11406779289246 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.011413335800170898 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4965342733777699
 first_prior_anomaly_auc= 0.4939612562026198
 first_prior_star_anomaly_auc= 0.49653399004301385


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45536836773620115; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4779357097764718; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.45537410677211054 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43820667305194694; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46682286248643007; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.438209566683498 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4352453787498451; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46218074804233766; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43525212452839834 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4350445366066093; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46108131876293396; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4350509809652094 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.4965342733777699 at iter 0
0.4939612562026198 at iter 0
0.49653399004301385 at iter 0
last anomaly aucs:
0.4354799738994434
0.4592441701764006
0.43548318100774575




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.47895574569702 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4354519117017978,first_prior_anomaly_auc= 0.4590377276504338, first_prior_star_anomaly_auc= 0.435452213121751


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4354519177301968 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4609395911009255 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4354523638317276 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4354519177301968 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4633094753411953 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43545245425771356 iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43545192375859587 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.46625753127895136 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4354526471664837 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43545192375859587 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.46905332191313415 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4354526953936761 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43545191170179776 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.47122223138538877 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4354533705743714 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.435451929786995 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.46821750246802657 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435452207093352 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43545192375859587 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.46277287548365853 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43545187553140335 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43545191170179776 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.46778289709426346 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435452586882493 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43545191170179776 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.4687922801768395 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435451839361009 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4354519177301968 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.4681509368855555 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4354521407809622 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43545191170179776 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.4682658321433274 iter_best_prior_anomaly= 510
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43545182127581183 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43545191170179776 iter_best_vanilla_star_anomaly= 380 
last prior auc 0.4725102410443309 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4354493074334019 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.435451929786995 at iter 38
max_prior_anomaly= 0.48020890452414466 at iter 129
max_prior_star_anomaly= 0.4354533705743714 at iter 50
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4354519237585959
accuracies_anomaly['prior'][-1]= 0.48020890452414466
accuracies_anomaly['prior_star'][-1]= 0.43544558188277993



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 113.55642890930176 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43545191773019687
 first_prior_anomaly_auc= 0.48110265688426296
 first_prior_star_anomaly_auc= 0.4354452804628267


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4353050840141807; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4794652532723356; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.43529298501725816 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43536021975202543; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4768402954108451; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4353471803248487 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4352375840298545; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47412558071568195; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4352277215689849 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.435061771799535; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4716008811590345; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4350479908792733 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.43545191773019687 at iter 0
0.48110265688426296 at iter 0
0.4354452804628267 at iter 0
last anomaly aucs:
0.4349304612111102
0.4697223837833172
0.4349195015816108




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.71956205368042 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4349112065044979,first_prior_anomaly_auc= 0.4695760263108271, first_prior_star_anomaly_auc= 0.43490229653068047


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4349112004760989 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47628038976252446 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349003794997779 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.434911206504498 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48098735169535467 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43489674437514203 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4349112065044979 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48320800291678057 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348955628089253 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4349112065044979 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48627371511908013 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348946826626619 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4349112065044979 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48854739213867826 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348912042764016 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4349112065044979 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49013636359252066 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43488891348475706 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4349112065044979 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49072538037992414 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348865382955257 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4349112065044979 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49098551785635913 iter_best_prior_anomaly= 740
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348852783601211 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4349112065044979 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49125954476423894 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43488367480596996 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.434911206504498 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49236029426303785 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348799552837471 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4349112065044979 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49274620222915727 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348794971254182 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4349112065044979 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4933980891904053 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4348810524523768 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.434911212532897 at iter 1
max_prior_anomaly= 0.4934264889783985 at iter 121
max_prior_star_anomaly= 0.43490252560984494 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.434911206504498
accuracies_anomaly['prior'][-1]= 0.4930463260765877
accuracies_anomaly['prior_star'][-1]= 0.43488090174240024



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.65977382659912 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43491120650449794
 first_prior_anomaly_auc= 0.49305389171741376
 first_prior_star_anomaly_auc= 0.4348810886227712


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4347946594653823; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4932802520738898; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 100 
last prior star auc 0.43475745821475464 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4347184785864031; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4933997771421434; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 160 
last prior star auc 0.4346830135147062 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4346300058017313; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49305417505216975; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 160 
last prior star auc 0.4345879094910633 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4346331767396392; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4921160597033353; count_not_improved_prior_anomaly= 27; iter_best_prior_anomaly= 160 
last prior star auc 0.4345784810749263 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.43491120650449794 at iter 0
0.49344618978654164 at iter 160
0.4348810886227712 at iter 0
last anomaly aucs:
0.43457916831241966
0.4914067823829924
0.4345330751731718




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.57659387588501 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4345721934547018,first_prior_anomaly_auc= 0.49133430896943797, first_prior_star_anomaly_auc= 0.4345277279832015


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4345721934547019 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.490737027246917 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43452540102116255 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4345721994831009 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.49028415582398815 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345216694421416 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.434572199483101 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4893178094823341 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345210183750426 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43457218742630277 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4865463856371704 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43451822119787664 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4345721934547019 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4806372041924863 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43451829956706445 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4345721934547019 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.47545040580771136 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43451684069449087 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43457219948310094 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4706605835297386 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43451315734266244 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43457219345470194 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4694614324730085 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345124821619672 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43457219948310094 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4694113244199836 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345128679795073 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43457219948310094 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.46910566650221197 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345148272092033 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4345721934547019 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4681066643228251 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345136335861885 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4345721934547019 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4695917001483951 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345177690679468 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.434572199483101 at iter 5
max_prior_anomaly= 0.49133430896943797 at iter 0
max_prior_star_anomaly= 0.4345277279832015 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4345721874263028
accuracies_anomaly['prior'][-1]= 0.4707306757256625
accuracies_anomaly['prior_star'][-1]= 0.43451845630544017



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.60764980316162 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4354519237585959
accuracies_anomaly["prior"][-1]= 0.48020890452414466
accuracies_anomaly["prior_star"][-1]= 0.43544558188277993


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 499.76163840293884 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.011493921279907227 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4989057611721909
 first_prior_anomaly_auc= 0.4953629976383144
 first_prior_star_anomaly_auc= 0.4989053693262516


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4524132887135348; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4777968214904228; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.45241658624782316 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4384642303735823; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47165202609669843; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.43846753996466875 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.436071896375196; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4665730878279871; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43607620668052716 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4356303161437151; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4626582334186472; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43563308317888577 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.4989057611721909 at iter 0
0.4953629976383144 at iter 0
0.4989053693262516 at iter 0
last anomaly aucs:
0.4354574819425335
0.46009217904441674
0.43545903124109303




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.89792013168335 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4354593507462434,first_prior_anomaly_auc= 0.45985742715644273, first_prior_star_anomaly_auc= 0.43545911563867995


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4354593447178444 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.463415852471089 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4354587358495388 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4354593447178444 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4659368204487155 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4354588443607221 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4354593507462434 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.46852695224880986 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4354590553546894 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4354593507462434 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4704378462411003 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4354594351438304 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4354593447178444 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.47184064264663117 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43545936883144065 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4354593447178444 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4756327769362133 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435460056068934 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4354593447178444 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.478281739882779 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43546033940369006 iter_best_prior_star_anomaly= 680
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4354593507462434 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4814449192411548 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435460707136033 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4354593447178444 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4827457995320998 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43546129791914134 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4354593447178444 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.48369116704500903 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43546144862911795 iter_best_prior_star_anomaly= 960
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4354593447178444 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.4825962650933028 iter_best_prior_anomaly= 1010
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43546130997593946 iter_best_prior_star_anomaly= 960
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4354593447178444 iter_best_vanilla_star_anomaly= 140 
last prior auc 0.47963679739611736 iter_best_prior_anomaly= 1010
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4354627869337102 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43545935677464254 at iter 14
max_prior_anomaly= 0.4839758642192331 at iter 101
max_prior_star_anomaly= 0.4354639323295325 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4354593447178444
accuracies_anomaly['prior'][-1]= 0.47791280788842544
accuracies_anomaly['prior_star'][-1]= 0.43546375147756056



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.34436702728271 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4354593447178444
 first_prior_anomaly_auc= 0.4779072798464832
 first_prior_star_anomaly_auc= 0.4354631426092551


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4354477219644479; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4762222759955419; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.435446703165006 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43544438223136606; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4751334988972853; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4354486623947019 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43558626663175015; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4745212667450841; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4355861701773652 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43571925311511495; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4742876421677351; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4357252393153861 ; count_not_improved_prior_star_anomaly= 23 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.4358530835743487 at iter 490
0.4779072798464832 at iter 0
0.4358592988537844 at iter 490
last anomaly aucs:
0.4358530835743487
0.4740764432349065
0.4358592988537844




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.965582847595215 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43587710071622204,first_prior_anomaly_auc= 0.4740856365434799, first_prior_star_anomaly_auc= 0.4358813989647551


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43587710071622204 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4745332934012179 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43588088052243557 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43587710071622204 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4751141356794898 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358812241411822 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43587710071622204 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4757235043421353 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43588010285895623 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43587710071622204 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.47650293414239275 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358808564088392 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4358771007162221 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.47640082511903675 iter_best_prior_anomaly= 410
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358842503975126 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43587710071622204 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4765492684176031 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358834847908315 iter_best_prior_star_anomaly= 530
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43587710071622204 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4761482050562353 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43588425039751266 iter_best_prior_star_anomaly= 530
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43587710071622204 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4760297952418087 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43588554047491246 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4358771007162221 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4757336863081553 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358853656513396 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43587710071622204 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4762819872882766 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358843528802967 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43587710071622204 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4757695854245849 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358799340637824 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43587710071622204 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.47566323240828756 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4358793915078666 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4358771007162221 at iter 11
max_prior_anomaly= 0.4766389227684917 at iter 58
max_prior_star_anomaly= 0.4358859383492507 at iter 76
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43587710071622204
accuracies_anomaly['prior'][-1]= 0.4761345748459503
accuracies_anomaly['prior_star'][-1]= 0.43588023548373567



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.54637169837952 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43587710071622204
 first_prior_anomaly_auc= 0.4760989349506805
 first_prior_star_anomaly_auc= 0.4358800486033646


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4360168992905297; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.47617894386306564; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 90 
last prior star auc 0.4360185209298782 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43601594680347755; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.475675867932727; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 90 
last prior star auc 0.43602005817163964 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4359522688241584; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4757159748717036; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 90 
last prior star auc 0.4359551262853149 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4358239784636649; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4755133905211383; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 90 
last prior star auc 0.43582881323971473 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.4360505317289111 at iter 130
0.4761853339660741 at iter 90
0.43605404628556577 at iter 150
last anomaly aucs:
0.4357840764902564
0.47516459940805944
0.43578317223039675




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.903377056121826 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43577486509648566,first_prior_anomaly_auc= 0.47508541638634616, first_prior_star_anomaly_auc= 0.4357684810218764


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4357748650964858 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4753038614548505 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43576745619403534 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4357748711248848 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.476104583560604 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43576979521287246 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43577487112488483 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47652980874542267 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357681615167259 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4357748650964857 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47638924456443377 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43576588881027856 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4357748590680867 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4765385680092635 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43576588278187955 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4357748711248848 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.476097216856947 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357610962330222 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43577484701128855 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47598653545012126 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43575922140091317 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43577487112488483 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47536854617681346 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43575488698198567 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4357748650964857 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47451468976170463 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357517341292749 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4357748590680867 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47222383783317157 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43574706211999986 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4357748650964857 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4675347681887651 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357423479119314 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43577487112488483 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4684027370860841 iter_best_prior_anomaly= 370
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43573768795945444 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43577487112488483 at iter 1
max_prior_anomaly= 0.4766376929750825 at iter 37
max_prior_star_anomaly= 0.4357716821017797 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43577485906808666
accuracies_anomaly['prior'][-1]= 0.4753232186442468
accuracies_anomaly['prior_star'][-1]= 0.43573637979685736



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.54447817802429 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4354593447178444
accuracies_anomaly["prior"][-1]= 0.47791280788842544
accuracies_anomaly["prior_star"][-1]= 0.43546375147756056


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 499.36795926094055 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.01129603385925293 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49641474228111726
 first_prior_anomaly_auc= 0.4933833497546924
 first_prior_star_anomaly_auc= 0.49641448305995745


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45753992970404417; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47881332411229405; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4575459882451041 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44018997414540206; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47419154948664566; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4401950259438182 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43609669118054867; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4705528620668535; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43609875892142774 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4356595418223802; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46776815163015145; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4356593067148167 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.49641474228111726 at iter 0
0.4933833497546924 at iter 0
0.49641448305995745 at iter 0
last anomaly aucs:
0.4352211506140045
0.4648779622950163
0.4352188959927544




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 55.67832922935486 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4351642184132385,first_prior_anomaly_auc= 0.46459141440227947, first_prior_star_anomaly_auc= 0.43516224109834534


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43516421841323855 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.46797910942701754 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435162204927951 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4351642184132386 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47168657485173754 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351623676947257 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43516421841323855 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47605675424242555 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351625304615005 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4351642184132385 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.47928496796991005 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351633864941677 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4351642184132385 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4838965847431347 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43516430281082547 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4351642184132385 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48674293556027215 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43516514075829543 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4351642184132385 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4865752616686898 iter_best_prior_anomaly= 610
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351649719631216 iter_best_prior_star_anomaly= 640
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4351642184132385 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4887558541783317 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351658400525869 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4351642184132385 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4936533135216027 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43516404961806476 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4351642184132385 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.49859762558240367 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435163880822891 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43516421841323855 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5011623416520417 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351625545750968 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4351642184132386 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5028419802278157 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351629283358387 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4351642184132386 at iter 1
max_prior_anomaly= 0.5066321673444998 at iter 129
max_prior_star_anomaly= 0.43516593650697194 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4351642184132386
accuracies_anomaly['prior'][-1]= 0.5066321673444998
accuracies_anomaly['prior_star'][-1]= 0.43516134286688474



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.79897618293762 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4351642184132385
 first_prior_anomaly_auc= 0.5066148477539874
 first_prior_star_anomaly_auc= 0.43516075811217547


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43504395788029915; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5065772606858197; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 40 
last prior star auc 0.4350529884220979 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43484087317261144; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5072695861479929; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 200 
last prior star auc 0.4348475827807703 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4349267296320892; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5083454263018569; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 300 
last prior star auc 0.43493064206308213 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4350670406203175; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5088389050208848; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 400 
last prior star auc 0.4350738587396594 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.43524021241184674 at iter 490
0.5090182559214553 at iter 450
0.4352520763012058 at iter 490
last anomaly aucs:
0.43524021241184674
0.5089715900842963
0.4352520763012058




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.87399625778198 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43524473973954425,first_prior_anomaly_auc= 0.5089747188234108, first_prior_star_anomaly_auc= 0.43526046180430467


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43524473371114514 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5107889474367007 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352619206768783 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43524474576794325 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5108863603371852 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43526246926119316 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43524474576794325 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5103521236120817 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352622522388268 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43524473371114514 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5103049755029976 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352620050744652 iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43524473371114514 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5105914329697485 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352631384134893 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43524473371114514 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.510697984923215 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43526318664068187 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43524474576794336 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.5106984792519385 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352640185597528 iter_best_prior_star_anomaly= 650
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43524474576794336 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.5108022943122297 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43526346394703885 iter_best_prior_star_anomaly= 650
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43524473371114514 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.5112491735064882 iter_best_prior_anomaly= 890
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352647962232321 iter_best_prior_star_anomaly= 880
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43524473371114514 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.5114994424936545 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43526424763891725 iter_best_prior_star_anomaly= 920
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43524474576794325 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.5126782356467435 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43526522423956565 iter_best_prior_star_anomaly= 920
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43524473371114514 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.5126077214628851 iter_best_prior_anomaly= 1120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4352645671440676 iter_best_prior_star_anomaly= 920
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43524474576794336 at iter 70
max_prior_anomaly= 0.5127163893844233 at iter 112
max_prior_star_anomaly= 0.43526582105107303 at iter 92
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43524474576794325
accuracies_anomaly['prior'][-1]= 0.5124880456846549
accuracies_anomaly['prior_star'][-1]= 0.43526453097367324



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.44409370422363 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43524473371114514
 first_prior_anomaly_auc= 0.5125140280846232
 first_prior_star_anomaly_auc= 0.4352644827464807


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43518544440634493; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.513734049458915; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4351930884163589 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43510467591567764; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5149122337436985; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.43512384019630396 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4349920895347475; count_not_improved_vanilla_star_anomaly= 27 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5159042068097761; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.4350263609834296 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4350240943053813; count_not_improved_vanilla_star_anomaly= 37 ;iter_best_vanilla_star_anomaly= 30 
last prior auc 0.5167520830530128; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.43506712501790434 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.4352518653072386 at iter 30
0.5176313973973713 at iter 490
0.43526811787111663 at iter 10
last anomaly aucs:
0.4350434876651721
0.5176313973973713
0.4350948797671977




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.88275146484375 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4350537600571782,first_prior_anomaly_auc= 0.5177138056125842, first_prior_star_anomaly_auc= 0.43509568757267236


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4350537540287791 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5176513453698761 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43509592870863495 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4350537540287791 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5177016161896756 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43510031738315397 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4350537540287791 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5179492206244554 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43510487485284677 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43505376005717816 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5180416359821154 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351076418880174 iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4350537540287791 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5177886240733748 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351060986178569 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43505376005717816 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5164584819333703 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351080457907548 iter_best_prior_star_anomaly= 430
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4350537540287791 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.5148710055224959 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351109394223057 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4350537540287791 iter_best_vanilla_star_anomaly= 790 
last prior auc 0.50890267342619 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43511304333357936 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4350537540287791 iter_best_vanilla_star_anomaly= 790 
last prior auc 0.5072740411349016 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4351110660186861 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4350537540287791 iter_best_vanilla_star_anomaly= 790 
last prior auc 0.5060978763638048 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43509959397526626 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4350537540287791 iter_best_vanilla_star_anomaly= 790 
last prior auc 0.5024765266197223 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4350855236918495 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4350537540287791 iter_best_vanilla_star_anomaly= 790 
last prior auc 0.4984380538591641 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4350775782618823 iter_best_prior_star_anomaly= 790
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43505377211397633 at iter 79
max_prior_anomaly= 0.5183189724810817 at iter 45
max_prior_star_anomaly= 0.4351140500762231 at iter 79
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43505374800038005
accuracies_anomaly['prior'][-1]= 0.49499170251152746
accuracies_anomaly['prior_star'][-1]= 0.43507965805955967



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.9193365573883 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4351642184132386
accuracies_anomaly["prior"][-1]= 0.5066321673444998
accuracies_anomaly["prior_star"][-1]= 0.43516134286688474


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 501.7623507976532 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.011504173278808594 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49677602423705786
 first_prior_anomaly_auc= 0.49464583517199506
 first_prior_star_anomaly_auc= 0.49677584941348507


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4581825932147234; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4793214578694481; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.45818774146752456 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43900057703835843; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.471963646101145; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.43900604479631006 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43591037747905853; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46458730906251644; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4359107572681996 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4363101748766228; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4597688880593812; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43631223658910284 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.49677602423705786 at iter 0
0.49464583517199506 at iter 0
0.49677584941348507 at iter 0
last anomaly aucs:
0.43716539973831925
0.4545500607903762
0.4371647848416147




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.88246464729309 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43721195103589594,first_prior_anomaly_auc= 0.45400467152700313, first_prior_star_anomaly_auc= 0.43721139039478296


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43721195103589605 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.45628419609369386 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4372108056400737 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43721195706429505 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4571331574487622 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43721047407812513 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43721195103589594 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4592457857873499 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43721013648777757 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43721194500749694 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.46412156700758467 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4372093527958991 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43721194500749694 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4669585135221814 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43720852690522727 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43721194500749694 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.46836065283221423 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43720762867376667 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43721194500749694 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4734796980399022 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43720585632444164 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43721194500749694 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.47743174164307156 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4372054463933053 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43721195103589594 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4791285008721887 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4372039031231447 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4372119450074969 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4811713143212095 iter_best_prior_anomaly= 960
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43720019565772006 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.437211951035896 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.47938962700607035 iter_best_prior_anomaly= 960
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.437197205571784 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43721195103589594 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4789066497582129 iter_best_prior_anomaly= 960
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4371928530676594 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43721195706429505 at iter 8
max_prior_anomaly= 0.48180948667458556 at iter 96
max_prior_star_anomaly= 0.43721187266670813 at iter 3
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4372119389790978
accuracies_anomaly['prior'][-1]= 0.4803175423036876
accuracies_anomaly['prior_star'][-1]= 0.4371862760842799



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 114.05790185928345 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43721195103589605
 first_prior_anomaly_auc= 0.4803238540375082
 first_prior_star_anomaly_auc= 0.4371858299827492


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4372936720136155; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4802148063268289; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.43727245807730725 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4372278418958302; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.48051638301843386; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 200 
last prior star auc 0.4372054584501034 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43752513239570023; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.48111986796359235; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 300 
last prior star auc 0.4374949240879876 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4377072623882395; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4819579902571426; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 400 
last prior star auc 0.4376833658143475 ; count_not_improved_prior_star_anomaly= 14 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.4378745564906808 at iter 490
0.4825757022240934 at iter 490
0.4378509492799439 at iter 490
last anomaly aucs:
0.4378745564906808
0.4825757022240934
0.4378509492799439




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.89548921585083 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4379001711583062,first_prior_anomaly_auc= 0.48261933577652294, first_prior_star_anomaly_auc= 0.4378748337970378


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4379001651299072 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.48335958701125964 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4378715061207541 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43790016512990715 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4840990907245123 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43786694262266224 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43790016512990726 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4837026571736261 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43786318090164594 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43790017115830626 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.48328868700986105 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43785827981320646 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4379001651299072 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.48308283526700263 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4378576227177084 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4379001651299072 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4829786946731619 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4378552776704723 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43790017115830626 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.48327297097349964 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4378532099295931 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4379001591015081 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.48411621740625477 iter_best_prior_anomaly= 210
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43784876699948255 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4379001651299072 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.48492311862104953 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.437844703858513 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43790015910150804 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4857767037582005 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4378410807906752 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43790015910150815 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.48700580992988246 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4378392240437633 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43790015910150815 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4882633942587456 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4378390009929979 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43790017115830626 at iter 6
max_prior_anomaly= 0.4889889181145676 at iter 129
max_prior_star_anomaly= 0.43787486393903313 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4379001651299072
accuracies_anomaly['prior'][-1]= 0.4889889181145676
accuracies_anomaly['prior_star'][-1]= 0.4378374758080345



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.51226758956909 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4379001651299072
 first_prior_anomaly_auc= 0.48902265906413206
 first_prior_star_anomaly_auc= 0.43783725878566815


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4381903119768856; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4882810936383993; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.43813570673815866 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4383210498673993; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.48749788403192834; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4382636112811119 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43846680449998293; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.48710076324354873; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43840742476919675 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43852863176078927; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4867661448966708; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4384788010141214 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 360
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.4385403027413783 at iter 490
0.48902265906413206 at iter 0
0.4385008468695006 at iter 490
last anomaly aucs:
0.4385403027413783
0.4863000411377952
0.4385008468695006




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.87013554573059 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4385255994760598,first_prior_anomaly_auc= 0.48626959772251904, first_prior_star_anomaly_auc= 0.43848592658181573


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43852559344766073 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48678111341154817 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4384836599037674 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4385255813908626 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.48709020751678667 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4384818513840481 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4385256055044589 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48700389289897994 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4384783187421962 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4385255874192617 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48669655908626835 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43847398432326884 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43852556933406445 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48677542260283124 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4384713257992813 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43852560550445885 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48566766207592027 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.438465695274555 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4385255874192616 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48481132196039683 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4384623615698723 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43852559947605974 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48299800966376494 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4384561221768405 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4385255813908626 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4805396104400297 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4384537831580034 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4385256055044589 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.47925406036790597 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43845041931132533 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4385255934476607 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.47828698458996516 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43844635617035577 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4385255994760598 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4774002251727619 iter_best_prior_anomaly= 220
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43844494552497465 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4385256115328579 at iter 21
max_prior_anomaly= 0.4871571167180045 at iter 22
max_prior_star_anomaly= 0.43848592658181573 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43852560550445885
accuracies_anomaly['prior'][-1]= 0.4756317641651704
accuracies_anomaly['prior_star'][-1]= 0.43844376998715706



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.33542704582214 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.4372119389790978
accuracies_anomaly["prior"][-1]= 0.4803175423036876
accuracies_anomaly["prior_star"][-1]= 0.4371862760842799


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 500.71734833717346 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.011371850967407227 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49670154336661493
 first_prior_anomaly_auc= 0.4936532773512083
 first_prior_star_anomaly_auc= 0.4967014047134364


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.460683607191446; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4835403666424084; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.46068918346058074 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.44047833658625746; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47768092551840613; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4404839791677819 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43569988386892045; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.472857844562794; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43570402537907776 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4346005992710942; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4685413661509733; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43460276949475746 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.49670154336661493 at iter 0
0.4936532773512083 at iter 0
0.4967014047134364 at iter 0
last anomaly aucs:
0.4345398510937204
0.4656808727096303
0.4345404418768287




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.96494650840759 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43453173686857943,first_prior_anomaly_auc= 0.4654734596114143, first_prior_star_anomaly_auc= 0.434532815952012


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4345317308401804 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4672829619598373 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43453211062932146 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43453173686857943 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.46784696089112277 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43453185140816164 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43453173686857943 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4690373888544065 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43453155601660753 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43453173686857943 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4712637369129485 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43453127871025055 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4345317428969785 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.47514132978767015 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43453120034106274 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4345317368685795 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4803689464625113 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43453139324983275 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43453173686857943 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4857581061470862 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43452930742375645 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43453173686857943 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.48664203221672914 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43452945813373306 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43453174289697855 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4739706568881211 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43452789677837533 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4345317308401804 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.47412917966992346 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43452734819406047 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4345317308401804 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.47392490133922094 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345267393257549 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4345317368685795 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4819477419787328 iter_best_prior_anomaly= 760
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43452559995833173 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43453174289697855 at iter 2
max_prior_anomaly= 0.48719290129485193 at iter 76
max_prior_star_anomaly= 0.434532815952012 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43453174289697855
accuracies_anomaly['prior'][-1]= 0.48364764200376265
accuracies_anomaly['prior_star'][-1]= 0.43452581698069803



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 113.16982984542847 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4345317428969785
 first_prior_anomaly_auc= 0.483837524517499
 first_prior_star_anomaly_auc= 0.4345258230090971


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4345006544430024; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.48445584535275543; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.4344968324379955 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4344252030003101; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4843196698462855; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 120 
last prior star auc 0.4344213086545144 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43441811360301014; count_not_improved_vanilla_star_anomaly= 28 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.4839577006528515; count_not_improved_prior_anomaly= 18; iter_best_prior_anomaly= 120 
last prior star auc 0.4344110844897008 ; count_not_improved_prior_star_anomaly= 28 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4344587088423111; count_not_improved_vanilla_star_anomaly= 38 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.48377999550522566; count_not_improved_prior_anomaly= 28; iter_best_prior_anomaly= 120 
last prior star auc 0.434448436450305 ; count_not_improved_prior_star_anomaly= 38 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.4346366490975005 at iter 490
0.4845316163005982 at iter 120
0.4346281972820119 at iter 490
last anomaly aucs:
0.4346366490975005
0.484026352061399
0.4346281972820119




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.93001842498779 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4346520938559039,first_prior_anomaly_auc= 0.48402805809833427, first_prior_star_anomaly_auc= 0.4346457278664917


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43465209385590386 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4867344475743893 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43464448601628436 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4346520878275048 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48793711921617305 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43464267146816593 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43465208782750486 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4882418849308832 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43464233990621737 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43465208782750486 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4872432565122384 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43464253884338655 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4346520878275048 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.48737829265128507 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43464132713517456 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43465209385590386 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.4878331594743043 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43464032642092987 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43465208782750475 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.48839958182201365 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43464014556895786 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43465208782750475 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.4890188732295195 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43463961506984017 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4346520878275048 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.4898276432480242 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43464122465239047 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43465208782750486 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.489985086946394 iter_best_prior_anomaly= 940
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4346399225181925 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43465208782750486 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.49005741567837086 iter_best_prior_anomaly= 1080
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4346379934304918 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4346520878275048 iter_best_vanilla_star_anomaly= 530 
last prior auc 0.49029009379706673 iter_best_prior_anomaly= 1180
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43464075443726335 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.434652099884303 at iter 53
max_prior_anomaly= 0.49032183934654083 at iter 118
max_prior_star_anomaly= 0.4346457278664917 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43465209385590386
accuracies_anomaly['prior'][-1]= 0.49015956087212126
accuracies_anomaly['prior_star'][-1]= 0.43464003102937565



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 113.87126898765564 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4346520938559039
 first_prior_anomaly_auc= 0.49017911097028777
 first_prior_star_anomaly_auc= 0.4346401335121598


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43474116345208313; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4904064057286188; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 90 
last prior star auc 0.4347162963059418 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43475953198403294; count_not_improved_vanilla_star_anomaly= 7 ;iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4904721695340144; count_not_improved_prior_anomaly= 7; iter_best_prior_anomaly= 170 
last prior star auc 0.43474631773328337 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43483935401604706; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 290 
last prior auc 0.49054976105837467; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 300 
last prior star auc 0.434831318160094 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.434932962996722; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4907351524148079; count_not_improved_prior_anomaly= 17; iter_best_prior_anomaly= 400 
last prior star auc 0.4349111582773054 ; count_not_improved_prior_star_anomaly= 7 ; iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.43499465160434986 at iter 490
0.4910141949507094 at iter 490
0.4349848253138746 at iter 490
last anomaly aucs:
0.43499465160434986
0.4910141949507094
0.4349848253138746




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.01759171485901 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43500490591115876,first_prior_anomaly_auc= 0.4910455546826433, first_prior_star_anomaly_auc= 0.43499621295970764


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4350049179679569 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.49149573743958935 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349991608468502 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4350049119395578 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.49128943959520033 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4350019519956171 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4350049059111588 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4913634562789152 iter_best_prior_anomaly= 110
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43500289845427026 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4350049059111588 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.49181532698759933 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43500320590262254 iter_best_prior_star_anomaly= 330
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4350049119395578 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.49226727003707227 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43500351335097476 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4350049059111587 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.49214322969791935 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43499901616527265 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43500490591115876 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4908513015795853 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43499297570941 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43500490591115876 iter_best_vanilla_star_anomaly= 790 
last prior auc 0.4874896552672052 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349902448446337 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43500490591115876 iter_best_vanilla_star_anomaly= 790 
last prior auc 0.4844941919992052 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43498953952194314 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4350049059111587 iter_best_vanilla_star_anomaly= 790 
last prior auc 0.4815629432380412 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43498712816231727 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4350049059111587 iter_best_vanilla_star_anomaly= 790 
last prior auc 0.478883139001861 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4349809671384733 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4350049059111587 iter_best_vanilla_star_anomaly= 790 
last prior auc 0.47416865362699834 iter_best_prior_anomaly= 540
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.434970580206885 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43500492399635593 at iter 79
max_prior_anomaly= 0.492374400716849 at iter 54
max_prior_star_anomaly= 0.43500511087672694 at iter 45
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43500490591115876
accuracies_anomaly['prior'][-1]= 0.47348312217057087
accuracies_anomaly['prior_star'][-1]= 0.434957323757342



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 112.93619775772095 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.43453174289697855
accuracies_anomaly["prior"][-1]= 0.48364764200376265
accuracies_anomaly["prior_star"][-1]= 0.43452581698069803


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 501.05493903160095 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.011708259582519531 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5061893995184032
 first_prior_anomaly_auc= 0.5024170202925559
 first_prior_star_anomaly_auc= 0.5061891402972435


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45594186742441234; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4797526571977397; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.45594609936055563 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4391677083740251; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4749717509219833; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.43917238641169914 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4361508563461439; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46985921035688605; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.436153569125723 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4352751771264213; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4664927352968552; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4352757920231259 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5061893995184032 at iter 0
0.5024170202925559 at iter 0
0.5061891402972435 at iter 0
last anomaly aucs:
0.4346377402377311
0.46425448717855977
0.4346430271437107




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.0062370300293 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43451851056103175,first_prior_anomaly_auc= 0.46412690214075686, first_prior_star_anomaly_auc= 0.4345201743991736


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4345185045326327 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46836953869243547 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345193846788961 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43451850453263263 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47102956375128463 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43451871552659993 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43451850453263274 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4709478849723586 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43451936659369883 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4345185045326327 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4721257919507851 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345196619852531 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43451850453263263 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.47214592077526174 iter_best_prior_anomaly= 460
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345201080867839 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43451849850423363 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.47208129030889034 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345209038354604 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43451849850423363 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.467000766571225 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43452115702822114 iter_best_prior_star_anomaly= 660
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4345185045326327 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.46150212513123823 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43451927616771296 iter_best_prior_star_anomaly= 660
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43451849850423363 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.46098359238569797 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345191254577364 iter_best_prior_star_anomaly= 660
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4345184985042337 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4571400177668977 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345178353803365 iter_best_prior_star_anomaly= 660
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43451849850423363 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4561190601581177 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345149779191799 iter_best_prior_star_anomaly= 660
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4345185045326327 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4551984392233686 iter_best_prior_anomaly= 580
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4345135431602025 iter_best_prior_star_anomaly= 660
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43451851658943086 at iter 122
max_prior_anomaly= 0.4726090826753938 at iter 58
max_prior_star_anomaly= 0.4345215669593575 at iter 66
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43451849850423363
accuracies_anomaly['prior'][-1]= 0.45609107030126084
accuracies_anomaly['prior_star'][-1]= 0.4345127835819204



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.47070360183716 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43451850453263263
 first_prior_anomaly_auc= 0.4560032666688851
 first_prior_star_anomaly_auc= 0.4345126087583475


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43425198298158835; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4562941248669532; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.43424810069259073 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43399580013493966; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45647471761773095; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 200 
last prior star auc 0.4339922373510925 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43415733108787524; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4568436315268874; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 300 
last prior star auc 0.4341576505930257 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43437200840696416; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4572843858676964; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 400 
last prior star auc 0.4343700732908644 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.43451850453263263 at iter 0
0.45753315378349557 at iter 490
0.4345126087583475 at iter 0
last anomaly aucs:
0.4344525900172605
0.45753315378349557
0.43444742367926215




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.23617887496948 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43446333262439363,first_prior_anomaly_auc= 0.4575966147404485, first_prior_star_anomaly_auc= 0.4344570208905729


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43446333262439363 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4572261816747278 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344559418071404 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4344633326243936 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.45660742679473876 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43445760564528224 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43446333262439363 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4558992406146266 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.434457304225329 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43446333262439363 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.45569282220225615 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43445711131655895 iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43446333262439363 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4563844001429454 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344599506925184 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4344633326243936 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4579583005991264 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43446019182848095 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43446333262439363 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4598595129825191 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344599446641193 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43446333865279263 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4617123112930241 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43445691840778883 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43446333262439363 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.46337004869499626 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344560925171171 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43446333262439363 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.46451819949564 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344556524439853 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43446333262439363 iter_best_vanilla_star_anomaly= 1060 
last prior auc 0.4655787938282697 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43445274072723716 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43446333262439363 iter_best_vanilla_star_anomaly= 1060 
last prior auc 0.4666333235914405 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43445285526681937 iter_best_prior_star_anomaly= 550
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43446333865279274 at iter 106
max_prior_anomaly= 0.46750533151613266 at iter 129
max_prior_star_anomaly= 0.43446077055479115 at iter 55
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43446333262439363
accuracies_anomaly['prior'][-1]= 0.46750533151613266
accuracies_anomaly['prior_star'][-1]= 0.4344550074052854



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.62022399902344 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43446333865279274
 first_prior_anomaly_auc= 0.4675774974813349
 first_prior_star_anomaly_auc= 0.43445481449651535


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4346232057675864; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.46699526264287905; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.43458473855315527 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.434750200022281; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.46576080928122676; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4347227587497389 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43471432501944757; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.4641732303875682; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43469101922866393 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4345941488840951; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 270 
last prior auc 0.46252678417704396; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43455600720321347 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.4347866356662273 at iter 270
0.4675774974813349 at iter 0
0.4347566323240829 at iter 260
last anomaly aucs:
0.4345262630822288
0.46069116680387306
0.43447897631996624




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 52.85761475563049 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4345223385944378,first_prior_anomaly_auc= 0.46050012683751634, first_prior_star_anomaly_auc= 0.4344843415951337


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4345223385944378 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.46177120272348604 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43448150221917425 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4345223446228368 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4611355743545152 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.434479331995511 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43452233859443773 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4602019983901763 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43447719794224215 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4345223385944378 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.45792595220974586 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43447409331672393 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43452233859443773 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4559401493306789 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344712599691635 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4345223385944378 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.45546162706973026 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.434471675928699 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4345223385944378 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.45527934033881534 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344707596120412 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43452233859443773 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4550454746255038 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344686737859649 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43452233859443773 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.45531460044494404 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43446742590735843 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4345223385944378 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.45504478135961135 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344654365356671 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4345223385944378 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4543720542227971 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344653943368737 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4345223385944378 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.4538680559474015 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4344631758860179 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43452234462283684 at iter 4
max_prior_anomaly= 0.46177120272348604 at iter 10
max_prior_star_anomaly= 0.43448481181026066 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4345223385944378
accuracies_anomaly['prior'][-1]= 0.45301545343929805
accuracies_anomaly['prior_star'][-1]= 0.4344643815658309



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.21860837936401 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.43451849850423363
accuracies_anomaly["prior"][-1]= 0.45609107030126084
accuracies_anomaly["prior_star"][-1]= 0.4345127835819204


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 490.5727655887604 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.011542558670043945 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.5086505296069146
 first_prior_anomaly_auc= 0.5049890066114658
 first_prior_star_anomaly_auc= 0.5086503668401399


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.45382865433111536; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4817479306917371; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.4538342607422454 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.439466294979694; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47669012196174715; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4394729322470641 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.437419171225342; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46961093074141114; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43742169109615103 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.436441057448714; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4638597837782051; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.436444511721378 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.5086505296069146 at iter 0
0.5049890066114658 at iter 0
0.5086503668401399 at iter 0
last anomaly aucs:
0.4357864697646851
0.45984965655004845
0.4357893513394379




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 52.97041702270508 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43572605314925983,first_prior_anomaly_auc= 0.4595123857075821, first_prior_star_anomaly_auc= 0.4357288684116229


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.435726071234457 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.46387434236194613 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435729344655149 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.435726071234457 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.46895953208048735 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43572936274034624 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4357260652060579 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.47437689864428534 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357303935965863 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43572606520605794 iter_best_vanilla_star_anomaly= 330 
last prior auc 0.479298212362655 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357316113331973 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4357260591776589 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.48759260826643014 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43573295566618875 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4357260652060579 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.49541929082877945 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357341492892035 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4357260591776589 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.5044542514440428 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43573504752066416 iter_best_prior_star_anomaly= 660
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4357260591776589 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.5161844007698989 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43573789895342163 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4357260832912551 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.5247854673624885 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.435739978751099 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43572607123445706 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.531621255942193 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4357447231011628 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4357260591776589 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.5342479258690178 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43574826177141374 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43572605314925983 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.5316357421851451 iter_best_prior_anomaly= 1120
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43575178235646744 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4357260832912552 at iter 58
max_prior_anomaly= 0.5348787013767416 at iter 112
max_prior_star_anomaly= 0.43575581535544167 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.435726071234457
accuracies_anomaly['prior'][-1]= 0.5301327839291562
accuracies_anomaly['prior_star'][-1]= 0.43575581535544167



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.85604333877563 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43572607123445706
 first_prior_anomaly_auc= 0.530163100748052
 first_prior_star_anomaly_auc= 0.4357568582684798


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.435228101358126; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5303661914841389; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 100 
last prior star auc 0.4352628189083389 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4349547737445377; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5318485567289231; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 200 
last prior star auc 0.43498415013317937 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43469765649603404; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5323204959780933; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 280 
last prior star auc 0.4347222764778138 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4345423046521397; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5314974446822045; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 280 
last prior star auc 0.4345652668241766 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.43572607123445706 at iter 0
0.5323556777150342 at iter 280
0.4357568582684798 at iter 0
last anomaly aucs:
0.434621113913111
0.5316499270081442
0.43463747498817223




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.6096305847168 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43461979369371584,first_prior_anomaly_auc= 0.5316331017463549, first_prior_star_anomaly_auc= 0.4346410257152213


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43461979369371584 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5312758286757921 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43464563744050577 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43461979369371584 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5315002358309714 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4346490254007801 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43461979369371584 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.532245804113683 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43465102080087037 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43461979972211495 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5331396348429891 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43465060484133494 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4346197997221149 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5334123415314738 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43465436053395223 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4346197936937159 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5331696020147392 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4346573687050854 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.4346197997221149 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5328205697656978 iter_best_prior_anomaly= 450
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4346595329003496 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43461979369371584 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5338958854488433 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4346590566568235 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43461979369371584 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5332720365716447 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43466126305088115 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43461979369371584 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5329586080474787 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4346640180292536 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4346197936937159 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.533762012790816 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43466334887695746 iter_best_prior_star_anomaly= 1020
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4346197997221149 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.5335868034004029 iter_best_prior_anomaly= 1160
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4346676230118942 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43461979972211495 at iter 11
max_prior_anomaly= 0.5341707322189959 at iter 116
max_prior_star_anomaly= 0.4346699138035388 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43461979972211495
accuracies_anomaly['prior'][-1]= 0.5337729784487144
accuracies_anomaly['prior_star'][-1]= 0.4346699138035388



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.06238126754761 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43461979972211495
 first_prior_anomaly_auc= 0.5337940115330508
 first_prior_star_anomaly_auc= 0.4346703297630743


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43463101254437503; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5332744720448667; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.43468685963330933 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4345224169636256; count_not_improved_vanilla_star_anomaly= 15 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5330787359556388; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.43456732250825764 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4342927108456687; count_not_improved_vanilla_star_anomaly= 25 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5328217694171117; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.4343440245785064 ; count_not_improved_prior_star_anomaly= 25 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4342522060323537; count_not_improved_vanilla_star_anomaly= 35 ;iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5331778548930586; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.4342963278851073 ; count_not_improved_prior_star_anomaly= 35 ; iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.43465322116652894 at iter 50
0.5337940115330508 at iter 0
0.4347025153856801 at iter 70
last anomaly aucs:
0.4342178019588921
0.5331775112743119
0.4342779593531576




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.12497162818909 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43421954416622177,first_prior_anomaly_auc= 0.5331845946432128, first_prior_star_anomaly_auc= 0.43427348025265267


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4342195501946209 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5327214327430807 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4342790444649893 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43421954416622177 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5323889966766642 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43428062993394323 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43421954416622177 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5321926999463231 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43428179341496265 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43421954416622177 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.5316901786286984 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43428418066099234 iter_best_prior_star_anomaly= 390
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.43421954416622177 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5309913545523335 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4342836803038699 iter_best_prior_star_anomaly= 440
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.43421953813782277 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.530457129884028 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4342838671842409 iter_best_prior_star_anomaly= 510
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43421953813782266 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5290742573374057 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43426922420291303 iter_best_prior_star_anomaly= 510
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43421954416622177 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5275999339769735 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43426627028737136 iter_best_prior_star_anomaly= 510
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43421955019462083 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5260626439883117 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4342641965180931 iter_best_prior_star_anomaly= 510
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43421954416622177 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.5266106797188741 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43426381070055303 iter_best_prior_star_anomaly= 510
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43421954416622177 iter_best_vanilla_star_anomaly= 1010 
last prior auc 0.5303334934476125 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4342558291001915 iter_best_prior_star_anomaly= 510
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4342195501946209 iter_best_vanilla_star_anomaly= 1010 
last prior auc 0.5299277761621668 iter_best_prior_anomaly= 20
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43425538299866073 iter_best_prior_star_anomaly= 510
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43421955622302 at iter 101
max_prior_anomaly= 0.5333105520132683 at iter 2
max_prior_star_anomaly= 0.4342852476876267 at iter 51
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43421954416622177
accuracies_anomaly['prior'][-1]= 0.5251302917889829
accuracies_anomaly['prior_star'][-1]= 0.43424701558075907



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.53157258033752 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.435726071234457
accuracies_anomaly["prior"][-1]= 0.5301327839291562
accuracies_anomaly["prior_star"][-1]= 0.43575581535544167


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 493.3181982040405 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of piegam on ellipticGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.01150369644165039 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.49722564032449185
 first_prior_anomaly_auc= 0.49423561467244814
 first_prior_star_anomaly_auc= 0.4972253690465339


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4541985207273239; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47296864653760107; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.45420207145437297 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43746046575893444; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4692831727126687; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.4374589707159664 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4331884166482198; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4688113660882779; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.43318933296487755 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43248602375960865; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46761890052611044; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.43248462517102565 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.49722564032449185 at iter 0
0.49423561467244814 at iter 0
0.4972253690465339 at iter 0
last anomaly aucs:
0.4332512807936653
0.46637756876112546
0.4332497857506972




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 52.91063451766968 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43326389823290745,first_prior_anomaly_auc= 0.46612748062593107, first_prior_star_anomaly_auc= 0.4332637897217243


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43326390426130645 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.47095616799267326 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4332644227036261 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4332639042613065 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4726865898021672 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4332645975271989 iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.43326390426130645 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.474054282839945 iter_best_prior_anomaly= 290
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4332646457543914 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4332638922045084 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4752196085495238 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.433264422703626 iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4332639163181046 iter_best_vanilla_star_anomaly= 500 
last prior auc 0.47935741726986825 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.433265441503068 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4332638922045084 iter_best_vanilla_star_anomaly= 500 
last prior auc 0.4901263685068717 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4332660865417679 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43326389823290745 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.5002883624408554 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.433267213852393 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43326391028970557 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.5038129563799512 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43326684009165095 iter_best_prior_star_anomaly= 740
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.4332639042613065 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.5001753118731972 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4332685762705816 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4332639042613065 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.49980701286074547 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4332699386887702 iter_best_prior_star_anomaly= 990
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.43326391028970557 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.5091910479238435 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4332713071353578 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43326391028970557 iter_best_vanilla_star_anomaly= 660 
last prior auc 0.5150965821870935 iter_best_prior_anomaly= 1190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43327699794407476 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4332639163181047 at iter 66
max_prior_anomaly= 0.515161960174949 at iter 119
max_prior_star_anomaly= 0.4332795961840716 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.43326391028970557
accuracies_anomaly['prior'][-1]= 0.5124490841415005
accuracies_anomaly['prior_star'][-1]= 0.43327931887771465



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.75254368782043 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43326391028970557
 first_prior_anomaly_auc= 0.5120719595528181
 first_prior_star_anomaly_auc= 0.4332800724275977


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4334018702022986; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.512254155857747; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 100 
last prior star auc 0.4334207511481689 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4334895954654865; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5131486979381429; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 200 
last prior star auc 0.43350878988810815 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.433601470495327; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5140317378331233; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 300 
last prior star auc 0.4336217440013812 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43358646581005533; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 350 
last prior auc 0.5146631824931434; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 400 
last prior star auc 0.4336010364505944 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.43364803987810097 at iter 350
0.5152399616304456 at iter 490
0.4336639005960399 at iter 350
last anomaly aucs:
0.4333935630683876
0.5152399616304456
0.4334208054037605




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 53.53704833984375 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.43338191017299577,first_prior_anomaly_auc= 0.5153130378839066, first_prior_star_anomaly_auc= 0.43340448652749264


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43338190414459665 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5134310440367318 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4334063251892073 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.4333818981161976 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5119596987054374 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43340630107561107 iter_best_prior_star_anomaly= 160
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4333819041445967 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.511277717976059 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43340939364433123 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43338189811619765 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5104697859050242 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.433410400386975 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4333819041445967 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5095489057491154 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43341125039124306 iter_best_prior_star_anomaly= 460
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4333819041445967 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.508869535316532 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43341200394112617 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43338190414459665 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.508565535208503 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4334136496940708 iter_best_prior_star_anomaly= 670
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.4333818981161976 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5082841476253653 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43341662772320877 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43338189811619765 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5077068319605463 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43341710396673483 iter_best_prior_star_anomaly= 860
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.43338190414459665 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5078619486968772 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43341813482297487 iter_best_prior_star_anomaly= 860
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4333818981161976 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5076275223424527 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43341862915169815 iter_best_prior_star_anomaly= 1060
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.43338190414459665 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5072784539230168 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43341758623866 iter_best_prior_star_anomaly= 1060
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.43338191017299577 at iter 0
max_prior_anomaly= 0.5153130378839066 at iter 0
max_prior_star_anomaly= 0.43342074511976986 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4333818981161976
accuracies_anomaly['prior'][-1]= 0.5067344632482267
accuracies_anomaly['prior_star'][-1]= 0.43342062455178854



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 110.26249408721924 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.43338190414459676
 first_prior_anomaly_auc= 0.5067473399086287
 first_prior_star_anomaly_auc= 0.4334206607221829


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.4333765629830255; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5068988094635256; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.4334101713078105 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43354462269214794; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5078231378636993; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 200 
last prior star auc 0.43358434381358457 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4335577344601135; count_not_improved_vanilla_star_anomaly= 17 ;iter_best_vanilla_star_anomaly= 230 
last prior auc 0.5088883077512191; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.4335942906720411 ; count_not_improved_prior_star_anomaly= 18 ; iter_best_prior_star_anomaly= 230
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.4337780603891259; count_not_improved_vanilla_star_anomaly= 18 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5092418492427606; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 400 
last prior star auc 0.43381560525850016 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.4339420991560724 at iter 490
0.5093277117306376 at iter 490
0.43398383979119554 at iter 490
last anomaly aucs:
0.4339420991560724
0.5093277117306376
0.43398383979119554




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 52.29587912559509 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.4339540052442249,first_prior_anomaly_auc= 0.5093537483861975, first_prior_star_anomaly_auc= 0.43399617992408074


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.43395398715902767 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5093194528239192 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43399896504444857 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.43395398113062866 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5090280098711418 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43399888667526076 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.4339539992158259 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5090290166137856 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43400031540583905 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.43395398715902767 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5090654703429291 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43400268456667146 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.4339540052442249 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5090460347843448 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43400504769910475 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.4339539931874268 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5093037428159568 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4340088817609099 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.43395398113062866 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5089459874734691 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43401084701900494 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.43395398113062866 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5017052050162069 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4340149101599744 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.43395398715902767 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49750106582095466 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43401679704888163 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.4339539931874268 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4983523722232591 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4340198896176018 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.4339539931874268 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.49282663915787606 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.4340210108998278 iter_best_prior_star_anomaly= 1080
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.4339539871590277 iter_best_vanilla_star_anomaly= 1160 
last prior auc 0.4926150242655119 iter_best_prior_anomaly= 80
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.43402309069750505 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.4339540112726239 at iter 116
max_prior_anomaly= 0.5094250764039298 at iter 8
max_prior_star_anomaly= 0.43402444105889554 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.4339539931874268
accuracies_anomaly['prior'][-1]= 0.4929780062299888
accuracies_anomaly['prior_star'][-1]= 0.4340241396389423



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 111.26473832130432 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.43326391028970557
accuracies_anomaly["prior"][-1]= 0.5124490841415005
accuracies_anomaly["prior_star"][-1]= 0.43327931887771465


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on piegam ellipticGGAD 
took 491.18534326553345 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return
