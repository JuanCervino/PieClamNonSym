

/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.004040241241455078 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4004430562803446
 first_prior_anomaly_auc= 0.4753165569962132
 first_prior_star_anomaly_auc= 0.4004435709234859


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5506926067395608; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5919574657736578; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.5507520480223809 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6048775818359791; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5915987595041722; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 160 
last prior star auc 0.6049679017072772 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6225675391926483; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5801280071885353; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 160 
last prior star auc 0.622614114396936 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6357440762001221; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5673001409092921; count_not_improved_prior_anomaly= 25; iter_best_prior_anomaly= 160 
last prior star auc 0.6357799725592277 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6398675257089981 at iter 490
0.5941583371674247 at iter 160
0.6398892693817181 at iter 490
last anomaly aucs:
0.6398675257089981
0.5566423960961229
0.6398892693817181




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 94.5096697807312 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6398855382189436,first_prior_anomaly_auc= 0.5556581410883878, first_prior_star_anomaly_auc= 0.6399137149309297


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6398855382189436 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5541381425705602 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399116563583646 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6398856668797289 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5513590696075434 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399068959093076 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.639885666879729 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5492010422552898 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399083111779461 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.639885666879729 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5467357729476804 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6399032934073184 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6398856668797289 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5415924293935342 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.639903550728889 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.639885666879729 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5331398017800477 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6398994335837587 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6398856668797289 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5182085889823138 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6398969890288375 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6398854095581583 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5008108202691172 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6398901700072153 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6398856668797289 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4868122695042031 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6398913279542833 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.639885666879729 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4616777417870674 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6398869534875822 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6398856668797289 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44664385768264425 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6398776899110389 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6398856668797289 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4436189139588718 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6398661104403596 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.639885666879729 at iter 1
max_prior_anomaly= 0.5556581410883878 at iter 0
max_prior_star_anomaly= 0.6399137149309297 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6398855382189436
accuracies_anomaly['prior'][-1]= 0.44239547855121786
accuracies_anomaly['prior_star'][-1]= 0.6398549169520362



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.1036262512207 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6398854095581583
 first_prior_anomaly_auc= 0.44225163579322463
 first_prior_star_anomaly_auc= 0.6398541449873244


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6415064067924661; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.44473504627156485; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6414900668727298 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6422424751453095; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.44720250281252477; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6422635755141027 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6420256817220371; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.450525167593539; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6419839956275919 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.641866399669805; count_not_improved_vanilla_star_anomaly= 22 ;iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4532094175577713; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6419499005194809 ; count_not_improved_prior_star_anomaly= 21 ; iter_best_prior_star_anomaly= 210
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6423969967484846 at iter 210
0.455027265793626 at iter 490
0.6424219569408377 at iter 210
last anomaly aucs:
0.6415971126461201
0.455027265793626
0.6415688072733485




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.38456392288208 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6414689665039365,first_prior_anomaly_auc= 0.4552133092892058, first_prior_star_anomaly_auc= 0.6414528839057709


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6414693524862924 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4557426197600322 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6414464508665046 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6414693524862924 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.45530221389186526 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.641435128717396 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6414693524862924 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.4547946470937588 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6414235492467169 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6414693524862924 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.45451004943662016 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6414198180839423 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6414693524862926 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.454103224033423 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6414271517487059 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6414688378431512 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.45399733620710064 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.641436286664464 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6414687091823659 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.4539110048201476 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6414559717646187 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.641469095164722 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.45512324673947835 iter_best_prior_anomaly= 60
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6414815752608982 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6414688378431512 iter_best_vanilla_star_anomaly= 240 
last prior auc 0.45747863973642033 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6415311096632484 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6414689665039365 iter_best_vanilla_star_anomaly= 970 
last prior auc 0.4592410351738001 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6415893929990006 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6414689665039366 iter_best_vanilla_star_anomaly= 970 
last prior auc 0.46170205867549385 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6416699346506138 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6414683232000099 iter_best_vanilla_star_anomaly= 970 
last prior auc 0.46821383834235497 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6417581959493467 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6414697384686485 at iter 97
max_prior_anomaly= 0.47253002170764774 at iter 129
max_prior_star_anomaly= 0.6418391235833161 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6414697384686485
accuracies_anomaly['prior'][-1]= 0.47253002170764774
accuracies_anomaly['prior_star'][-1]= 0.6418391235833161



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.52109622955322 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6414688378431512
 first_prior_anomaly_auc= 0.47277679309390075
 first_prior_star_anomaly_auc= 0.6418519896618485


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6401311516581287; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4762816415469349; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6404687575588213 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.638162384321088; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.47881407178448393; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6384482685860797 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6355290840278442; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48052693281951364; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6359133937936096 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6334241935799299; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.48143990975217876; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6337629574276901 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6414688378431512 at iter 0
0.4825619604609967 at iter 490
0.642041506998632 at iter 10
last anomaly aucs:
0.6316557510856398
0.4825619604609967
0.6321896933447378




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.17962050437927 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6314775558979648,first_prior_anomaly_auc= 0.48271854063673714, first_prior_star_anomaly_auc= 0.6320570440750679


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6314776845587502 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.48586339621243235 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6321392583168904 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6314774272371795 iter_best_vanilla_star_anomaly= 80 
last prior auc 0.48919609653470186 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6322427015882917 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6314769125940382 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4921057601948233 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6323465308420488 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6314775558979648 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.4945831236162533 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6324399385721946 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6314769125940383 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.49836549338323316 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6325127605766885 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6314779418803207 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5033364314850439 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6325890564223862 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6314776845587502 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5102954360416944 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6326688261092875 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6314774272371795 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.516582831298949 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6327200331018468 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6314774272371795 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5233529618227425 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6328790578325083 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6314774272371795 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5306073715424988 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6330037301334881 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.631478070541106 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5375966113837004 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.633070247759501 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6314775558979647 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.5461236049311048 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6331359934208022 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6314781992018914 at iter 22
max_prior_anomaly= 0.5542728504127952 at iter 129
max_prior_star_anomaly= 0.6332101020331491 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6314781992018914
accuracies_anomaly['prior'][-1]= 0.5542728504127952
accuracies_anomaly['prior_star'][-1]= 0.6332101020331491



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.7050039768219 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6398855382189436
accuracies_anomaly["prior"][-1]= 0.44239547855121786
accuracies_anomaly["prior_star"][-1]= 0.6398549169520362


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 675.1525173187256 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0038251876831054688 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4010382410732574
 first_prior_anomaly_auc= 0.4750206371899662
 first_prior_star_anomaly_auc= 0.40103631116147753


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5503293973425887; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.59349110233473; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 80 
last prior star auc 0.5504080090824222 ; count_not_improved_prior_star_anomaly= 6 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6082068083170449; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.588159656712439; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 80 
last prior star auc 0.6082587872743161 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6226325128892374; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5771707390378437; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 80 
last prior star auc 0.6226539992403868 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6334465805565762; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5639319302102729; count_not_improved_prior_anomaly= 32; iter_best_prior_anomaly= 80 
last prior star auc 0.6334585460096115 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6362217936960333 at iter 490
0.5944087110556668 at iter 80
0.6362551168394324 at iter 490
last anomaly aucs:
0.6362217936960333
0.5530850540426762
0.6362551168394324




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.27821230888367 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6364275222917677,first_prior_anomaly_auc= 0.552305884326749, first_prior_star_anomaly_auc= 0.6363602327010427


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6364281655956943 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5507018703161041 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363613906481107 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6364275222917677 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5500264011931487 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363616479696813 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6364273936309823 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5485987811191841 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363613906481107 iter_best_prior_star_anomaly= 240
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6364282942564796 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5461570567352892 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363656364540264 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6364285515780503 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.5409940280809883 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363646071677438 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6364277796133382 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.5288104950146519 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363687243128742 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6364281655956943 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.5111816515310119 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363666657403091 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6364273936309823 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.4811457911969262 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363724554756487 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.636427650952553 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.44934251765483296 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363549576088445 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.636427650952553 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.4270382698932733 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363552149304151 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6364281655956943 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.4263853164077497 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363535423402058 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6364273936309823 iter_best_vanilla_star_anomaly= 570 
last prior auc 0.42559122204072475 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363428634950239 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6364288088996208 at iter 57
max_prior_anomaly= 0.552305884326749 at iter 0
max_prior_star_anomaly= 0.6363724554756487 at iter 80
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6364275222917677
accuracies_anomaly['prior'][-1]= 0.42296062362397285
accuracies_anomaly['prior_star'][-1]= 0.636313142853614



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.85795140266418 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6364271363094117
 first_prior_anomaly_auc= 0.4225768285013489
 first_prior_star_anomaly_auc= 0.6363104409771221


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6378319834243737; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42445733453965684; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6377839929514475 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6398233950596317; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4265112753165827; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6397615092218905 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.640946346393947; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4276842756963894; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6408701792090347 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6414021915563529; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4292852018481864; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6415354841299494 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6418420827813786 at iter 420
0.4302879840090083 at iter 490
0.6417925483790285 at iter 420
last anomaly aucs:
0.6414945700002161
0.4302879840090083
0.6414321695193337




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.18200707435608 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.641402577538709,first_prior_anomaly_auc= 0.430384093615646, first_prior_star_anomaly_auc= 0.641352271171647


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.641401805573997 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42958125031521893 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6413406917009676 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6414011622700704 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4286578518589425 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6413246091028021 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6414012909308556 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42764065969016424 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6413123863281962 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6414012909308557 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.42675045571650166 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6413022221261555 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6414027061994942 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.42590361042749353 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6413015788222289 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6414027061994942 iter_best_vanilla_star_anomaly= 440 
last prior auc 0.42613610046657546 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6413024794477262 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.641406180040698 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4266603931667743 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.641315474187044 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6414034781642062 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4264964793262704 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6413414636656796 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6414016769132116 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4270336381050016 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6413900974425324 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6414015482524263 iter_best_vanilla_star_anomaly= 700 
last prior auc 0.4313585704036964 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6414611181960317 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6414028348602796 iter_best_vanilla_star_anomaly= 1030 
last prior auc 0.4342506075362283 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6415680353086367 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.641401419591641 iter_best_vanilla_star_anomaly= 1030 
last prior auc 0.4386541515747565 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6416789409055866 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6414065660230539 at iter 103
max_prior_anomaly= 0.44057621504672445 at iter 129
max_prior_star_anomaly= 0.6417839281064117 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6414038641465621
accuracies_anomaly['prior'][-1]= 0.44057621504672445
accuracies_anomaly['prior_star'][-1]= 0.6417839281064117



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.02052044868469 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6414041214681327
 first_prior_anomaly_auc= 0.44063784356289504
 first_prior_star_anomaly_auc= 0.6417957648986616


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6397216243784398; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44265820387485116; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6400805879694961 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6378819038090797; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44589453726891237; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.638332345218502 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6362417361177586; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44732588850565125; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.6366584684014258 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6347617511041669; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4496118046785179; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 400 
last prior star auc 0.6352147657292957 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6414041214681327 at iter 0
0.45046817086564006 at iter 490
0.6417957648986616 at iter 0
last anomaly aucs:
0.6334970155844236
0.45046817086564006
0.6342652491335983




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.56564736366272 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6333924143659545,first_prior_anomaly_auc= 0.45054961314275066, first_prior_star_anomaly_auc= 0.6341055810990102


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6333915137404572 iter_best_vanilla_star_anomaly= 30 
last prior auc 0.4517996813329669 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6340391921337826 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6333915137404573 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4548372338137012 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6340472977632581 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6333900984718186 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4572304530815287 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6341084116362873 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6333921570443839 iter_best_vanilla_star_anomaly= 110 
last prior auc 0.4598652973041963 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6341508696954445 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6333928003483105 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4632450874738947 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6341825202486344 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6333903557933893 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.469224211489511 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6341862514114087 iter_best_prior_star_anomaly= 560
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6333918997228132 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4738489234180127 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6342202178587345 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6333926716875251 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.48094688162281396 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.634222405092085 iter_best_prior_star_anomaly= 750
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6333904844541746 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4883516958006149 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6342541843060603 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6333906131149599 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.4984052495658985 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.634239774298104 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6333915137404572 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.5095022423001667 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6342274228627127 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6333920283835985 iter_best_vanilla_star_anomaly= 470 
last prior auc 0.5197809524397687 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6342090243704113 iter_best_prior_star_anomaly= 870
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.633393443652237 at iter 47
max_prior_anomaly= 0.5288665911170536 at iter 129
max_prior_star_anomaly= 0.6342590734159026 at iter 87
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6333916424012426
accuracies_anomaly['prior'][-1]= 0.5288665911170536
accuracies_anomaly['prior_star'][-1]= 0.6341697828308872



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.15705919265747 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6364275222917677
accuracies_anomaly["prior"][-1]= 0.42296062362397285
accuracies_anomaly["prior_star"][-1]= 0.636313142853614


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 682.3811962604523 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0037164688110351562 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40557379107752894
 first_prior_anomaly_auc= 0.4927655327019691
 first_prior_star_anomaly_auc= 0.4055725044696757


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5517985748502131; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5951434928006573; count_not_improved_prior_anomaly= 3; iter_best_prior_anomaly= 70 
last prior star auc 0.5518684376566445 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6082746125509111; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5864183616438525; count_not_improved_prior_anomaly= 13; iter_best_prior_anomaly= 70 
last prior star auc 0.6083124388217966 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6219693952016732; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5765235752876599; count_not_improved_prior_anomaly= 23; iter_best_prior_anomaly= 70 
last prior star auc 0.6220018177195751 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.633091219467509; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5647571604873465; count_not_improved_prior_anomaly= 33; iter_best_prior_anomaly= 70 
last prior star auc 0.6331136064441556 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6367162370940367 at iter 490
0.5974286370088118 at iter 70
0.6367471156825146 at iter 490
last anomaly aucs:
0.6367162370940367
0.5539263669179154
0.6367471156825146




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.20284867286682 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6371334840208451,first_prior_anomaly_auc= 0.5531160612919395, first_prior_star_anomaly_auc= 0.637176199401573


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6371334840208451 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5501979060199866 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371727255603692 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6371334840208451 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5467868512794544 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371701523446627 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6371334840208451 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5425367995578185 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371671931466002 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6371333553600598 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5373297689149367 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371700236838773 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6371333553600598 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5318754522426604 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371674504681708 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6371332266992744 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5245747246401873 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371652632348204 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6371332266992744 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5136160422501433 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371670644858148 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6371336126816305 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.5028899785599668 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371633333230405 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6371333553600598 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4912464348096387 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371621753759725 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6371336126816305 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4745008476172537 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371581868916274 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6371336126816305 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.45336908559235944 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371567716229889 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6371336126816305 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.43856614759759427 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6371469934033043 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6371336126816305 at iter 7
max_prior_anomaly= 0.5531160612919395 at iter 0
max_prior_star_anomaly= 0.637176199401573 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6371333553600598
accuracies_anomaly['prior'][-1]= 0.43443484978081354
accuracies_anomaly['prior_star'][-1]= 0.6371476367072308



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.77893829345703 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6371330980384892
 first_prior_anomaly_auc= 0.43412915175488165
 first_prior_star_anomaly_auc= 0.637149695279796


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6393018042359248; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4348915955687167; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6393023188790661 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6407600455767966; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4355890656859627; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6407388165472181 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 190
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6421503540230169; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.43629464143268415; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6421502253622315 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.642320314920431; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.4371987407711619; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6423084781281811 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6429629755431286 at iter 490
0.43770900944576024 at iter 490
0.6430041469944326 at iter 490
last anomaly aucs:
0.6429629755431286
0.43770900944576024
0.6430041469944326




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.52355575561523 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6429344128487865,first_prior_anomaly_auc= 0.4377285658851296, first_prior_star_anomaly_auc= 0.6429360854389957


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6429342841880011 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4388830391118495 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6429317109722947 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.642934541509572 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.439461112020314 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6429273365055936 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6429342841880012 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4397948580974467 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6429176869466944 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6429341555272159 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.43907345707413026 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6428976158641836 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.64293376954486 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.43842963850436467 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6428911828249173 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6429341555272159 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.43777308251685193 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6428778021032436 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6429341555272159 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.43684466628994784 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6428720123679039 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6429346701703572 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.43604709808171915 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6428792173718821 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6429341555272159 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.436660938688504 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6428726556718306 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6429341555272159 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.4369290677651209 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6428747142443958 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6429338982056454 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.43680915591319824 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6428842351425098 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6429342841880012 iter_best_vanilla_star_anomaly= 160 
last prior auc 0.43762653788236705 iter_best_prior_anomaly= 250
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6429182015898356 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6429347988311425 at iter 16
max_prior_anomaly= 0.4398447784821527 at iter 25
max_prior_star_anomaly= 0.6429477935704604 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6429342841880012
accuracies_anomaly['prior'][-1]= 0.4378617297979408
accuracies_anomaly['prior_star'][-1]= 0.6429477935704604



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.26387429237366 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6429340268664305
 first_prior_anomaly_auc= 0.4378778123961064
 first_prior_star_anomaly_auc= 0.642952039376376


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6420444661966945; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43851841444623885; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6421592316172043 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6407587589689434; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43934132882917654; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6407761281749622 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6394374127036572; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4401208845274598; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.6395589971457891 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6379387718761933; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4401426282001797; count_not_improved_prior_anomaly= 8; iter_best_prior_anomaly= 330 
last prior star auc 0.6381035863421944 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6429340268664305 at iter 0
0.44034655554491964 at iter 330
0.642952039376376 at iter 0
last anomaly aucs:
0.6366858731487
0.43939433707273046
0.636785327935756




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.3082823753357 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6365470481613345,first_prior_anomaly_auc= 0.4394131215473878, first_prior_star_anomaly_auc= 0.636662971528912


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.636546790839764 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4406564993767672 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6367042716410014 iter_best_prior_star_anomaly= 80
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6365470481613345 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4421220743824025 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6367446711275935 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6365465335181931 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.44333097112131475 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6367873865083213 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6365473054829051 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4446645401612068 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368119607183184 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6365467908397637 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4473514920019309 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368510735970572 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6365469195005491 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.4500183727601444 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368447692185761 iter_best_prior_star_anomaly= 540
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6365473054829051 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.4543520539922412 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368739752168449 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6365479487868317 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.46022245964425806 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368795076306139 iter_best_prior_star_anomaly= 760
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6365474341436904 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.46410274026887016 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368729459305623 iter_best_prior_star_anomaly= 880
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6365460188750518 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.4713369502453304 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368760337894102 iter_best_prior_star_anomaly= 880
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6365470481613345 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.48100220576050357 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368541614559049 iter_best_prior_star_anomaly= 880
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6365458902142664 iter_best_vanilla_star_anomaly= 750 
last prior auc 0.48974187558604987 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6368540327951195 iter_best_prior_star_anomaly= 880
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6365479487868317 at iter 75
max_prior_anomaly= 0.4976721404111175 at iter 129
max_prior_star_anomaly= 0.6368888998679426 at iter 88
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6365474341436903
accuracies_anomaly['prior'][-1]= 0.4976721404111175
accuracies_anomaly['prior_star'][-1]= 0.6368572493147526



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.76292014122009 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6371333553600598
accuracies_anomaly["prior"][-1]= 0.43443484978081354
accuracies_anomaly["prior_star"][-1]= 0.6371476367072308


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 683.1545913219452 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003859281539916992 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40897043581010495
 first_prior_anomaly_auc= 0.49861831182639643
 first_prior_star_anomaly_auc= 0.4089704358101049


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5524143453687778; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5939120804243129; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 40 
last prior star auc 0.552466324326049 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6092523058585947; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5882432862229003; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 40 
last prior star auc 0.6093047994590072 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6207903477649563; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.578090920974487; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 40 
last prior star auc 0.6208223843005022 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6295740195790835; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5683277546016816; count_not_improved_prior_anomaly= 36; iter_best_prior_anomaly= 40 
last prior star auc 0.629583669137983 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6355865953988844 at iter 490
0.5969199122636373 at iter 40
0.6356217197932781 at iter 490
last anomaly aucs:
0.6355865953988844
0.5578300638054566
0.6356217197932781




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.18208026885986 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6363285821478528,first_prior_anomaly_auc= 0.5568593181801806, first_prior_star_anomaly_auc= 0.6363558582343418


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6363281961654969 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5537798222834305 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363557295735565 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6363285821478528 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.5506114217840208 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363516124284261 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6363284534870675 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.5453895951508265 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363510977852848 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6363284534870676 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.5378061998029946 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363498111774315 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6363285821478528 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.5284384080234925 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363447934068038 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.636328196165497 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.5133262981615918 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363445360852331 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6363288394694235 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.48294163843849036 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363410622440293 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.636328196165497 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.44280680708190134 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.636335787151831 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6363288394694235 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.4088577289621603 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363284534870675 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6363284534870676 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.39047287470395153 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363256229497904 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6363289681302089 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.3850630746633977 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363202191968067 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6363284534870675 iter_best_vanilla_star_anomaly= 410 
last prior auc 0.38451214918063664 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6363148154438231 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6363292254517795 at iter 41
max_prior_anomaly= 0.5568593181801806 at iter 0
max_prior_star_anomaly= 0.6363568875206242 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6363290967909943
accuracies_anomaly['prior'][-1]= 0.3838040002182087
accuracies_anomaly['prior_star'][-1]= 0.6363121135673313



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.482492685318 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6363287108086382
 first_prior_anomaly_auc= 0.3837859877082632
 first_prior_star_anomaly_auc= 0.6363092830300541


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6405935585205862; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.38598338526082626; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6405289708063532 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6431329364405427; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.3881601970877374; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6431081049089751 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6448777053503331; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.39028991906721955; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6447940758398719 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6458085661321583; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.3921872796684051; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6457444930610664 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6466631310682859 at iter 490
0.3934204932957438 at iter 490
0.6466139826482918 at iter 490
last anomaly aucs:
0.6466631310682859
0.3934204932957438
0.6466139826482918




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.20835471153259 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6465918529932159,first_prior_anomaly_auc= 0.39353989050452526, first_prior_star_anomaly_auc= 0.6466970975156117


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6465913383500747 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.3938409567421854 iter_best_prior_anomaly= 70
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6467171685981223 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6465915956716453 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.3938279620028676 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6467216717256088 iter_best_prior_star_anomaly= 150
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6465915956716453 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.39361798760121747 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6467268181570218 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6465914670108599 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.39337378943067086 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6467278474433044 iter_best_prior_star_anomaly= 260
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.646591081028504 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.39378730519470495 iter_best_prior_anomaly= 130
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6467377543237744 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.64659146701086 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.3948149188870945 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6467445733453965 iter_best_prior_star_anomaly= 570
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.646591081028504 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.3941431809269135 iter_best_prior_anomaly= 560
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.646767346304399 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6465909523677187 iter_best_vanilla_star_anomaly= 720 
last prior auc 0.39642369334679634 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6468104476674829 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.646591081028504 iter_best_vanilla_star_anomaly= 720 
last prior auc 0.39869995996076363 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6468880301210338 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6465912096892893 iter_best_vanilla_star_anomaly= 720 
last prior auc 0.40456200266173437 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.64700536875725 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6465913383500745 iter_best_vanilla_star_anomaly= 720 
last prior auc 0.4107406795553895 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6471336435602189 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6465913383500747 iter_best_vanilla_star_anomaly= 720 
last prior auc 0.41413732428796546 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6472895804320327 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6465921103147866 at iter 72
max_prior_anomaly= 0.41748430595740604 at iter 129
max_prior_star_anomaly= 0.6474406281940039 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6465913383500748
accuracies_anomaly['prior'][-1]= 0.41748430595740604
accuracies_anomaly['prior_star'][-1]= 0.6474406281940039



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.43045425415039 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6465910810285039
 first_prior_anomaly_auc= 0.4177615699497811
 first_prior_star_anomaly_auc= 0.6474537515941071


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6472454497826662; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.42253797294418083; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6478654661071467 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6464926555277306; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4261442060960509; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6471453516916835 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6458493516011063; count_not_improved_vanilla_star_anomaly= 24 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4300490609306601; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6463872823445496 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6449888682688537; count_not_improved_vanilla_star_anomaly= 34 ;iter_best_vanilla_star_anomaly= 80 
last prior auc 0.4340369019718037; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6456401491641681 ; count_not_improved_prior_star_anomaly= 32 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6472814748025573 at iter 80
0.4360079852029804 at iter 490
0.647904836307456 at iter 90
last anomaly aucs:
0.644372711767933
0.4360079852029804
0.645035700794712




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.25556302070618 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.644298603155586,first_prior_anomaly_auc= 0.4361833498533782, first_prior_star_anomaly_auc= 0.6450265658789539


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.644298603155586 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.43496042908886556 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6449945293434081 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6442977025300886 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4353231238426962 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6450187175710491 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6442978311908738 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.43582683081724305 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6450422624947635 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6442989891379418 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4363717092430937 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6450643921498393 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6442984744948006 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4371790556710071 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6450768722460158 iter_best_prior_star_anomaly= 490
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6442984744948006 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.43838332062164775 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.645080860730361 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6442980885124446 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4392452192225389 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.645050368124239 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6442988604771565 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.44194014803195314 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6450232206985355 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6442986031555858 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4449311253083999 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6449942720218373 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6442980885124445 iter_best_vanilla_star_anomaly= 960 
last prior auc 0.44963676487087084 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.644944994941058 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6442989891379418 iter_best_vanilla_star_anomaly= 960 
last prior auc 0.4565714525390949 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6449048527760366 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6442980885124446 iter_best_vanilla_star_anomaly= 960 
last prior auc 0.4643208202999958 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6448342180048933 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6442995037810832 at iter 96
max_prior_anomaly= 0.4732048475266766 at iter 129
max_prior_star_anomaly= 0.6450835626068527 at iter 58
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6442988604771566
accuracies_anomaly['prior'][-1]= 0.4732048475266766
accuracies_anomaly['prior_star'][-1]= 0.6447795371711301



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.80734944343567 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6363290967909943
accuracies_anomaly["prior"][-1]= 0.3838040002182087
accuracies_anomaly["prior_star"][-1]= 0.6363121135673313


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 681.6817607879639 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0037741661071777344 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40436630960725517
 first_prior_anomaly_auc= 0.4904255789992661
 first_prior_star_anomaly_auc= 0.4043669529111819


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5501946895003536; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5949658122561234; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 80 
last prior star auc 0.5502572186420214 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6025896070905474; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.594482433685658; count_not_improved_prior_anomaly= 9; iter_best_prior_anomaly= 160 
last prior star auc 0.6026615284695439 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6142364960212938; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5859367843243815; count_not_improved_prior_anomaly= 19; iter_best_prior_anomaly= 160 
last prior star auc 0.6142578537116579 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6264901492156325; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5759250453143286; count_not_improved_prior_anomaly= 29; iter_best_prior_anomaly= 160 
last prior star auc 0.6265197411962571 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6351263757697775 at iter 490
0.5975525373450796 at iter 160
0.6351774541015515 at iter 490
last anomaly aucs:
0.6351263757697775
0.5640684393035025
0.6351774541015515




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.93634486198425 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6354035111013672,first_prior_anomaly_auc= 0.5630082744324258, first_prior_star_anomaly_auc= 0.6354542034507852


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6354035111013672 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5600642583426226 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354526595213613 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6354036397621525 iter_best_vanilla_star_anomaly= 90 
last prior auc 0.5570350688129344 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354486710370162 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6354035111013672 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.5539312560277578 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354485423762308 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6354035111013672 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.5518604606879544 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354468697860217 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6354031251190113 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.5495519002168705 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354433959448179 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6354027391366552 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.5461497230705257 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354404367467554 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6354036397621525 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.5381109972034291 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354332317427772 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.635402996458226 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.521631866497452 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354249974525163 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6354033824405819 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4938655824164966 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354278279897936 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6354033824405819 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.4604894307738072 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354211376289567 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6354029964582258 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.44100156760300835 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354139326249786 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.635402996458226 iter_best_vanilla_star_anomaly= 210 
last prior auc 0.43796298583599147 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6354149619112611 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6354045403876498 at iter 21
max_prior_anomaly= 0.5630082744324258 at iter 0
max_prior_star_anomaly= 0.6354547180939265 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6354032537797967
accuracies_anomaly['prior'][-1]= 0.4384435338691798
accuracies_anomaly['prior_star'][-1]= 0.6354139326249786



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.10303974151611 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6354037684229379
 first_prior_anomaly_auc= 0.43837675892159617
 first_prior_star_anomaly_auc= 0.6354153478936171


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6376086283010498; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.43743226009652647; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6375866273067592 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6388669307815269; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4358322345702267; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6388581818481247 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6395986246676693; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 280 
last prior auc 0.43429615345423334; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6396511182680817 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6398897840248593; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 340 
last prior auc 0.43310423993898395; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6398883687562208 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 340
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6407049787606776 at iter 490
0.43837675892159617 at iter 0
0.6407018909018298 at iter 490
last anomaly aucs:
0.6407049787606776
0.431753301693073
0.6407018909018298




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.9919867515564 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6407021482234004,first_prior_anomaly_auc= 0.43162451224696285, first_prior_star_anomaly_auc= 0.6406851649997376


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6407015049194738 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4339266396787803 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6406876095546586 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6407012475979031 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4344502890750525 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6406904400919359 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6407013762586884 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4340138716912306 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6406977737566993 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6407021482234004 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.43300722970684896 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6406937852723543 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6407018909018297 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.43163609171764206 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6407007329547618 iter_best_prior_star_anomaly= 450
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6407018909018298 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.43031770465041835 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6407009902763325 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6407011189371178 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4306926221788549 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6407101251920906 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.640701247597903 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.43037920450580364 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6407183594823513 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6407018909018298 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4285818133348155 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6407323835079517 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6407017622410445 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.42916927848060876 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6407762568357476 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6407011189371179 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.4322622837598181 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6408686352796108 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6407021482234004 iter_best_vanilla_star_anomaly= 130 
last prior auc 0.43379785023267015 iter_best_prior_anomaly= 190
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6409942082060878 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6407026628665418 at iter 13
max_prior_anomaly= 0.43908284931145897 at iter 129
max_prior_star_anomaly= 0.6411801230408822 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6407016335802591
accuracies_anomaly['prior'][-1]= 0.43908284931145897
accuracies_anomaly['prior_star'][-1]= 0.6411801230408822



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.30245876312256 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6407017622410444
 first_prior_anomaly_auc= 0.4396299149706602
 first_prior_star_anomaly_auc= 0.6411945330488387


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6391920565860427; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4413470218116056; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6396915177546737 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6368648403010869; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4430472740896735; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6373361247577318 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6345093186433595; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4452077459968483; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6350265350003654 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6322420582843651; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4475298158503912; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6326910844251488 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6407017622410444 at iter 0
0.44949626729329617 at iter 490
0.6411945330488387 at iter 0
last anomaly aucs:
0.6302083172507352
0.44949626729329617
0.6307080357409369




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.96344804763794 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6300189285747371,first_prior_anomaly_auc= 0.44969196034777525, first_prior_star_anomaly_auc= 0.6305320277866124


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6300189285747371 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.45187584851787926 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6306004753244052 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6300191858963077 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.454296086550625 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6307039185958065 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6300191858963077 iter_best_vanilla_star_anomaly= 220 
last prior auc 0.45625443236405444 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6307683776492542 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6300206011649463 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4581431726926233 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.630827304288933 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6300191858963077 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4596963656930648 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6308752947618592 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.630019700539449 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4618706043042694 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6309228992524294 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6300191858963076 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.46421351720503484 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6309503039997035 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6300198292002342 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4672923697978585 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6309832411607468 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6300198292002342 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4709450494932309 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6310215820747735 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6300189285747371 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.4748564660278916 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6310895149694251 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6300194432178783 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.47893063845598827 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6311157617696314 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6300190572355224 iter_best_vanilla_star_anomaly= 360 
last prior auc 0.48513337491649916 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6311533307189462 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6300209871473023 at iter 36
max_prior_anomaly= 0.4917291700761775 at iter 129
max_prior_star_anomaly= 0.6312044090507201 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6300191858963076
accuracies_anomaly['prior'][-1]= 0.4917291700761775
accuracies_anomaly['prior_star'][-1]= 0.6312044090507201



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.38583779335022 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6354032537797967
accuracies_anomaly["prior"][-1]= 0.4384435338691798
accuracies_anomaly["prior_star"][-1]= 0.6354139326249786


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 680.9983596801758 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003755331039428711 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40808473496392866
 first_prior_anomaly_auc= 0.5104190790563914
 first_prior_star_anomaly_auc= 0.40808589291099656


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5527568403793126; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5976959941207167; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.5528414991760563 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6006418114615144; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5925137950094026; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.6007411375877854 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6142143663662181; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5840475293526716; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 60 
last prior star auc 0.6142373966467912 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6279496771643573; count_not_improved_vanilla_star_anomaly= 12 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5715990837293512; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 60 
last prior star auc 0.6279802984312648 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.634279401819984 at iter 490
0.5998176104707236 at iter 60
0.6343107950516033 at iter 490
last anomaly aucs:
0.634279401819984
0.5613711945999524
0.6343107950516033




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.20409202575684 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6344617141527893,first_prior_anomaly_auc= 0.5602115749418195, first_prior_star_anomaly_auc= 0.6344893762216341


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.63446197147436 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5565385668423658 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.634485773719645 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6344617141527893 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5521836565806904 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6344856450588597 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.634461585492004 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5475265221342868 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6344830718431531 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.63446197147436 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5404702500239309 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6344794693411642 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6344609421880774 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5321875833078584 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6344753521960337 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6344618428135747 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5187373848099989 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6344765101431017 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6344618428135747 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5026663661150722 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6344705917469767 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.634461585492004 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.47127480708601854 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6344654453155637 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6344621001351453 iter_best_vanilla_star_anomaly= 810 
last prior auc 0.4354147303218475 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6344628720998572 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6344615854920039 iter_best_vanilla_star_anomaly= 810 
last prior auc 0.40035543828553843 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.634451678611534 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6344613281704333 iter_best_vanilla_star_anomaly= 810 
last prior auc 0.38598956097852194 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6344475614664036 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6344617141527893 iter_best_vanilla_star_anomaly= 810 
last prior auc 0.385083017085123 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6344340520839444 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.634462357456716 at iter 81
max_prior_anomaly= 0.5602115749418195 at iter 0
max_prior_star_anomaly= 0.6344893762216341 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6344618428135747
accuracies_anomaly['prior'][-1]= 0.3869109008622331
accuracies_anomaly['prior_star'][-1]= 0.6344152676092871



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.28695178031921 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.63446197147436
 first_prior_anomaly_auc= 0.3871010615029432
 first_prior_star_anomaly_auc= 0.6344098638563034


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6361489716915394; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.38615836392886804; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 0 
last prior star auc 0.6360896590695047 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6368769344149074; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 180 
last prior auc 0.3848338011439488; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 0 
last prior star auc 0.6368276573341279 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 180
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6365711077281901; count_not_improved_vanilla_star_anomaly= 13 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.3837126510606281; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 0 
last prior star auc 0.6364484939997755 ; count_not_improved_prior_star_anomaly= 12 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6357829317572902; count_not_improved_vanilla_star_anomaly= 23 ;iter_best_vanilla_star_anomaly= 220 
last prior auc 0.38208573543019536; count_not_improved_prior_anomaly= 40; iter_best_prior_anomaly= 0 
last prior star auc 0.6357115250214349 ; count_not_improved_prior_star_anomaly= 22 ; iter_best_prior_star_anomaly= 220
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6370266955690256 at iter 220
0.3871010615029432 at iter 0
0.6369923431393437 at iter 220
last anomaly aucs:
0.6357897507789124
0.3806335411462338
0.6357440762001221




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.27983856201172 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6356805177721716,first_prior_anomaly_auc= 0.3804912423176645, first_prior_star_anomaly_auc= 0.6356453933777779


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6356815470584543 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.38386820195008586 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6356456506993485 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6356807750937423 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.386210986190066 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6356305973874655 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6356801317898156 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.3869092282720239 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6356205618462103 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6356805177721716 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.3870889673891227 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6356132281814467 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.635680260450601 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.3871987150390048 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6356006194244849 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6356809037545277 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.3874344215977199 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6355952156715012 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6356812897368835 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.38846936895487305 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6355900692400882 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.635680646432957 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.39026933334156766 iter_best_prior_anomaly= 790
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635593543081292 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6356800031290304 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.3899734135353205 iter_best_prior_anomaly= 790
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.635612970859876 iter_best_prior_star_anomaly= 70
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6356801317898157 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.39220452021363866 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6356511831131175 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.635680260450601 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.3985032376200019 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6357215605626902 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6356809037545277 iter_best_vanilla_star_anomaly= 640 
last prior auc 0.403925389095947 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6358428876832516 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6356820617015955 at iter 64
max_prior_anomaly= 0.41050741755159553 at iter 129
max_prior_star_anomaly= 0.6359669166803047 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6356805177721716
accuracies_anomaly['prior'][-1]= 0.41050741755159553
accuracies_anomaly['prior_star'][-1]= 0.6359669166803047



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.73908972740173 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6356800031290303
 first_prior_anomaly_auc= 0.41142901475687743
 first_prior_star_anomaly_auc= 0.6359793967764813


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6341965442742349; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41571547748076; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6344532225409579 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6327392035588602; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.41977614052639756; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6330222572865749 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6311250253461748; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4244663407946295; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6316331067874225 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6299350417427052; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43015005964714004; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6302757355022454 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6356800031290303 at iter 0
0.4351130207802607 at iter 490
0.6359793967764813 at iter 0
last anomaly aucs:
0.6283983173227852
0.4351130207802607
0.628805400047553




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.30590224266052 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6282109872193522,first_prior_anomaly_auc= 0.4356023177468512, first_prior_star_anomaly_auc= 0.6286498491580953


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.628209314629143 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4373692163117173 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6287087757977741 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.628209314629143 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.4410336041385543 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6287832703924772 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.628209314629143 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.44416379238472253 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6288647126695879 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.628209314629143 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.44616266634552937 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6289311016348154 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6282095719507137 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4484635071694936 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6289837238960132 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6282098292722843 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.45126715434250736 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.629007783462869 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6282106012369962 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.45361881617667493 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6290372467827084 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6282097006114991 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.45574377770710006 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6290515281298794 iter_best_prior_star_anomaly= 730
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6282116305232789 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4588186418155787 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6290773889477298 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6282099579330697 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4616594719555513 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6290946294929632 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6282095719507137 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4660392137487944 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6290916702949008 iter_best_prior_star_anomaly= 1070
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6282090573075724 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4709761854032795 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6290950154753192 iter_best_prior_star_anomaly= 1070
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6282117591840641 at iter 29
max_prior_anomaly= 0.4759329708187046 at iter 129
max_prior_star_anomaly= 0.6291136712891914 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6282093146291431
accuracies_anomaly['prior'][-1]= 0.4759329708187046
accuracies_anomaly['prior_star'][-1]= 0.6291122560205528



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.99479055404663 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6344618428135747
accuracies_anomaly["prior"][-1]= 0.3869109008622331
accuracies_anomaly["prior_star"][-1]= 0.6344152676092871


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 683.1277852058411 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003809690475463867 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40110308610906115
 first_prior_anomaly_auc= 0.486748839737038
 first_prior_star_anomaly_auc= 0.4011017995012079


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5509633090318842; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5960722950099172; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 80 
last prior star auc 0.5510250662088402 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6039061929067765; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5931214598984917; count_not_improved_prior_anomaly= 12; iter_best_prior_anomaly= 80 
last prior star auc 0.603969751334727 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.613485245695782; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5851960841832665; count_not_improved_prior_anomaly= 22; iter_best_prior_anomaly= 80 
last prior star auc 0.6135089192802818 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6177587136803468; count_not_improved_vanilla_star_anomaly= 11 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5758721657315601; count_not_improved_prior_anomaly= 32; iter_best_prior_anomaly= 80 
last prior star auc 0.6177619301999799 ; count_not_improved_prior_star_anomaly= 11 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6212882650041635 at iter 490
0.5976822274166871 at iter 80
0.621294054739503 at iter 490
last anomaly aucs:
0.6212882650041635
0.5708186274055708
0.621294054739503




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.4262797832489 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.621998215217586,first_prior_anomaly_auc= 0.5705291406385898, first_prior_star_anomaly_auc= 0.6220092800451239


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6219983438783713 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5676073828646478 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6220087654019826 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6219979578960153 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5640427071464376 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6220077361156999 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6219983438783713 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5587956629993196 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.622008508080412 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6219973145920887 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5510434647011416 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6220082507588413 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.621997443252874 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5384385675628662 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6220086367411972 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6219984725391566 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5235001497611541 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.622006578168632 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6219980865568007 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.5035404874905691 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6220092800451239 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6219979578960153 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.4805966669651597 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6220086367411973 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.62199782923523 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.45573078296778236 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.622001817719575 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6219987298607272 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.4117251918846952 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6219937120900996 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.62199782923523 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.3997590955455578 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6219852204782683 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6219984725391567 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.3990851703520262 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6219747989546568 iter_best_prior_star_anomaly= 40
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6220013030764338 at iter 73
max_prior_anomaly= 0.5705291406385898 at iter 0
max_prior_star_anomaly= 0.6220103093314066 at iter 4
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6219977005744447
accuracies_anomaly['prior'][-1]= 0.3994218756272213
accuracies_anomaly['prior_star'][-1]= 0.621968494576176



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.72258639335632 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6219969286097328
 first_prior_anomaly_auc= 0.39941621455266707
 first_prior_star_anomaly_auc= 0.6219643774310455


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6240619342141966; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.3997628267083322; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 100 
last prior star auc 0.6239999197156699 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.626021051992338; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4008543848110282; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 200 
last prior star auc 0.6260009809098274 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6263784716539704; count_not_improved_vanilla_star_anomaly= 4 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4015410474223069; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.626323662159422 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6252458707607558; count_not_improved_vanilla_star_anomaly= 14 ;iter_best_vanilla_star_anomaly= 260 
last prior auc 0.40216402294484976; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 400 
last prior star auc 0.6252131909212832 ; count_not_improved_prior_star_anomaly= 15 ; iter_best_prior_star_anomaly= 250
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6265926918615363 at iter 260
0.4033410118090015 at iter 490
0.626531963970863 at iter 250
last anomaly aucs:
0.624053828584721
0.4033410118090015
0.6240172889216888




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.2486777305603 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6239290276229559,first_prior_anomaly_auc= 0.40348549787092136, first_prior_star_anomaly_auc= 0.6238707442872038


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6239287703013853 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.40581219951273584 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6238559482968915 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6239287703013854 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4071054977268212 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6238500299007665 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6239288989621706 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4078757898485611 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6238369065006634 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.623929027622956 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.408170423046955 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6238320173908211 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6239287703013853 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4085058417142969 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6238214672064244 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6239287703013853 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.40893608338042314 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6238233971182043 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6239285129798147 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4093758459446635 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6238300874790412 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6239288989621705 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.41006868427363785 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6238245550652722 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6239287703013854 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.4117212034003501 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6238348479280982 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6239290276229559 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.41471359594543544 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6238793645598206 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6239287703013854 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.4165136889929154 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6239283843190294 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6239304428915944 iter_best_vanilla_star_anomaly= 760 
last prior auc 0.4196773290432681 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.624033628841425 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6239305715523797 at iter 76
max_prior_anomaly= 0.42326233316555967 at iter 129
max_prior_star_anomaly= 0.6241981859858555 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6239283843190293
accuracies_anomaly['prior'][-1]= 0.42326233316555967
accuracies_anomaly['prior_star'][-1]= 0.6241981859858555



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.01122498512268 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.623929027622956
 first_prior_anomaly_auc= 0.42395349890432477
 first_prior_star_anomaly_auc= 0.6242170991212983


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6216689722679397; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4273618517683653; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6220781135652727 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6195485138650009; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4308054576875849; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6199634448976735 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6171253166341927; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43411139656650677; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6175151588137271 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6156549811795002; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4362741843678175; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6160757019475125 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.623929027622956 at iter 0
0.4385074782794862 at iter 490
0.6242895351434361 at iter 20
last anomaly aucs:
0.6144076148657759
0.4385074782794862
0.6148487926986549




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.28115606307983 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6142766381863152,first_prior_anomaly_auc= 0.43871269223207937, first_prior_star_anomaly_auc= 0.614753841039085


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6142816559569428 iter_best_vanilla_star_anomaly= 100 
last prior auc 0.44176349677370214 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6149238019364992 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6142709771117609 iter_best_vanilla_star_anomaly= 120 
last prior auc 0.44459725057048183 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6151009678378916 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6142802406883043 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.44631281348200347 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6152508576527951 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6142709771117609 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.4479897781579275 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6153881387107365 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6142765095255298 iter_best_vanilla_star_anomaly= 260 
last prior auc 0.44936271739812894 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6154788445643906 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.614281269974587 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.45080757801732696 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6155412450452731 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6142759948823886 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4525474578172749 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6155928380201885 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6142767668471006 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4554562208518991 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6156242312518077 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6142779247941684 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4585416351447743 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6156497060873021 iter_best_prior_star_anomaly= 890
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6142730356843262 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4630708807705649 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6156619288619078 iter_best_prior_star_anomaly= 960
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6142759948823886 iter_best_vanilla_star_anomaly= 580 
last prior auc 0.4677890004292124 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6156780114600735 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.61427457961375 iter_best_vanilla_star_anomaly= 1110 
last prior auc 0.4739869764406663 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6157037436171384 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6142853871197174 at iter 111
max_prior_anomaly= 0.4802114565738971 at iter 129
max_prior_star_anomaly= 0.6157185396074508 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6142741936313941
accuracies_anomaly['prior'][-1]= 0.4802114565738971
accuracies_anomaly['prior_star'][-1]= 0.6157185396074508



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.65806698799133 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6219977005744447
accuracies_anomaly["prior"][-1]= 0.3994218756272213
accuracies_anomaly["prior_star"][-1]= 0.621968494576176


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 681.6623771190643 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003797292709350586 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4028086134793273
 first_prior_anomaly_auc= 0.48488711817338737
 first_prior_star_anomaly_auc= 0.402807326871474


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5513631867526738; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5933937061202391; count_not_improved_prior_anomaly= 4; iter_best_prior_anomaly= 60 
last prior star auc 0.5514298330394721 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6066267252124704; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5878175476842602; count_not_improved_prior_anomaly= 14; iter_best_prior_anomaly= 60 
last prior star auc 0.606659791034299 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6208194251024397; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5779234046319941; count_not_improved_prior_anomaly= 24; iter_best_prior_anomaly= 60 
last prior star auc 0.6208623978047383 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6325226674571585; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5644719195262813; count_not_improved_prior_anomaly= 34; iter_best_prior_anomaly= 60 
last prior star auc 0.6325496862220767 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6370041799315936 at iter 490
0.594868930684774 at iter 60
0.6370342865553597 at iter 490
last anomaly aucs:
0.6370041799315936
0.5539216064688584
0.6370342865553597




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.23694252967834 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6376550748445521,first_prior_anomaly_auc= 0.5529521474514357, first_prior_star_anomaly_auc= 0.6377118142508804


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6376527589504162 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5515445984599818 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6377091123743884 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6376545602014109 iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5508086587679237 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6377037086214048 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6376550748445521 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5496263948115737 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6377044805861167 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6376541742190549 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5491093071153531 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376995914762745 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6376549461837667 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5487400506614708 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376965036174267 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.637655460826908 iter_best_vanilla_star_anomaly= 600 
last prior auc 0.545846855581871 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376920004899402 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6376534022543429 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.5396670207411479 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376917431683697 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6376539168974842 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.5313245267598994 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376905852213017 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6376548175229814 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.5169405082821521 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376896845958044 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6376541742190548 iter_best_vanilla_star_anomaly= 690 
last prior auc 0.49325148448814116 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376856961114594 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6376535309151281 iter_best_vanilla_star_anomaly= 1060 
last prior auc 0.469523605136962 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376860820938153 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6376546888621961 iter_best_vanilla_star_anomaly= 1060 
last prior auc 0.4583934179200801 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6376826082526116 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.637655846809264 at iter 106
max_prior_anomaly= 0.5529521474514357 at iter 0
max_prior_star_anomaly= 0.6377131008587336 at iter 1
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6376530162719869
accuracies_anomaly['prior'][-1]= 0.4567517062993349
accuracies_anomaly['prior_star'][-1]= 0.6376787484290518



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.49448752403259 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6376544315406254
 first_prior_anomaly_auc= 0.45667438116735476
 first_prior_star_anomaly_auc= 0.6376782337859105


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6394895203217137; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.45964901852406526; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6395318497200856 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6410916044205787; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.46268657100479954; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6411480865053363 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6416759817075242; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.46608115716481036; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6417787816749988 ; count_not_improved_prior_star_anomaly= 4 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6417893318593954; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 350 
last prior auc 0.4700731153510844; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6418141633909631 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 350
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.642174542250658 at iter 430
0.473197513861913 at iter 490
0.6422377146962526 at iter 430
last anomaly aucs:
0.6418232983067212
0.473197513861913
0.64189213182687




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.10428881645203 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6417486750512327,first_prior_anomaly_auc= 0.4734931763465895, first_prior_star_anomaly_auc= 0.6417879165907567


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6417477744257354 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4725818720041336 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6417956362378763 iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.641749189694374 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4712351795641384 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6418042565104931 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6417494470159447 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.46997494717188154 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6418158359811723 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6417490610335888 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.46925624802505694 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6418272867910663 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6417489323728034 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.46869438637554334 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6418416967990226 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6417517629100805 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.46806639308237274 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6418571360932617 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.641748803712018 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.46805198307441637 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6418710314580767 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6417529208571484 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.46918651387941085 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6418847981621064 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6417517629100805 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4685757611314738 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419091150505328 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6417489323728034 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.4685004945720588 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419505438234074 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6417516342492953 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.47018556487745833 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6419959610806271 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6417525348747924 iter_best_vanilla_star_anomaly= 180 
last prior auc 0.46969009219317237 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6420629933497813 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6417552367512843 at iter 18
max_prior_anomaly= 0.4734931763465895 at iter 0
max_prior_star_anomaly= 0.6421610328681989 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.64174957567673
accuracies_anomaly['prior'][-1]= 0.471287673164551
accuracies_anomaly['prior_star'][-1]= 0.6421610328681989



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.89138436317444 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6417512482669392
 first_prior_anomaly_auc= 0.47164097568105295
 first_prior_star_anomaly_auc= 0.6421634774231201


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6405887980715292; count_not_improved_vanilla_star_anomaly= 9 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4744429502638575; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.640924988703583 ; count_not_improved_prior_star_anomaly= 9 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6385639346320867; count_not_improved_vanilla_star_anomaly= 19 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4771338905889268; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6390220956886286 ; count_not_improved_prior_star_anomaly= 19 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6366812413604283; count_not_improved_vanilla_star_anomaly= 29 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4801208793810284; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6371727255603692 ; count_not_improved_prior_star_anomaly= 29 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6347158192038059; count_not_improved_vanilla_star_anomaly= 39 ;iter_best_vanilla_star_anomaly= 10 
last prior auc 0.48231969220223003; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6352263451999749 ; count_not_improved_prior_star_anomaly= 39 ; iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6419259696134104 at iter 10
0.484589911759287 at iter 490
0.6423339529636755 at iter 10
last anomaly aucs:
0.6333830221286258
0.484589911759287
0.6340502569613204




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.58495497703552 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6332677420649747,first_prior_anomaly_auc= 0.4848482626162193, first_prior_star_anomaly_auc= 0.6341022359185917


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6332676134041894 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.48801846436662355 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6341540862150776 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6332676134041894 iter_best_vanilla_star_anomaly= 70 
last prior auc 0.4907476169449342 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6342110829429765 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6332668414394775 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4947228492291161 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6342741267277857 iter_best_prior_star_anomaly= 290
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6332659408139801 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.4990093119529987 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6343398723890867 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6332669701002628 iter_best_vanilla_star_anomaly= 280 
last prior auc 0.5031951619427573 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6343904360777193 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6332679993865453 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.5087520212609374 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.634441771731064 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6332674847434041 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.515648110693564 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6344862883627863 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.633267098761048 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.5213551171482183 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6345270738317343 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.633267098761048 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.527909869517378 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.634552677328014 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6332663267963361 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.5351187333191292 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.634567344657541 iter_best_prior_star_anomaly= 970
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6332665841179068 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.545149385464625 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6345736490360219 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.633268256708116 iter_best_vanilla_star_anomaly= 510 
last prior auc 0.5541516519530193 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.634603369677432 iter_best_prior_star_anomaly= 1190
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6332719878708905 at iter 51
max_prior_anomaly= 0.5626817333592713 at iter 129
max_prior_star_anomaly= 0.6346197095971682 at iter 128
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6332709585846079
accuracies_anomaly['prior'][-1]= 0.5626817333592713
accuracies_anomaly['prior_star'][-1]= 0.6346167503991058



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.77587842941284 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6376530162719869
accuracies_anomaly["prior"][-1]= 0.4567517062993349
accuracies_anomaly["prior_star"][-1]= 0.6376787484290518


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 684.4035139083862 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.003638744354248047 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.4019451709490123
 first_prior_anomaly_auc= 0.48171241329549674
 first_prior_star_anomaly_auc= 0.4019413111254525


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.552325312105333; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.59298610875233; count_not_improved_prior_anomaly= 2; iter_best_prior_anomaly= 80 
last prior star auc 0.5524039238451666 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6095044809978314; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5857095693774979; count_not_improved_prior_anomaly= 10; iter_best_prior_anomaly= 130 
last prior star auc 0.6095544013825375 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6274394084897591; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5741285547688377; count_not_improved_prior_anomaly= 20; iter_best_prior_anomaly= 130 
last prior star auc 0.6274602515369818 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6384812057471229; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.560904413270794; count_not_improved_prior_anomaly= 30; iter_best_prior_anomaly= 130 
last prior star auc 0.6384922705746607 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6452144106255282 at iter 490
0.5935825801530961 at iter 130
0.6452630444023809 at iter 490
last anomaly aucs:
0.6452144106255282
0.5500112192204805
0.6452630444023809




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.31680345535278 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6457013916979827,first_prior_anomaly_auc= 0.5491185706918965, first_prior_star_anomaly_auc= 0.645737545378659


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6457015203587679 iter_best_vanilla_star_anomaly= 40 
last prior auc 0.5478346647151399 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6457338142158846 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6457019063411239 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5470688757208864 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6457300830531101 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6457015203587679 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5464911887947779 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.645732398947246 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.645701520358768 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5454108241804051 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6457302117138956 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6457011343764121 iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5413870867801558 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6457335568943139 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6457012630371974 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.531724404480689 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6457298257315395 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6457013916979827 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.5058068472240663 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.645726480551121 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.645701520358768 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.4683233286706665 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6457204334942108 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6457007483940561 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.4371170411724806 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6457121992039501 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6457011343764121 iter_best_vanilla_star_anomaly= 550 
last prior auc 0.4258131618954101 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6457061521470396 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.645701520358768 iter_best_vanilla_star_anomaly= 1020 
last prior auc 0.42636202880560586 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6457010057156267 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6457012630371974 iter_best_vanilla_star_anomaly= 1020 
last prior auc 0.4280314024951958 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6456842798135345 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6457020350019094 at iter 102
max_prior_anomaly= 0.5491292495370784 at iter 1
max_prior_star_anomaly= 0.645737545378659 at iter 0
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6457012630371973
accuracies_anomaly['prior'][-1]= 0.42815800470795545
accuracies_anomaly['prior_star'][-1]= 0.6456779754350535



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.83370614051819 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6457013916979828
 first_prior_anomaly_auc= 0.4281464252372762
 first_prior_star_anomaly_auc= 0.6456774607919122


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6482194119275753; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.42904717939533554; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6481839015508256 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6496117789463609; count_not_improved_vanilla_star_anomaly= 0 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.42993725470821276; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6496314640465155 ; count_not_improved_prior_star_anomaly= 0 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.650770755300567; count_not_improved_vanilla_star_anomaly= 3 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.43102340905792513; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6508090962145938 ; count_not_improved_prior_star_anomaly= 1 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6510393990203253; count_not_improved_vanilla_star_anomaly= 6 ;iter_best_vanilla_star_anomaly= 390 
last prior auc 0.43275093742248194; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6510240883868716 ; count_not_improved_prior_star_anomaly= 8 ; iter_best_prior_star_anomaly= 370
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6511859436548103 at iter 390
0.43469448724559906 at iter 490
0.6513300437343741 at iter 370
last anomaly aucs:
0.6494845334296746
0.43469448724559906
0.6494738545844926




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.37552285194397 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6493363162049803,first_prior_anomaly_auc= 0.43490947941787683, first_prior_star_anomaly_auc= 0.6493204909283854


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6493368308481215 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.435512383857909 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6493189469989614 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.649335801561839 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4359322040004241 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.649317145747967 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.649336187544195 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4358721194136774 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6493143152106897 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6493359302226243 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4357895191894988 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6493122566381245 iter_best_prior_star_anomaly= 30
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6493359302226244 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4359352918592718 iter_best_prior_anomaly= 240
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6493307837912113 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6493359302226244 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.436813015736758 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6493399187069693 iter_best_prior_star_anomaly= 580
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6493364448657657 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.43898571041853873 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.64935008290901 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.649336187544195 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4408390690311431 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6493918976642407 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.649336187544195 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.44347970298915035 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6494398881371668 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6493355442402683 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4469182911377422 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6495317519378888 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.649336187544195 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4537056622067692 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6496438154819068 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.649336573526551 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.45877013669951117 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6497810965398483 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6493369595089069 at iter 2
max_prior_anomaly= 0.46277303105253786 at iter 129
max_prior_star_anomaly= 0.6498734749837115 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6493356729010538
accuracies_anomaly['prior'][-1]= 0.46277303105253786
accuracies_anomaly['prior_star'][-1]= 0.6498734749837115



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.95331835746765 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6493359302226243
 first_prior_anomaly_auc= 0.46312556160432794
 first_prior_star_anomaly_auc= 0.6498904582073743


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6467395555747689; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.46617636614595076; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.647264362918109 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6447531617101385; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4694415195559247; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6455463554516663 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6427119583509598; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.472368166439709; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 300 
last prior star auc 0.6436151570639403 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6411564494563825; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4759269237617943; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 400 
last prior star auc 0.6417197263745346 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6493359302226243 at iter 0
0.4787838364999326 at iter 490
0.6498904582073743 at iter 0
last anomaly aucs:
0.6390370203397263
0.4787838364999326
0.6397145480352469




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.26543283462524 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6389321617996865,first_prior_anomaly_auc= 0.4790801422885357, first_prior_star_anomaly_auc= 0.6395371248122839


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6389319044781159 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4781755283069167 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395285045396671 iter_best_prior_star_anomaly= 10
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6389319044781158 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.47913610973015197 iter_best_prior_anomaly= 10
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6395764950125933 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6389311325134038 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4813072604825088 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6396204970011744 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6389312611741892 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4838151165100607 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6396521475543643 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6389302318879067 iter_best_vanilla_star_anomaly= 20 
last prior auc 0.4862879768040044 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6396768504251467 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6389316471565452 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4899891616154442 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6397083723175514 iter_best_prior_star_anomaly= 600
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6389311325134038 iter_best_vanilla_star_anomaly= 590 
last prior auc 0.4931808497169977 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6397388649236733 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6389308751918332 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.49670332469762146 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.639768070921942 iter_best_prior_star_anomaly= 800
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6389329337643984 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.5016310327755631 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6397917445064418 iter_best_prior_star_anomaly= 900
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6389316471565452 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.5062808335572031 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6398255822929823 iter_best_prior_star_anomaly= 1000
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6389322904604718 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.5135710109752797 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6398608353481612 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6389321617996865 iter_best_vanilla_star_anomaly= 730 
last prior auc 0.5195703347341919 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6398816783953838 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6389329337643984 at iter 73
max_prior_anomaly= 0.5263420091874094 at iter 129
max_prior_star_anomaly= 0.6398989189406173 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6389312611741892
accuracies_anomaly['prior'][-1]= 0.5263420091874094
accuracies_anomaly['prior_star'][-1]= 0.6398989189406173



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 126.2814884185791 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6457012630371973
accuracies_anomaly["prior"][-1]= 0.42815800470795545
accuracies_anomaly["prior_star"][-1]= 0.6456779754350535


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 682.3404989242554 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return


/home/daniel.z/pieclam/trainer.py:382:::  
 starting optimization of pieclam on redditGGAD on device cuda


/home/daniel.z/pieclam/trainer.py:383:::  
 configs_dict: 
{
    "clamiter_init": {
        "dim_feat": 30,
        "dim_attr": 50,
        "s_reg": 0.0,
        "l1_reg": 1,
        "T": 1,
        "hidden_dim": 64,
        "num_coupling_blocks": 32,
        "num_layers_mlp": 2
    },
    "feat_opt": {
        "lr": 3e-06,
        "n_iter": 500,
        "early_stop": 0
    },
    "prior_opt": {
        "n_iter": 1300,
        "lr": 2e-06,
        "noise_amp": 0.05,
        "weight_decay": 0.1,
        "early_stop": 0
    },
    "back_forth": {
        "n_back_forth": 3,
        "scheduler_step_size": 1,
        "scheduler_gamma": 0.5,
        "early_stop_fit": 0,
        "first_func_in_fit": "fit_feats"
    }
}


/home/daniel.z/pieclam/trainer.py:387:::  
 train_model_on_params, initializing feats with small_gaus


/home/daniel.z/pieclam/trainer.py:395:::  
 init_node_feats took 0.0037374496459960938 seconds


/home/daniel.z/pieclam/clamiter.py:987:::  
fit, task='anomaly_detection'


/home/daniel.z/pieclam/clamiter.py:1025:::  
in fit,
first_func_in_fit='fit_feats'
second_function_name='fit_prior'
back and forth 1/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.40089246840348436
 first_prior_anomaly_auc= 0.4915000252175139
 first_prior_star_anomaly_auc= 0.4008946556368349


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.5517799190363409; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 60 
last prior auc 0.5950166332663268; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.5518487525564898 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 60
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6060567579334813; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.5913779775965547; count_not_improved_prior_anomaly= 6; iter_best_prior_anomaly= 140 
last prior star auc 0.6061023038514863 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6196473253481303; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.5808787428709059; count_not_improved_prior_anomaly= 16; iter_best_prior_anomaly= 140 
last prior star auc 0.6196820637601681 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6334343577819704; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 400 
last prior auc 0.5688480588175354; count_not_improved_prior_anomaly= 26; iter_best_prior_anomaly= 140 
last prior star auc 0.6334639497625951 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6375957622225172 at iter 490
0.5968873610849501 at iter 140
0.6376418227836635 at iter 490
last anomaly aucs:
0.6375957622225172
0.5572159658771012
0.6376418227836635




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 101.20627403259277 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6378921966719058,first_prior_anomaly_auc= 0.5561303261705302, first_prior_star_anomaly_auc= 0.637934268748707


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6378928399758323 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5524984895223802 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6379333681232097 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6378915533679791 iter_best_vanilla_star_anomaly= 50 
last prior auc 0.5490231043891854 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6379269350839434 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6378918106895498 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.5448438160994784 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6379234612427397 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6378919393503351 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.5387342300475427 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6379259057976608 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6378918106895497 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.5292337889983707 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6379181861505413 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6378920680111204 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.5080284330042705 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6379156129348349 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.637892325332691 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.47788655618307707 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6379122677544165 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6378915533679791 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.452117344811934 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6379046767680823 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.637891553367979 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.40675888557115614 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6378955418523242 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6378919393503351 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.3922083800371984 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6378951558699683 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6378918106895497 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.40423571891015053 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6378903954209112 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6378921966719058 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4138752422682588 iter_best_prior_anomaly= 0
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6378806172012265 iter_best_prior_star_anomaly= 20
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6378936119405443 at iter 29
max_prior_anomaly= 0.5561303261705302 at iter 0
max_prior_star_anomaly= 0.6379354266957749 at iter 2
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6378919393503351
accuracies_anomaly['prior'][-1]= 0.41684601980140956
accuracies_anomaly['prior_star'][-1]= 0.6378698096952593



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.12100601196289 seconds


/home/daniel.z/pieclam/clamiter.py:1253:::  
scheduler made step. changes: 
feats lr: 3e-06 to 1.5e-06  
feats n_iter changed from 500 to 500 
noise_amp from 0.05 to 0.025 
prior lr from 2e-06 to 1e-06
back and forth 2/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6378920680111204
 first_prior_anomaly_auc= 0.4168974841155394
 first_prior_star_anomaly_auc= 0.6378691663913326


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6390318739083133; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 100 
last prior auc 0.4176734373118336; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6389719179823519 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 90
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.64001278373563; count_not_improved_vanilla_star_anomaly= 1 ;iter_best_vanilla_star_anomaly= 200 
last prior auc 0.4184091196823211; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6399685244254781 ; count_not_improved_prior_star_anomaly= 2 ; iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6404288727153704; count_not_improved_vanilla_star_anomaly= 5 ;iter_best_vanilla_star_anomaly= 300 
last prior auc 0.4186398084704085; count_not_improved_prior_anomaly= 5; iter_best_prior_anomaly= 250 
last prior star auc 0.6404076436857918 ; count_not_improved_prior_star_anomaly= 3 ; iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6410470877888563; count_not_improved_vanilla_star_anomaly= 8 ;iter_best_vanilla_star_anomaly= 380 
last prior auc 0.41835006438185696; count_not_improved_prior_anomaly= 15; iter_best_prior_anomaly= 250 
last prior star auc 0.6409675754235256 ; count_not_improved_prior_star_anomaly= 5 ; iter_best_prior_star_anomaly= 380
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6411847548291539 at iter 380
0.41876267952039375 at iter 250
0.6411628824956488 at iter 380
last anomaly aucs:
0.6406770593702621
0.4177887173754846
0.6405913712872358




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.74470543861389 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6406038513834122,first_prior_anomaly_auc= 0.41779116193040583, first_prior_star_anomaly_auc= 0.6405332166122688


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6406032080794855 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4206820411158699 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.640517005353318 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.640602564775559 iter_best_vanilla_star_anomaly= 0 
last prior auc 0.421292021899095 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6404920451609649 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6406032080794856 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4216403066449693 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6404708161313863 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.640602950757915 iter_best_vanilla_star_anomaly= 290 
last prior auc 0.4217346150006125 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6404418674546882 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.640602950757915 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.42181026754238343 iter_best_prior_anomaly= 490
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6404252702133812 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6406032080794856 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.421736416251607 iter_best_prior_anomaly= 520
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6404250128918108 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6406026934363442 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.42186108855258675 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6404210244074656 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6406030794187003 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.4236000677270374 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.640436206380134 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6406026934363442 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.4239854067790853 iter_best_prior_anomaly= 840
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6404480431723838 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6406030794187003 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.4245006932243114 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6405198358905951 iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.640602950757915 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.4268903099901497 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6405904706617385 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6406028220971296 iter_best_vanilla_star_anomaly= 450 
last prior auc 0.42996839061826136 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.640683363748743 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6406047520089095 at iter 45
max_prior_anomaly= 0.4351983228809312 at iter 129
max_prior_star_anomaly= 0.6407970998829702 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6406030794187002
accuracies_anomaly['prior'][-1]= 0.4351983228809312
accuracies_anomaly['prior_star'][-1]= 0.6407970998829702



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 125.37866401672363 seconds
back and forth 3/3


/home/daniel.z/pieclam/clamiter.py:1134:::  
 starting fit_feats


/home/daniel.z/pieclam/clamiter.py:271:::  
 in fit_feats, using device cuda

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:328:::  
fit_feats start. 
 best_vanilla_link_auc= None, best_prior_link_auc= None

 first_vanilla_star_anomaly_auc= 0.6406033367402709
 first_prior_anomaly_auc= 0.43563898607066875
 first_prior_star_anomaly_auc= 0.6408075214065814


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6386066500128146; count_not_improved_vanilla_star_anomaly= 10 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.43749375995191175; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 100 
last prior star auc 0.6387633588493403 ; count_not_improved_prior_star_anomaly= 10 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6361108880990832; count_not_improved_vanilla_star_anomaly= 20 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4387182246458483; count_not_improved_prior_anomaly= 0; iter_best_prior_anomaly= 200 
last prior star auc 0.6363050372241384 ; count_not_improved_prior_star_anomaly= 20 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6333301425458573; count_not_improved_vanilla_star_anomaly= 30 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.4394612406810994; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 300 
last prior star auc 0.6335626325849393 ; count_not_improved_prior_star_anomaly= 30 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:520:::  
                                       
fit feats, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6312199770057444; count_not_improved_vanilla_star_anomaly= 40 ;iter_best_vanilla_star_anomaly= 0 
last prior auc 0.44039866316297616; count_not_improved_prior_anomaly= 1; iter_best_prior_anomaly= 400 
last prior star auc 0.6313185311673033 ; count_not_improved_prior_star_anomaly= 40 ; iter_best_prior_star_anomaly= 0
                                       


/home/daniel.z/pieclam/clamiter.py:585:::  
fit_feats optmization loop ended after 500 iterations


/home/daniel.z/pieclam/clamiter.py:637:::  fit_feats end


max anomaly aucs:
0.6406033367402709 at iter 0
0.442696544788878 at iter 490
0.6408075214065814 at iter 0
last anomaly aucs:
0.6293052471985401
0.442696544788878
0.6295031274863697




/home/daniel.z/pieclam/clamiter.py:1145:::  
in fit, fit_feats took 100.97499084472656 seconds


/home/daniel.z/pieclam/clamiter.py:1155:::  
 starting fit_prior


/home/daniel.z/pieclam/clamiter.py:717:::  
 in fit_prior, using devicecuda:0

early_stop= 0

performance_metric= None


/home/daniel.z/pieclam/clamiter.py:724:::  
 in fit_prior, early_stop= 0


/home/daniel.z/pieclam/clamiter.py:763:::  
fit_prior start, best_prior_link_auc= None
 (vanilla link auc doesnt change)
 first_vanilla_anomaly_auc= 0.6292198164370844,first_prior_anomaly_auc= 0.44297020627926387, first_prior_star_anomaly_auc= 0.6293304647124637


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 100:
ANOMALY VALS:
last vanilla auc: 0.6292190444723724 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44340327848266736 iter_best_prior_anomaly= 100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6293452607027761 iter_best_prior_star_anomaly= 100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 200:
ANOMALY VALS:
last vanilla auc: 0.6292187871508017 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.44551305804042424 iter_best_prior_anomaly= 200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6293869467972213 iter_best_prior_star_anomaly= 200
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 300:
ANOMALY VALS:
last vanilla auc: 0.6292207170625816 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.4480978532176004 iter_best_prior_anomaly= 300
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6294205272621911 iter_best_prior_star_anomaly= 300
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 400:
ANOMALY VALS:
last vanilla auc: 0.6292199450978697 iter_best_vanilla_star_anomaly= 10 
last prior auc 0.45093701076736387 iter_best_prior_anomaly= 400
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6294550083526582 iter_best_prior_star_anomaly= 400
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 500:
ANOMALY VALS:
last vanilla auc: 0.6292199450978697 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4535688957919689 iter_best_prior_anomaly= 500
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6294838283685709 iter_best_prior_star_anomaly= 500
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 600:
ANOMALY VALS:
last vanilla auc: 0.6292185298292311 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.45720870940880887 iter_best_prior_anomaly= 600
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6295048000765789 iter_best_prior_star_anomaly= 590
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 700:
ANOMALY VALS:
last vanilla auc: 0.6292181438468751 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.46188887413578555 iter_best_prior_anomaly= 700
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6295261577669429 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 800:
ANOMALY VALS:
last vanilla auc: 0.6292186584900165 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4675243451937992 iter_best_prior_anomaly= 800
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6295170228511847 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 900:
ANOMALY VALS:
last vanilla auc: 0.6292181438468751 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.47405092085097267 iter_best_prior_anomaly= 900
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6295233272296656 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1000:
ANOMALY VALS:
last vanilla auc: 0.6292198164370844 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4791958083345428 iter_best_prior_anomaly= 1000
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6295208826747445 iter_best_prior_star_anomaly= 700
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1100:
ANOMALY VALS:
last vanilla auc: 0.6292189158115871 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.48480374598449694 iter_best_prior_anomaly= 1100
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6295378658984074 iter_best_prior_star_anomaly= 1100
                                       


/home/daniel.z/pieclam/clamiter.py:882:::  
                                       
fit prior, intermediate values iter 1200:
ANOMALY VALS:
last vanilla auc: 0.6292187871508017 iter_best_vanilla_star_anomaly= 460 
last prior auc 0.4909655683152745 iter_best_prior_anomaly= 1200
last prior star auc accuracies_anomaly['prior_star'][i//auc_every]= 0.6295503459945838 iter_best_prior_star_anomaly= 1200
                                       


/home/daniel.z/pieclam/clamiter.py:910:::  
fit_prior optmization loop ended after 1300 iterations

max values 
max_vanilla_star_anomaly= 0.6292220036704349 at iter 46
max_prior_anomaly= 0.4979614985173131 at iter 129
max_prior_star_anomaly= 0.6295850844066216 at iter 129
last values
accuracies_anomaly['vanilla_star'][-1]= 0.6292216176880789
accuracies_anomaly['prior'][-1]= 0.4979614985173131
accuracies_anomaly['prior_star'][-1]= 0.6295850844066216



/home/daniel.z/pieclam/clamiter.py:1167:::  
in fit, fit_prior took 124.07694172859192 seconds


/home/daniel.z/pieclam/clamiter.py:1277:::  fit end after i= 2 iterations
ANOMALY:
accuracies_anomaly["vanilla_star"][-1]= 0.6378919393503351
accuracies_anomaly["prior"][-1]= 0.41684601980140956
accuracies_anomaly["prior_star"][-1]= 0.6378698096952593


/home/daniel.z/pieclam/clamiter.py:1288:::  
fit end, no early stopping


/home/daniel.z/pieclam/trainer.py:480:::  
train_model_on_params on pieclam redditGGAD 
took 677.816321849823 seconds


/home/daniel.z/pieclam/trainer.py:482:::  


FINISHED train model on params 





/home/daniel.z/pieclam/trainer.py:496:::  train model on params. finally is being called after return
